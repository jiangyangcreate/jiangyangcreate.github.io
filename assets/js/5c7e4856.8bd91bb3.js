"use strict";(self.webpackChunkjiangmiemie=self.webpackChunkjiangmiemie||[]).push([[5458],{2749:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var i=t(12085),r=t(74848),a=t(28453);const o={title:"\u7528Flask\u642d\u5efa\u5c4f\u5e55\u5171\u4eab\u5de5\u5177",date:"2024-5-31",authors:"jiangmiemie",tags:["smarthome"],keywords:["smarthome"],description:"\u8bb0\u5f55\u4f7f\u7528flask\u642d\u5efa\u4e2a\u4eba\u5171\u4eab\u5c4f\u5e55\u5de5\u5177"},s=void 0,l={authorsImageUrls:[void 0]},c=[{value:"\u5b89\u88c5\u4f9d\u8d56",id:"\u5b89\u88c5\u4f9d\u8d56",level:2},{value:"\u9879\u76ee\u76ee\u5f55\u7ed3\u6784",id:"\u9879\u76ee\u76ee\u5f55\u7ed3\u6784",level:2},{value:"\u6838\u5fc3\u4ee3\u7801",id:"\u6838\u5fc3\u4ee3\u7801",level:2},{value:"\u66ff\u6362\u4e0a\u4f20\u8868\u5355\u7684\u6837\u5f0f",id:"\u66ff\u6362\u4e0a\u4f20\u8868\u5355\u7684\u6837\u5f0f",level:3},{value:"\u6620\u5c04\u8def\u7531\u4e0e\u6587\u4ef6\u5141\u8bb8\u8303\u56f4\u4ee3\u7801",id:"\u6620\u5c04\u8def\u7531\u4e0e\u6587\u4ef6\u5141\u8bb8\u8303\u56f4\u4ee3\u7801",level:3},{value:"\u4f7f\u7528\u6d4f\u89c8\u5668\u63a5\u53e3\u8bbe\u5907\u68c0\u6d4b",id:"\u4f7f\u7528\u6d4f\u89c8\u5668\u63a5\u53e3\u8bbe\u5907\u68c0\u6d4b",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function d(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u5f53\u4f60\u7684\u7535\u8111\u65e0\u6cd5\u901a\u8fc7\u89c6\u9891\u7ebf\u8fde\u63a5\u5230\u7535\u89c6\u673a\uff0c\u53ef\u80fd\u662f\u7531\u4e8e\u7ebf\u7f06\u957f\u5ea6\u4e0d\u8db3\u6216\u8005\u63a5\u53e3\u4e0d\u517c\u5bb9\uff0c\u800c\u4f60\u7684\u7535\u89c6\u673a\u6070\u597d\u652f\u6301\u6d4f\u89c8\u5668\u529f\u80fd\u3002"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u5f53\u4f60\u5728\u5916\u9762\u53c2\u52a0\u57f9\u8bad\u6216\u4ea4\u6d41\u6d3b\u52a8\uff0c\u73b0\u573a\u53ea\u63d0\u4f9b\u4e86\u4e00\u4e2aWiFi\u7f51\u7edc\u3002\u5927\u5bb6\u521a\u521a\u719f\u6089\uff0c\u9a6c\u4e0a\u5c31\u8981\u5f00\u59cb\u5c4f\u5e55\u5206\u4eab\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u5feb\u901f\u7684\u65b9\u5f0f\u8ba9\u5927\u5bb6\u90fd\u80fd\u770b\u5230\u4f60\u7684\u5c4f\u5e55\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u4e2a\u65f6\u5019\uff0c\u4f60\u5c31\u9700\u8981\u4e00\u4e2a\u5de5\u5177\u6765\u6355\u83b7\u548c\u5206\u4eab\u4f60\u7684\u5c4f\u5e55\u548c\u97f3\u9891\uff08\u5305\u62ec\u8bbe\u5907\u97f3\u9891\u548c\u9ea6\u514b\u98ce\u8f93\u5165\uff09\uff0c\u5e76\u901a\u8fc7\u7f51\u9875\u5f62\u5f0f\u4e0e\u4ed6\u4eba\u5171\u4eab\u3002\u8fd9\u6837\uff0c\u89c2\u4f17\u65e0\u9700\u4e0b\u8f7d\u4efb\u4f55\u4f1a\u8bae\u8f6f\u4ef6\uff0c\u4ec5\u9700\u6253\u5f00\u6d4f\u89c8\u5668\u5373\u53ef\u89c2\u770b\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u5f53\u7136\u6709\u65f6\u5019\u4f60\u9700\u8981\u63d0\u4f9b\u5fc5\u8981\u7684\u6587\u4ef6\uff0c\u6bd4\u5982\u4ee3\u7801\uff0c\u6587\u6863\u7b49\u3002\u6240\u4ee5\u8fd9\u4e2a\u7a0b\u5e8f\u8fd8\u5141\u8bb8\u4f60\u4e0a\u4f20\u4e0e\u4e0b\u8f7d\u6587\u4ef6\u3002\u4e0a\u4f20\u7684\u6587\u4ef6\u4f1a\u4fdd\u5b58\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u7684",(0,r.jsx)(n.code,{children:"upload"}),"\u6587\u4ef6\u5939\u4e2d\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4ece",(0,r.jsx)(n.code,{children:"upload"}),"\u6587\u4ef6\u5939\u4e2d\u4e0b\u8f7d\u6587\u4ef6\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u4f8b\u5982\u4e00\u4e2a\u4f19\u4f34\u4e0a\u4f20\u4e86\u6587\u4ef6\uff0c\u53e6\u4e00\u4e2a\u4f19\u4f34\u53ef\u4ee5\u4ece\u8fd9\u4e2a\u5730\u5740\u4e0b\u8f7d\u6587\u4ef6\u3002\u8fd9\u4e2a\u9879\u76ee\u6211\u505a\u4e86\u4e00\u6b21\u8f83\u5927\u7684\u8c03\u6574\uff0c\u539f\u672c\u662f\u7528python\u7f16\u5199\u7684\u5c4f\u5e55\u548c\u9ea6\u514b\u98ce\u6355\u83b7\uff0c\u4e3a\u4e86\u8de8\u5e73\u53f0\u4f7f\u7528\u7684\u540c\u65f6\u4fdd\u6301\u4ee3\u7801\u7684\u7b80\u6d01\uff0c\u4f7f\u7528\u4e86JS\u91cd\u6784\u4e86\u4ee3\u7801\uff0c\u4f7f\u7528\u901a\u7528\u7684\u6d4f\u89c8\u5668\u83b7\u53d6\u672c\u5730\u6743\u9650\u7684\u65b9\u5f0f\uff0c\u5e0c\u671b\u8fd9\u4e2a\u9879\u76ee\u5bf9\u4f60\u6709\u5e2e\u52a9\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u5b89\u88c5\u4f9d\u8d56",children:"\u5b89\u88c5\u4f9d\u8d56"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip install flask\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u9879\u76ee\u76ee\u5f55\u7ed3\u6784",children:"\u9879\u76ee\u76ee\u5f55\u7ed3\u6784"}),"\n",(0,r.jsx)(n.p,{children:"\u9879\u76ee\u4e0b\u7684\u6587\u4ef6\u5939\uff1a"}),"\n",(0,r.jsx)(n.p,{children:"templates \u6587\u4ef6\u5939\u4e2d\u5305\u542b\u4e00\u4e2a upload.html \u6587\u4ef6\uff0c\u7528\u4e8e\u9875\u9762\u5c55\u793a\u3002"}),"\n",(0,r.jsx)(n.p,{children:"uploads \u6587\u4ef6\u5939\u7528\u4e8e\u4fdd\u5b58\u4e0a\u4f20\u7684\u6587\u4ef6\u3002"}),"\n",(0,r.jsx)(n.p,{children:"static \u6587\u4ef6\u5939\u7528\u4e8e\u653e\u7f6ejs\u4ee3\u7801\u903b\u8f91\uff1a\u68c0\u6d4b\u6444\u50cf\u5934\u662f\u5426\u5b58\u5728\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:"showLineNumbers",children:"your_project/\n\u251c\u2500\u2500 templates/\n\u2502   \u2514\u2500\u2500 upload.html\n\u2502   \u2514\u2500\u2500 stream.html\n\u251c\u2500\u2500 uploads/\n\u251c\u2500\u2500 static/\n\u2514\u2500\u2500 app.py\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6838\u5fc3\u4ee3\u7801",children:"\u6838\u5fc3\u4ee3\u7801"}),"\n",(0,r.jsx)(n.h3,{id:"\u66ff\u6362\u4e0a\u4f20\u8868\u5355\u7684\u6837\u5f0f",children:"\u66ff\u6362\u4e0a\u4f20\u8868\u5355\u7684\u6837\u5f0f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",metastring:'showLineNumbers title="upload.html"',children:'<!doctype html>\n<html lang="zh-CN">\n<head>\n    <style>\n        /* \u7f8e\u5316\u4e0a\u4f20\u6309\u94ae */\n        .file-upload {\n            position: relative;\n            display: inline-block;\n            overflow: hidden;\n            cursor: pointer;\n            background-color: #ff6600;\n            color: #fff;\n            padding: 10px 20px;\n            border: none;\n            border-radius: 5px;\n            transition: background-color 0.3s;\n            font-size: 16px;\n        }\n        .file-upload:hover {\n            background-color: #e65c00;\n        }\n        .file-upload input[type="file"] {\n            position: absolute;\n            font-size: 18px;\n            right: 0;\n            top: 0;\n            opacity: 0;\n            cursor: pointer;\n            width: 100%;\n            height: 100%;\n        }\n        /* \u663e\u793a\u6587\u4ef6\u540d */\n        .file-name {\n            margin-top: 10px;\n            font-size: 14px;\n            color: #f0f0f0;\n        }\n        input[type="submit"] {\n            background-color: #ff6600;\n            color: #fff;\n            border: none;\n            padding: 10px 20px;\n            cursor: pointer;\n            border-radius: 5px;\n            transition: background-color 0.3s;\n            font-size: 16px;\n            margin-top: 10px;\n        }\n        input[type="submit"]:hover {\n            background-color: #e65c00;\n        }\n    </style>\n    \x3c!-- \u5f15\u5165\u8bbe\u5907\u68c0\u6d4b\u7684 JavaScript \u6587\u4ef6 --\x3e\n    <script src="{{ url_for(\'static\', filename=\'js/deviceDetection.js\') }}"><\/script>\n    <script>\n        // \u663e\u793a\u9009\u4e2d\u7684\u6587\u4ef6\u540d\n        function displayFileName(input) {\n            const fileNameElement = document.getElementById(\'file-name\');\n            if (input.files.length > 0) {\n                fileNameElement.textContent = `\u5df2\u9009\u62e9\u6587\u4ef6: ${input.files[0].name}`;\n            } else {\n                fileNameElement.textContent = \'\';\n            }\n        }\n        // \u663e\u793a\u4e0a\u4f20\u8868\u5355\n        window.onload = function() {\n            const uploadContainer = document.getElementById(\'upload-form-container\');\n            const uploadForm = uploadContainer.querySelector(\'form\');\n            uploadForm.style.display = \'flex\';\n        }\n    <\/script>\n</head>\n<body>\n    <h2>\u4e0a\u4f20\u65b0\u6587\u4ef6</h2>\n    <div id="upload-form-container">\n        <form method="post" enctype="multipart/form-data">\n            <label class="file-upload">\n                \u4e0a\u4f20\u6587\u4ef6\n                <input type="file" name="file" required accept="image/png, image/jpeg, image/gif, image/jpg" onchange="displayFileName(this)">\n            </label>\n            <div class="file-name" id="file-name"></div>\n            <input type="submit" value="\u786e\u8ba4">\n        </form>\n    </div>\n</body>\n</html>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u6620\u5c04\u8def\u7531\u4e0e\u6587\u4ef6\u5141\u8bb8\u8303\u56f4\u4ee3\u7801",children:"\u6620\u5c04\u8def\u7531\u4e0e\u6587\u4ef6\u5141\u8bb8\u8303\u56f4\u4ee3\u7801"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="app.py"',children:"# app.py\n\nfrom flask import Flask, request, redirect, url_for, send_from_directory, render_template\nimport os\n\napp = Flask(__name__)\n\n# \u8bbe\u7f6e\u4e0a\u4f20\u6587\u4ef6\u5939\nUPLOAD_FOLDER = 'uploads'\nos.makedirs(UPLOAD_FOLDER, exist_ok=True)\napp.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER\n\n# \u5141\u8bb8\u7684\u6587\u4ef6\u6269\u5c55\u540d\nALLOWED_EXTENSIONS = {'txt', 'pdf', 'png', 'jpg', 'jpeg', 'gif'}\n\ndef allowed_file(filename):\n    return '.' in filename and filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS\n\n@app.route('/')\ndef index():\n    return render_template('index.html')\n\n@app.route('/upload', methods=['GET', 'POST'])\ndef upload_file():\n    if request.method == 'POST':\n        # \u68c0\u67e5\u662f\u5426\u6709\u6587\u4ef6\u4e0a\u4f20\n        if 'file' not in request.files:\n            return redirect(request.url)\n        file = request.files['file']\n        if file.filename == '':\n            return redirect(request.url)\n        if file and allowed_file(file.filename):\n            filename = file.filename\n            file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))\n            return redirect(url_for('upload_file'))\n\n    # \u663e\u793a\u4e0a\u4f20\u8868\u5355\u548c\u6587\u4ef6\u5217\u8868\n    files = os.listdir(app.config['UPLOAD_FOLDER'])\n    return render_template('upload.html', files=files)\n\n@app.route('/uploads/<filename>')\ndef download_file(filename):\n    return send_from_directory(app.config['UPLOAD_FOLDER'], filename)\n\n# \u65b0\u589e\u7684\u8def\u7531\uff1a\u8bbe\u5907\u9009\u62e9\u9875\u9762\n@app.route('/media_selection')\ndef media_selection():\n    return render_template('media_selection.html')\n\n# \u65b0\u589e\u7684\u8def\u7531\uff1a\u5a92\u4f53\u63a5\u53e3\u9875\u9762\n@app.route('/media_interface')\ndef media_interface():\n    # \u83b7\u53d6\u7528\u6237\u9009\u62e9\u7684\u53c2\u6570\n    screen = request.args.get('screen') == 'on'\n    camera = request.args.get('camera') == 'on'\n    sound = request.args.get('sound') == 'on'\n\n    # \u81f3\u5c11\u9009\u62e9\u4e00\u9879\u5df2\u7ecf\u5728\u524d\u7aef\u9a8c\u8bc1\uff0c\u8fd9\u91cc\u4e0d\u518d\u91cd\u590d\n    return render_template('media_interface.html', screen=screen, camera=camera, sound=sound)\n\nif __name__ == '__main__':\n    app.run(debug=True,host='0.0.0.0',port=8080)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u4f7f\u7528\u6d4f\u89c8\u5668\u63a5\u53e3\u8bbe\u5907\u68c0\u6d4b",children:"\u4f7f\u7528\u6d4f\u89c8\u5668\u63a5\u53e3\u8bbe\u5907\u68c0\u6d4b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",metastring:'showLineNumbers title="deviceDetection.js"',children:"\n// \u68c0\u6d4b\u6444\u50cf\u5934\u662f\u5426\u5b58\u5728\nfunction hasCamera() {\n    return navigator.mediaDevices.enumerateDevices()\n        .then(devices => {\n            return devices.some(device => device.kind === 'videoinput');\n        })\n        .catch(err => {\n            console.error('Error detecting camera:', err);\n            return false;\n        });\n}\n\n// \u68c0\u6d4b\u9ea6\u514b\u98ce\u662f\u5426\u5b58\u5728\nfunction hasMicrophone() {\n    return navigator.mediaDevices.enumerateDevices()\n        .then(devices => {\n            return devices.some(device => device.kind === 'audioinput');\n        })\n        .catch(err => {\n            console.error('Error detecting microphone:', err);\n            return false;\n        });\n}\n\n// \u663e\u793a\u68c0\u6d4b\u7ed3\u679c\nfunction displayDeviceStatus() {\n    hasCamera().then(camera => {\n        const cameraStatus = document.getElementById('camera-status');\n        if (camera) {\n            cameraStatus.textContent = '\u6444\u50cf\u5934: \u5df2\u8fde\u63a5';\n            cameraStatus.style.color = 'green';\n        } else {\n            cameraStatus.textContent = '\u6444\u50cf\u5934: \u672a\u8fde\u63a5';\n            cameraStatus.style.color = 'red';\n        }\n    });\n\n    hasMicrophone().then(microphone => {\n        const microphoneStatus = document.getElementById('microphone-status');\n        if (microphone) {\n            microphoneStatus.textContent = '\u9ea6\u514b\u98ce: \u5df2\u8fde\u63a5';\n            microphoneStatus.style.color = 'green';\n        } else {\n            microphoneStatus.textContent = '\u9ea6\u514b\u98ce: \u672a\u8fde\u63a5';\n            microphoneStatus.style.color = 'red';\n        }\n    });\n}\n\n// \u5f53\u9875\u9762\u52a0\u8f7d\u5b8c\u6210\u540e\u6267\u884c\nwindow.addEventListener('load', displayDeviceStatus);\n\nfunction detectDevices() {\n    if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {\n        console.log('\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u8bbe\u5907\u68c0\u6d4b');\n        return;\n    }\n\n    navigator.mediaDevices.enumerateDevices()\n        .then(function(devices) {\n            let hasCamera = false;\n            let hasMicrophone = false;\n\n            devices.forEach(function(device) {\n                if (device.kind === 'videoinput') {\n                    hasCamera = true;\n                }\n                if (device.kind === 'audioinput') {\n                    hasMicrophone = true;\n                }\n            });\n\n            const cameraCheckbox = document.getElementById('camera-checkbox');\n            const soundCheckbox = document.getElementById('sound-checkbox');\n\n            if (hasCamera) {\n                cameraCheckbox.disabled = false;\n            } else {\n                cameraCheckbox.disabled = true;\n                cameraCheckbox.checked = false;\n            }\n\n            if (hasMicrophone) {\n                soundCheckbox.disabled = false;\n            } else {\n                soundCheckbox.disabled = true;\n                soundCheckbox.checked = false;\n            }\n        })\n        .catch(function(err) {\n            console.error('\u8bbe\u5907\u68c0\u6d4b\u65f6\u51fa\u9519:', err);\n        });\n}\n\n// \u5f53\u9875\u9762\u5185\u5bb9\u52a0\u8f7d\u5b8c\u6bd5\u540e\u6267\u884c\u8bbe\u5907\u68c0\u6d4b\ndocument.addEventListener('DOMContentLoaded', detectDevices);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,r.jsx)(n.p,{children:"\u6d4f\u89c8\u5668\u662f\u73b0\u5728\u7f51\u7edc\u5e94\u7528\u7684\u6807\u914d\uff0c\u4f7f\u7528\u6d4f\u89c8\u5668\u63a5\u53e3\u83b7\u53d6\u8bbe\u5907\u6743\u9650\uff0c\u53ef\u4ee5\u5b9e\u73b0\u7b80\u5355\u4f18\u96c5\u7684\u8de8\u5e73\u53f0\u4f7f\u7528\u3002\u6bcf\u79cd\u8bed\u8a00\u90fd\u6709\u81ea\u5df1\u7684\u4f18\u52bf\uff0cPython\u7684\u751f\u6001\u5f3a\u5927\uff0cJS\u7684\u7075\u6d3b\u6027\u9ad8\uff0c\u4e24\u8005\u7ed3\u5408\u53ef\u4ee5\u5b9e\u73b0\u5f88\u591a\u6709\u8da3\u7684\u5e94\u7528\u3002"})]})}function m(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var i=t(96540);const r={},a=i.createContext(r);function o(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(a.Provider,{value:n},e.children)}},12085:e=>{e.exports=JSON.parse('{"permalink":"/blog/2024/5/31/","source":"@site/blog/2024-5-31.md","title":"\u7528Flask\u642d\u5efa\u5c4f\u5e55\u5171\u4eab\u5de5\u5177","description":"\u8bb0\u5f55\u4f7f\u7528flask\u642d\u5efa\u4e2a\u4eba\u5171\u4eab\u5c4f\u5e55\u5de5\u5177","date":"2024-05-31T00:00:00.000Z","tags":[{"inline":true,"label":"smarthome","permalink":"/blog/tags/smarthome"}],"readingTime":6.76,"hasTruncateMarker":false,"authors":[{"name":"Allen","title":"normal software engineer","url":"https://github.com/jiangyangcreate","socials":{"github":"https://github.com/jiangyangcreate"},"imageURL":"https://jiangmiemie.com/img/logo-192.svg","key":"jiangmiemie","page":null}],"frontMatter":{"title":"\u7528Flask\u642d\u5efa\u5c4f\u5e55\u5171\u4eab\u5de5\u5177","date":"2024-5-31","authors":"jiangmiemie","tags":["smarthome"],"keywords":["smarthome"],"description":"\u8bb0\u5f55\u4f7f\u7528flask\u642d\u5efa\u4e2a\u4eba\u5171\u4eab\u5c4f\u5e55\u5de5\u5177"},"unlisted":false,"prevItem":{"title":"\u6444\u50cf\u5934\u4e91\u53f0\u63a7\u5236\u6307\u4ee4\u89e3\u6790","permalink":"/blog/2024/6/30/"},"nextItem":{"title":"\u81ea\u5236\u667a\u80fd\u5bb6\u5c45\u6d41\u7a0b","permalink":"/blog/2024/4/30/"}}')}}]);