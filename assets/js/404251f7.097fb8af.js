"use strict";(self.webpackChunkjiangmiemie=self.webpackChunkjiangmiemie||[]).push([[7670],{3689:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>c,metadata:()=>l,toc:()=>x});const l=JSON.parse('{"id":"\u540e\u7aef\u901a\u8bc6/Nginx","title":"Nginx","description":"\u6df1\u5165\u7406\u89e3Nginx\u914d\u7f6e\u4e0e\u4f01\u4e1a\u7ea7\u5b9e\u6218","source":"@site/docs/docs/\u540e\u7aef\u901a\u8bc6/Nginx.mdx","sourceDirName":"\u540e\u7aef\u901a\u8bc6","slug":"/\u540e\u7aef\u901a\u8bc6/Nginx","permalink":"/docs/\u540e\u7aef\u901a\u8bc6/Nginx","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"Nginx","description":"\u6df1\u5165\u7406\u89e3Nginx\u914d\u7f6e\u4e0e\u4f01\u4e1a\u7ea7\u5b9e\u6218"},"sidebar":"tutorialSidebar","previous":{"title":"\u7f51\u9875\u81ea\u52a8\u5316","permalink":"/docs/\u540e\u7aef\u901a\u8bc6/\u7f51\u9875\u81ea\u52a8\u5316"},"next":{"title":"\u9879\u76ee\u7ba1\u7406","permalink":"/docs/\u9879\u76ee\u7ba1\u7406/"}}');var s=t(74848),i=t(28453),r=t(11470),d=t(19365);const c={sidebar_position:7,title:"Nginx",description:"\u6df1\u5165\u7406\u89e3Nginx\u914d\u7f6e\u4e0e\u4f01\u4e1a\u7ea7\u5b9e\u6218"},o=void 0,a={},x=[{value:"\u5feb\u901f\u5f00\u59cb",id:"\u5feb\u901f\u5f00\u59cb",level:2},{value:"\u5b89\u88c5 Nginx",id:"\u5b89\u88c5-nginx",level:3},{value:"\u5e38\u7528\u547d\u4ee4",id:"\u5e38\u7528\u547d\u4ee4",level:3},{value:"\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",id:"\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",level:2},{value:"\u6307\u4ee4\u7c7b\u578b",id:"\u6307\u4ee4\u7c7b\u578b",level:3},{value:"Context \u4f5c\u7528\u57df",id:"context-\u4f5c\u7528\u57df",level:3},{value:"\u6807\u51c6\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",id:"\u6807\u51c6\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",level:3},{value:"\u6838\u5fc3\u6a21\u5757\u8be6\u89e3",id:"\u6838\u5fc3\u6a21\u5757\u8be6\u89e3",level:2},{value:"Core Module (\u6838\u5fc3\u6a21\u5757)",id:"core-module-\u6838\u5fc3\u6a21\u5757",level:3},{value:"HTTP Module\uff08HTTP \u6a21\u5757\uff09",id:"http-modulehttp-\u6a21\u5757",level:3},{value:"server \u5757 - \u865a\u62df\u4e3b\u673a",id:"server-\u5757---\u865a\u62df\u4e3b\u673a",level:4},{value:"location \u5757 - URI \u5339\u914d",id:"location-\u5757---uri-\u5339\u914d",level:4},{value:"\u4f01\u4e1a\u7ea7\u5b9e\u6218\u914d\u7f6e",id:"\u4f01\u4e1a\u7ea7\u5b9e\u6218\u914d\u7f6e",level:2},{value:"\u9759\u6001\u8d44\u6e90\u670d\u52a1",id:"\u9759\u6001\u8d44\u6e90\u670d\u52a1",level:3},{value:"\u5355\u9875\u5e94\u7528(SPA)\u90e8\u7f72",id:"\u5355\u9875\u5e94\u7528spa\u90e8\u7f72",level:3},{value:"\u53cd\u5411\u4ee3\u7406",id:"\u53cd\u5411\u4ee3\u7406",level:3},{value:"\u8d1f\u8f7d\u5747\u8861",id:"\u8d1f\u8f7d\u5747\u8861",level:3},{value:"\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5",id:"\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5",level:4},{value:"\u5b8c\u6574\u7684\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e",id:"\u5b8c\u6574\u7684\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e",level:4},{value:"\u670d\u52a1\u5668\u53c2\u6570\u8bf4\u660e",id:"\u670d\u52a1\u5668\u53c2\u6570\u8bf4\u660e",level:4},{value:"HTTPS/SSL\u914d\u7f6e",id:"httpsssl\u914d\u7f6e",level:3},{value:"\u5e38\u7528\u53d8\u91cf\u53c2\u8003",id:"\u5e38\u7528\u53d8\u91cf\u53c2\u8003",level:2},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:2},{value:"\u5de5\u4f5c\u8fdb\u7a0b\u4f18\u5316",id:"\u5de5\u4f5c\u8fdb\u7a0b\u4f18\u5316",level:3},{value:"\u6587\u4ef6\u4f20\u8f93\u4f18\u5316",id:"\u6587\u4ef6\u4f20\u8f93\u4f18\u5316",level:3},{value:"Gzip\u538b\u7f29\u4f18\u5316",id:"gzip\u538b\u7f29\u4f18\u5316",level:3},{value:"\u7f13\u5b58\u914d\u7f6e",id:"\u7f13\u5b58\u914d\u7f6e",level:3},{value:"\u6545\u969c\u6392\u67e5",id:"\u6545\u969c\u6392\u67e5",level:2},{value:"\u67e5\u770b\u65e5\u5fd7",id:"\u67e5\u770b\u65e5\u5fd7",level:3},{value:"\u5e38\u89c1\u9519\u8bef\u6392\u67e5",id:"\u5e38\u89c1\u9519\u8bef\u6392\u67e5",level:3},{value:"\u6d4b\u8bd5\u914d\u7f6e\u6587\u4ef6",id:"\u6d4b\u8bd5\u914d\u7f6e\u6587\u4ef6",level:3},{value:"\u5b89\u5168\u52a0\u56fa",id:"\u5b89\u5168\u52a0\u56fa",level:2},{value:"\u9690\u85cf\u7248\u672c\u53f7",id:"\u9690\u85cf\u7248\u672c\u53f7",level:3},{value:"\u9650\u5236\u8bf7\u6c42\u901f\u7387",id:"\u9650\u5236\u8bf7\u6c42\u901f\u7387",level:3},{value:"\u9650\u5236\u8fde\u63a5\u6570",id:"\u9650\u5236\u8fde\u63a5\u6570",level:3},{value:"\u9632\u6b62\u6076\u610f\u8bbf\u95ee",id:"\u9632\u6b62\u6076\u610f\u8bbf\u95ee",level:3},{value:"\u6700\u4f73\u5b9e\u8df5\u603b\u7ed3",id:"\u6700\u4f73\u5b9e\u8df5\u603b\u7ed3",level:2},{value:"\u53c2\u8003\u8d44\u6e90",id:"\u53c2\u8003\u8d44\u6e90",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Nginx (engine x) \u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684 HTTP \u548c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u7279\u70b9\u662f\u5360\u7528\u5185\u5b58\u5c11\uff0c\u5e76\u53d1\u80fd\u529b\u5f3a\u3002Nginx \u4e13\u4e3a\u6027\u80fd\u4f18\u5316\u800c\u5f00\u53d1\uff0c\u5728\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\u80fd\u591f\u652f\u6301\u9ad8\u8fbe 50,000 \u4e2a\u5e76\u53d1\u8fde\u63a5\u6570\u7684\u54cd\u5e94\u3002"}),"\n",(0,s.jsx)(n.admonition,{title:"Nginx \u7684\u6838\u5fc3\u4f18\u52bf",type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u9ad8\u5e76\u53d1\u9ad8\u6027\u80fd"}),"\uff1a\u57fa\u4e8e\u4e8b\u4ef6\u9a71\u52a8\u67b6\u6784\uff0c\u91c7\u7528\u5f02\u6b65\u975e\u963b\u585e\u65b9\u5f0f\u5904\u7406\u8bf7\u6c42"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u53cd\u5411\u4ee3\u7406\u4e0e\u8d1f\u8f7d\u5747\u8861"}),"\uff1a\u53ef\u5c06\u8bf7\u6c42\u5206\u53d1\u5230\u591a\u4e2a\u540e\u7aef\u670d\u52a1\u5668"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u9759\u6001\u8d44\u6e90\u670d\u52a1"}),"\uff1a\u9ad8\u6548\u5904\u7406\u9759\u6001\u6587\u4ef6"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u70ed\u90e8\u7f72"}),"\uff1a\u53ef\u4ee5\u5728\u4e0d\u505c\u673a\u7684\u60c5\u51b5\u4e0b\u5347\u7ea7"]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"\u5feb\u901f\u5f00\u59cb",children:"\u5feb\u901f\u5f00\u59cb"}),"\n",(0,s.jsx)(n.h3,{id:"\u5b89\u88c5-nginx",children:"\u5b89\u88c5 Nginx"}),"\n",(0,s.jsxs)(r.A,{children:[(0,s.jsx)(d.A,{value:"docker",label:"Docker",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u62c9\u53d6\u5b98\u65b9\u955c\u50cf\ndocker pull nginx:latest\n\n# \u8fd0\u884c\u5bb9\u5668\ndocker run -d \\\n  --name mynginx \\\n  -p 80:80 \\\n  -v /path/to/html:/usr/share/nginx/html:ro \\\n  -v /path/to/nginx.conf:/etc/nginx/nginx.conf:ro \\\n  nginx\n"})})}),(0,s.jsx)(d.A,{value:"ubuntu",label:"Ubuntu/Debian",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u66f4\u65b0\u8f6f\u4ef6\u5305\u7d22\u5f15\nsudo apt update\n\n# \u5b89\u88c5 Nginx\nsudo apt install nginx\n\n# \u542f\u52a8 Nginx \u670d\u52a1\nsudo systemctl start nginx\n\n# \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\nsudo systemctl enable nginx\n"})})}),(0,s.jsx)(d.A,{value:"centos",label:"CentOS/RHEL",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u5b89\u88c5 Nginx\nsudo yum install nginx\n\n# \u542f\u52a8 Nginx \u670d\u52a1\nsudo systemctl start nginx\n\n# \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\nsudo systemctl enable nginx\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"\u5e38\u7528\u547d\u4ee4",children:"\u5e38\u7528\u547d\u4ee4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u6d4b\u8bd5\u914d\u7f6e\u6587\u4ef6\u8bed\u6cd5\nnginx -t\n\n# \u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\uff08\u65e0\u9700\u505c\u6b62\u670d\u52a1\uff09\nnginx -s reload\n\n# \u4f18\u96c5\u505c\u6b62\uff08\u7b49\u5f85 worker \u8fdb\u7a0b\u5b8c\u6210\u5f53\u524d\u8bf7\u6c42\uff09\nnginx -s quit\n\n# \u7acb\u5373\u505c\u6b62\nnginx -s stop\n\n# \u67e5\u770b Nginx \u7248\u672c\nnginx -v\n\n# \u67e5\u770b\u7f16\u8bd1\u914d\u7f6e\u53c2\u6570\nnginx -V\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",children:"\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784"}),"\n",(0,s.jsxs)(n.p,{children:["Nginx \u914d\u7f6e\u6587\u4ef6\u7531",(0,s.jsxs)(n.strong,{children:["\u6307\u4ee4\uff08directives\uff09",(0,s.jsx)(n.strong,{children:"\u7ec4\u6210\uff0c\u5206\u4e3a"}),"\u7b80\u5355\u6307\u4ee4"]}),"\u548c",(0,s.jsx)(n.strong,{children:"\u5757\u6307\u4ee4"}),"\u4e24\u79cd\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u6307\u4ee4\u7c7b\u578b",children:"\u6307\u4ee4\u7c7b\u578b"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u7b80\u5355\u6307\u4ee4"}),"\uff1a\u7531\u6307\u4ee4\u540d\u79f0\u3001\u53c2\u6570\u548c\u5206\u53f7\u7ec4\u6210"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"worker_processes  4;          # \u8bbe\u7f6e worker \u8fdb\u7a0b\u6570\npid        /var/run/nginx.pid; # \u6307\u5b9a pid \u6587\u4ef6\u8def\u5f84\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5757\u6307\u4ee4"}),"\uff1a\u4f7f\u7528\u5927\u62ec\u53f7 ",(0,s.jsx)(n.code,{children:"{}"})," \u5305\u88f9\u5176\u4ed6\u6307\u4ee4\uff0c\u4e0d\u7528\u5206\u53f7\u7ed3\u5c3e"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"events {\n    worker_connections  1024;\n}\n\nhttp {\n    server {\n        location / {\n            # \u914d\u7f6e\u5185\u5bb9\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"context-\u4f5c\u7528\u57df",children:"Context \u4f5c\u7528\u57df"}),"\n",(0,s.jsx)(n.p,{children:"Nginx \u7684\u914d\u7f6e\u6709\u5c42\u7ea7\u7ed3\u6784\uff0c\u6bcf\u4e2a\u5757\u6307\u4ee4\u5f62\u6210\u4e00\u4e2a\u4f5c\u7528\u57df\uff08context\uff09\uff1a"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TD\n    A[main context<br/>\u5168\u5c40\u914d\u7f6e] --\x3e B[events context<br/>\u8fde\u63a5\u5904\u7406]\n    A --\x3e C[http context<br/>HTTP\u914d\u7f6e]\n    C --\x3e D[server context<br/>\u865a\u62df\u4e3b\u673a]\n    D --\x3e E[location context<br/>URI\u5339\u914d\u89c4\u5219]\n    A --\x3e F[stream context<br/>TCP/UDP\u4ee3\u7406]"}),"\n",(0,s.jsx)(n.admonition,{title:"\u914d\u7f6e\u7ee7\u627f\u89c4\u5219",type:"tip",children:(0,s.jsx)(n.p,{children:"\u5b50 context \u4f1a\u7ee7\u627f\u7236 context \u7684\u914d\u7f6e\uff0c\u5b50 context \u4e2d\u7684\u540c\u540d\u6307\u4ee4\u4f1a\u8986\u76d6\u7236 context \u7684\u914d\u7f6e"})}),"\n",(0,s.jsx)(n.h3,{id:"\u6807\u51c6\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",children:"\u6807\u51c6\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="/etc/nginx/nginx.conf" showLineNumbers',children:'# ==================== \u5168\u5c40\u914d\u7f6e ====================\nuser  nginx;                    # worker \u8fdb\u7a0b\u8fd0\u884c\u7528\u6237\nworker_processes  auto;         # worker \u8fdb\u7a0b\u6570\uff0cauto \u8868\u793a\u81ea\u52a8\u68c0\u6d4b CPU \u6838\u5fc3\u6570\n\nerror_log  /var/log/nginx/error.log notice;  # \u9519\u8bef\u65e5\u5fd7\u8def\u5f84\u548c\u7ea7\u522b\npid        /var/run/nginx.pid;               # pid \u6587\u4ef6\u8def\u5f84\n\n# ==================== \u4e8b\u4ef6\u6a21\u5757 ====================\nevents {\n    worker_connections  1024;   # \u6bcf\u4e2a worker \u8fdb\u7a0b\u7684\u6700\u5927\u8fde\u63a5\u6570\n    use epoll;                  # \u4f7f\u7528 epoll \u4e8b\u4ef6\u9a71\u52a8\u6a21\u578b\uff08Linux \u63a8\u8350\uff09\n}\n\n# ==================== HTTP\u6a21\u5757 ====================\nhttp {\n    # MIME\u7c7b\u578b\u914d\u7f6e\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n\n    # \u65e5\u5fd7\u683c\u5f0f\u5b9a\u4e49\n    log_format  main  \'$remote_addr - $remote_user [$time_local] "$request" \'\n                      \'$status $body_bytes_sent "$http_referer" \'\n                      \'"$http_user_agent" "$http_x_forwarded_for"\';\n\n    access_log  /var/log/nginx/access.log  main;\n\n    # \u6027\u80fd\u4f18\u5316\n    sendfile        on;         # \u9ad8\u6548\u6587\u4ef6\u4f20\u8f93\n    tcp_nopush      on;         # \u4f18\u5316\u6570\u636e\u5305\u53d1\u9001\n    tcp_nodelay     on;         # \u7981\u7528 Nagle \u7b97\u6cd5\uff0c\u51cf\u5c11\u5ef6\u8fdf\n    keepalive_timeout  65;      # \u957f\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\n\n    # Gzip \u538b\u7f29\n    gzip  on;\n    gzip_vary on;\n    gzip_comp_level 6;\n    gzip_types text/plain text/css text/xml text/javascript \n               application/json application/javascript application/xml+rss;\n\n    # \u5f15\u5165\u5176\u4ed6\u914d\u7f6e\u6587\u4ef6\n    include /etc/nginx/conf.d/*.conf;\n    include /etc/nginx/sites-enabled/*;\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\u6838\u5fc3\u6a21\u5757\u8be6\u89e3",children:"\u6838\u5fc3\u6a21\u5757\u8be6\u89e3"}),"\n",(0,s.jsx)(n.h3,{id:"core-module-\u6838\u5fc3\u6a21\u5757",children:"Core Module (\u6838\u5fc3\u6a21\u5757)"}),"\n",(0,s.jsx)(n.p,{children:"\u6838\u5fc3\u6a21\u5757\u63d0\u4f9bNginx\u7684\u57fa\u7840\u529f\u80fd\u914d\u7f6e\uff1a"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u6307\u4ee4"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u8bf4\u660e"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u793a\u4f8b"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"worker_processes"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"worker\u8fdb\u7a0b\u6570\u91cf"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"worker_processes auto;"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"worker_connections"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u6bcf\u4e2aworker\u7684\u6700\u5927\u8fde\u63a5\u6570"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"worker_connections 1024;"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"error_log"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u9519\u8bef\u65e5\u5fd7\u8def\u5f84\u548c\u7ea7\u522b"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"error_log logs/error.log warn;"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"pid"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u4e3b\u8fdb\u7a0bPID\u6587\u4ef6\u8def\u5f84"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"pid /var/run/nginx.pid;"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"include"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5f15\u5165\u5176\u4ed6\u914d\u7f6e\u6587\u4ef6"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"include /etc/nginx/conf.d/*.conf;"})})]})]})]}),"\n",(0,s.jsx)(n.admonition,{title:"\u6027\u80fd\u4f18\u5316\u5efa\u8bae",type:"warning",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"worker_processes"})," \u901a\u5e38\u8bbe\u7f6e\u4e3a CPU \u6838\u5fc3\u6570\u6216\u8bbe\u4e3a ",(0,s.jsx)(n.code,{children:"auto"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"worker_connections"})," \u9ed8\u8ba4 1024\uff0c\u9ad8\u5e76\u53d1\u573a\u666f\u53ef\u8bbe\u4e3a 4096 \u6216\u66f4\u9ad8"]}),"\n",(0,s.jsxs)(n.li,{children:["\u9700\u540c\u65f6\u8c03\u6574\u7cfb\u7edf\u7684 ",(0,s.jsx)(n.code,{children:"ulimit -n"})," \u53c2\u6570"]}),"\n"]})}),"\n",(0,s.jsx)(n.h3,{id:"http-modulehttp-\u6a21\u5757",children:"HTTP Module\uff08HTTP \u6a21\u5757\uff09"}),"\n",(0,s.jsx)(n.p,{children:"HTTP \u6a21\u5757\u662f Nginx \u6700\u91cd\u8981\u7684\u6a21\u5757\uff0c\u7528\u4e8e\u914d\u7f6e HTTP/HTTPS \u670d\u52a1\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"server-\u5757---\u865a\u62df\u4e3b\u673a",children:"server \u5757 - \u865a\u62df\u4e3b\u673a"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"server"})," \u5757\u5b9a\u4e49\u865a\u62df\u4e3b\u673a\uff0c\u53ef\u914d\u7f6e\u591a\u4e2a\u865a\u62df\u4e3b\u673a\u76d1\u542c\u4e0d\u540c\u7aef\u53e3\u6216\u57df\u540d\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="\u57fa\u7840\u865a\u62df\u4e3b\u673a\u914d\u7f6e" {2,3,5-7}',children:"server {\n    listen       80;                    # \u76d1\u542c\u7aef\u53e3\n    server_name  example.com www.example.com;  # \u57df\u540d\n\n    # \u8bbf\u95ee\u65e5\u5fd7\uff08\u53ef\u4e3a\u6bcf\u4e2a\u865a\u62df\u4e3b\u673a\u5355\u72ec\u914d\u7f6e\uff09\n    access_log  /var/log/nginx/example.access.log  main;\n    error_log   /var/log/nginx/example.error.log   warn;\n\n    location / {\n        root   /usr/share/nginx/html;\n        index  index.html index.htm;\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"location-\u5757---uri-\u5339\u914d",children:"location \u5757 - URI \u5339\u914d"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"location"})," \u7528\u4e8e\u5339\u914d URI \u8def\u5f84\uff0c\u652f\u6301\u591a\u79cd\u5339\u914d\u6a21\u5f0f\uff1a"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u5339\u914d\u6a21\u5f0f"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u8bed\u6cd5"}),(0,s.jsx)(n.th,{style:{textAlign:"center"},children:"\u4f18\u5148\u7ea7"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u8bf4\u660e"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u7cbe\u786e\u5339\u914d"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"location = /path"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"1"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b8c\u5168\u5339\u914dURI"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u524d\u7f00\u5339\u914d\uff08\u4f18\u5148\uff09"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"location ^~ /path"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"2"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u524d\u7f00\u5339\u914d\uff0c\u5339\u914d\u6210\u529f\u540e\u505c\u6b62\u641c\u7d22"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u6b63\u5219\u5339\u914d\uff08\u533a\u5206\u5927\u5c0f\u5199\uff09"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"location ~ pattern"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"3"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u6b63\u5219\u5339\u914d\uff08\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff09"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"location ~* pattern"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"3"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u524d\u7f00\u5339\u914d"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"location /path"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"4"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u666e\u901a\u524d\u7f00\u5339\u914d"})]})]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="location\u5339\u914d\u793a\u4f8b"',children:'server {\n    listen 80;\n    server_name example.com;\n\n    # \u7cbe\u786e\u5339\u914d\uff1a\u53ea\u5339\u914d /\n    location = / {\n        return 200 "\u7cbe\u786e\u5339\u914d\u9996\u9875";\n    }\n\n    # \u4f18\u5148\u524d\u7f00\u5339\u914d\uff1a\u5339\u914d /api/ \u5f00\u5934\u7684\u6240\u6709\u8bf7\u6c42\n    location ^~ /api/ {\n        proxy_pass http://backend:8080;\n    }\n\n    # \u6b63\u5219\u5339\u914d\uff1a\u5339\u914d\u56fe\u7247\u6587\u4ef6\n    location ~* \\.(gif|jpg|jpeg|png|webp)$ {\n        root /data/images;\n        expires 30d;  # \u7f13\u5b5830\u5929\n    }\n\n    # \u6b63\u5219\u5339\u914d\uff1a\u5339\u914d\u9759\u6001\u8d44\u6e90\n    location ~ \\.(css|js)$ {\n        root /data/static;\n        expires 7d;\n    }\n\n    # \u666e\u901a\u524d\u7f00\u5339\u914d\uff1a\u5339\u914d\u6240\u6709 /docs/ \u5f00\u5934\u7684\u8bf7\u6c42\n    location /docs/ {\n        root /usr/share/nginx;\n    }\n\n    # \u9ed8\u8ba4\u5339\u914d\uff1a\u5176\u4ed6\u6240\u6709\u8bf7\u6c42\n    location / {\n        root /usr/share/nginx/html;\n        index index.html;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\u4f01\u4e1a\u7ea7\u5b9e\u6218\u914d\u7f6e",children:"\u4f01\u4e1a\u7ea7\u5b9e\u6218\u914d\u7f6e"}),"\n",(0,s.jsx)(n.h3,{id:"\u9759\u6001\u8d44\u6e90\u670d\u52a1",children:"\u9759\u6001\u8d44\u6e90\u670d\u52a1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="/etc/nginx/conf.d/static.conf" showLineNumbers',children:'server {\n    listen       80;\n    server_name  static.example.com;\n\n    # \u8bbf\u95ee\u65e5\u5fd7\n    access_log  /var/log/nginx/static.access.log  main;\n\n    # \u7f51\u7ad9\u6839\u76ee\u5f55\n    root /data/www;\n\n    # \u9ed8\u8ba4\u9996\u9875\n    location / {\n        index  index.html index.htm;\n        try_files $uri $uri/ =404;\n    }\n\n    # \u56fe\u7247\u8d44\u6e90\u76ee\u5f55\n    location /images/ {\n        alias /data/images/;           # \u4f7f\u7528alias\u91cd\u5b9a\u5411\u8def\u5f84\n        \n        # \u7f13\u5b58\u914d\u7f6e\n        expires 30d;                   # \u6d4f\u89c8\u5668\u7f13\u5b5830\u5929\n        add_header Cache-Control "public, immutable";\n        \n        # \u8de8\u57df\u914d\u7f6e\n        add_header Access-Control-Allow-Origin *;\n    }\n\n    # \u5339\u914d\u7279\u5b9a\u6269\u5c55\u540d\u7684\u9759\u6001\u8d44\u6e90\n    location ~* \\.(gif|jpg|jpeg|png|webp|svg|ico)$ {\n        root /data/images;\n        expires 30d;\n        access_log off;                # \u4e0d\u8bb0\u5f55\u8bbf\u95ee\u65e5\u5fd7\n    }\n\n    # CSS\u548cJS\u6587\u4ef6\n    location ~* \\.(css|js)$ {\n        root /data/www;\n        expires 7d;\n        add_header Cache-Control "public";\n    }\n\n    # \u5b57\u4f53\u6587\u4ef6\n    location ~* \\.(woff|woff2|ttf|otf|eot)$ {\n        root /data/fonts;\n        expires 1y;\n        add_header Access-Control-Allow-Origin *;\n    }\n\n    # \u7981\u6b62\u8bbf\u95ee\u9690\u85cf\u6587\u4ef6\n    location ~ /\\. {\n        deny all;\n        access_log off;\n        log_not_found off;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u5355\u9875\u5e94\u7528spa\u90e8\u7f72",children:"\u5355\u9875\u5e94\u7528(SPA)\u90e8\u7f72"}),"\n",(0,s.jsx)(n.p,{children:"\u5355\u9875\u5e94\u7528\uff08React/Vue/Angular\uff09\u4f7f\u7528\u524d\u7aef\u8def\u7531\uff0c\u9700\u8981\u7279\u6b8a\u914d\u7f6e\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="/etc/nginx/conf.d/spa.conf" showLineNumbers',children:'server {\n    listen       80;\n    server_name  app.example.com;\n\n    root /usr/share/nginx/html;\n    index index.html;\n\n    # \u524d\u7aef\u8def\u7531\u914d\u7f6e\uff1a\u6240\u6709\u8def\u5f84\u90fd\u8fd4\u56de index.html\n    location / {\n        try_files $uri $uri/ /index.html;\n    }\n\n    # API\u8bf7\u6c42\u4ee3\u7406\u5230\u540e\u7aef\n    location /api/ {\n        proxy_pass http://backend:8080/;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n\n    # \u9759\u6001\u8d44\u6e90\u7f13\u5b58\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {\n        expires 1y;\n        add_header Cache-Control "public, immutable";\n    }\n\n    # Service Worker\u4e0d\u7f13\u5b58\n    location = /service-worker.js {\n        expires off;\n        add_header Cache-Control "no-cache, no-store, must-revalidate";\n    }\n\n    # \u5b89\u5168\u5934\u90e8\n    add_header X-Frame-Options "SAMEORIGIN" always;\n    add_header X-Content-Type-Options "nosniff" always;\n    add_header X-XSS-Protection "1; mode=block" always;\n}\n'})}),"\n",(0,s.jsxs)(n.admonition,{title:"SPA\u914d\u7f6e\u8981\u70b9",type:"tip",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"try_files $uri $uri/ /index.html;"})," \u7684\u4f5c\u7528\uff1a"]}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u5148\u5c1d\u8bd5\u8bbf\u95ee ",(0,s.jsx)(n.code,{children:"$uri"})," \u5bf9\u5e94\u7684\u6587\u4ef6"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5c1d\u8bd5\u8bbf\u95ee ",(0,s.jsx)(n.code,{children:"$uri/"})," \u76ee\u5f55"]}),"\n",(0,s.jsxs)(n.li,{children:["\u90fd\u4e0d\u5b58\u5728\u65f6\uff0c\u8fd4\u56de ",(0,s.jsx)(n.code,{children:"index.html"}),"\uff0c\u4ea4\u7531\u524d\u7aef\u8def\u7531\u5904\u7406"]}),"\n"]})]}),"\n",(0,s.jsx)(n.h3,{id:"\u53cd\u5411\u4ee3\u7406",children:"\u53cd\u5411\u4ee3\u7406"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="/etc/nginx/conf.d/proxy.conf" showLineNumbers',children:'server {\n    listen       80;\n    server_name  api.example.com;\n\n    # \u4ee3\u7406\u5230\u540e\u7aef\u670d\u52a1\n    location /api/ {\n        # \u4ee3\u7406\u76ee\u6807\uff08\u6ce8\u610f\u672b\u5c3e\u7684 / \u4f1a\u66ff\u6362\u6389 /api/\uff09\n        proxy_pass http://localhost:8080/;\n\n        # === \u8bf7\u6c42\u5934\u914d\u7f6e ===\n        proxy_set_header Host $host;                      # \u4f20\u9012\u539f\u59cbHost\n        proxy_set_header X-Real-IP $remote_addr;          # \u5ba2\u6237\u7aef\u771f\u5b9eIP\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;  # \u4ee3\u7406\u94feIP\n        proxy_set_header X-Forwarded-Proto $scheme;       # \u539f\u59cb\u534f\u8bae(http/https)\n\n        # === \u8d85\u65f6\u914d\u7f6e ===\n        proxy_connect_timeout 60s;   # \u8fde\u63a5\u540e\u7aef\u8d85\u65f6\u65f6\u95f4\n        proxy_send_timeout 60s;      # \u53d1\u9001\u8bf7\u6c42\u8d85\u65f6\u65f6\u95f4\n        proxy_read_timeout 60s;      # \u8bfb\u53d6\u54cd\u5e94\u8d85\u65f6\u65f6\u95f4\n\n        # === \u7f13\u51b2\u914d\u7f6e ===\n        proxy_buffering on;              # \u542f\u7528\u7f13\u51b2\n        proxy_buffer_size 4k;            # \u7f13\u51b2\u533a\u5927\u5c0f\n        proxy_buffers 8 4k;              # \u7f13\u51b2\u533a\u6570\u91cf\u548c\u5927\u5c0f\n        proxy_busy_buffers_size 8k;      # \u5fd9\u788c\u7f13\u51b2\u533a\u5927\u5c0f\n\n        # === \u5176\u4ed6\u914d\u7f6e ===\n        proxy_redirect off;              # \u4e0d\u4fee\u6539\u91cd\u5b9a\u5411\u54cd\u5e94\n        proxy_http_version 1.1;          # \u4f7f\u7528HTTP/1.1\n        proxy_set_header Connection ""; # \u652f\u6301\u957f\u8fde\u63a5\n    }\n\n    # WebSocket\u4ee3\u7406\n    location /ws/ {\n        proxy_pass http://localhost:8080/ws/;\n        \n        # WebSocket\u5fc5\u9700\u914d\u7f6e\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "upgrade";\n        proxy_set_header Host $host;\n        \n        # \u8d85\u65f6\u65f6\u95f4\uff08WebSocket\u901a\u5e38\u9700\u8981\u66f4\u957f\u7684\u8d85\u65f6\uff09\n        proxy_read_timeout 3600s;\n        proxy_send_timeout 3600s;\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.admonition,{title:"proxy_pass\u7684\u8def\u5f84\u89c4\u5219",type:"warning",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"proxy_pass http://backend;"})," - \u4fdd\u7559location\u5339\u914d\u7684\u8def\u5f84"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"proxy_pass http://backend/;"})," - \u66ff\u6362location\u5339\u914d\u7684\u8def\u5f84"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"proxy_pass http://backend/api;"})," - \u4f7f\u7528\u6307\u5b9a\u8def\u5f84\u66ff\u6362"]}),"\n"]}),(0,s.jsx)(n.p,{children:"\u793a\u4f8b\uff1a"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"location /api/ {\n    # \u8bbf\u95ee /api/users \u4f1a\u4ee3\u7406\u5230 http://backend/users\n    proxy_pass http://backend/;\n}\n\nlocation /api/ {\n    # \u8bbf\u95ee /api/users \u4f1a\u4ee3\u7406\u5230 http://backend/api/users\n    proxy_pass http://backend;\n}\n"})})]}),"\n",(0,s.jsx)(n.h3,{id:"\u8d1f\u8f7d\u5747\u8861",children:"\u8d1f\u8f7d\u5747\u8861"}),"\n",(0,s.jsx)(n.p,{children:"Nginx\u652f\u6301\u5c06\u8bf7\u6c42\u5206\u53d1\u5230\u591a\u4e2a\u540e\u7aef\u670d\u52a1\u5668\uff0c\u5b9e\u73b0\u9ad8\u53ef\u7528\u548c\u8d1f\u8f7d\u5747\u8861\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5",children:"\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5"}),"\n",(0,s.jsx)(n.p,{children:"Nginx\u652f\u6301\u4e09\u79cd\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff1a"}),"\n",(0,s.jsxs)(r.A,{children:[(0,s.jsxs)(d.A,{value:"round-robin",label:"\u8f6e\u8be2(\u9ed8\u8ba4)",default:!0,children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8f6e\u8be2(round-robin)"}),"\uff1a\u4f9d\u6b21\u5c06\u8bf7\u6c42\u5206\u914d\u7ed9\u6bcf\u4e2a\u670d\u52a1\u5668\uff0c\u652f\u6301\u6309\u6743\u91cd\u6bd4\u4f8b\u5206\u914d\u3002"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="\u8f6e\u8be2\u7b97\u6cd5"',children:"upstream backend {\n    server backend1.example.com;\n    server backend2.example.com;\n    server backend3.example.com;\n}\n\n# \u52a0\u6743\u8f6e\u8be2\nupstream backend_weighted {\n    server backend1.example.com weight=3;  # \u6743\u91cd3\uff0c\u63a5\u65363/6\u7684\u8bf7\u6c42\n    server backend2.example.com weight=2;  # \u6743\u91cd2\uff0c\u63a5\u65362/6\u7684\u8bf7\u6c42\n    server backend3.example.com weight=1;  # \u6743\u91cd1\uff0c\u63a5\u65361/6\u7684\u8bf7\u6c42\n}\n"})}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u9002\u7528\u573a\u666f"}),"\uff1a\u5404\u670d\u52a1\u5668\u6027\u80fd\u76f8\u8fd1\u7684\u573a\u666f\n",(0,s.jsx)(n.strong,{children:"\u4f18\u70b9"}),"\uff1a\u914d\u7f6e\u7b80\u5355\uff0c\u8bf7\u6c42\u5206\u914d\u5747\u5300\n",(0,s.jsx)(n.strong,{children:"\u7f3a\u70b9"}),"\uff1a\u4e0d\u8003\u8651\u670d\u52a1\u5668\u5f53\u524d\u8d1f\u8f7d\u72b6\u6001"]})]}),(0,s.jsxs)(d.A,{value:"least-conn",label:"\u6700\u5c11\u8fde\u63a5",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u6700\u5c11\u8fde\u63a5(least_conn)"}),"\uff1a\u5c06\u8bf7\u6c42\u5206\u914d\u7ed9\u5f53\u524d\u6d3b\u8dc3\u8fde\u63a5\u6570\u6700\u5c11\u7684\u670d\u52a1\u5668\u3002"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="\u6700\u5c11\u8fde\u63a5\u7b97\u6cd5"',children:"upstream backend {\n    least_conn;  # \u542f\u7528\u6700\u5c11\u8fde\u63a5\u7b97\u6cd5\n    \n    server backend1.example.com;\n    server backend2.example.com;\n    server backend3.example.com;\n}\n"})}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u9002\u7528\u573a\u666f"}),"\uff1a\u8bf7\u6c42\u5904\u7406\u65f6\u95f4\u5dee\u5f02\u8f83\u5927\u7684\u573a\u666f\n",(0,s.jsx)(n.strong,{children:"\u4f18\u70b9"}),"\uff1a\u66f4\u667a\u80fd\u7684\u8d1f\u8f7d\u5206\u914d\uff0c\u907f\u514d\u67d0\u53f0\u670d\u52a1\u5668\u8fc7\u8f7d\n",(0,s.jsx)(n.strong,{children:"\u7f3a\u70b9"}),"\uff1a\u76f8\u6bd4\u8f6e\u8be2\uff0c\u8ba1\u7b97\u5f00\u9500\u7565\u5927"]})]}),(0,s.jsxs)(d.A,{value:"ip-hash",label:"IP\u54c8\u5e0c",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"IP\u54c8\u5e0c(ip_hash)"}),"\uff1a\u6839\u636e\u5ba2\u6237\u7aefIP\u8ba1\u7b97\u54c8\u5e0c\u503c\uff0c\u56fa\u5b9a\u5206\u914d\u5230\u7279\u5b9a\u670d\u52a1\u5668\u3002"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="IP\u54c8\u5e0c\u7b97\u6cd5"',children:"upstream backend {\n    ip_hash;  # \u542f\u7528IP\u54c8\u5e0c\u7b97\u6cd5\n    \n    server backend1.example.com;\n    server backend2.example.com;\n    server backend3.example.com;\n}\n"})}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u9002\u7528\u573a\u666f"}),"\uff1a\u9700\u8981\u4f1a\u8bdd\u4fdd\u6301\uff08session sticky\uff09\u7684\u573a\u666f\n",(0,s.jsx)(n.strong,{children:"\u4f18\u70b9"}),"\uff1a\u540c\u4e00\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u56fa\u5b9a\u8def\u7531\u5230\u540c\u4e00\u670d\u52a1\u5668\n",(0,s.jsx)(n.strong,{children:"\u7f3a\u70b9"}),"\uff1a\u53ef\u80fd\u5bfc\u81f4\u8d1f\u8f7d\u4e0d\u5747\uff0c\u4e0d\u652f\u6301weight\u53c2\u6570"]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"\u5b8c\u6574\u7684\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e",children:"\u5b8c\u6574\u7684\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="/etc/nginx/conf.d/loadbalance.conf" showLineNumbers',children:'# ==================== \u4e0a\u6e38\u670d\u52a1\u5668\u5b9a\u4e49 ====================\nupstream backend_servers {\n    # \u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff08\u9ed8\u8ba4\u8f6e\u8be2\uff0c\u53ef\u9009 least_conn \u6216 ip_hash\uff09\n    least_conn;\n\n    # \u540e\u7aef\u670d\u52a1\u5668\u5217\u8868\n    server 192.168.1.101:8080 weight=3 max_fails=2 fail_timeout=30s;\n    server 192.168.1.102:8080 weight=2 max_fails=2 fail_timeout=30s;\n    server 192.168.1.103:8080 weight=1 max_fails=2 fail_timeout=30s;\n    server 192.168.1.104:8080 backup;  # \u5907\u4efd\u670d\u52a1\u5668\uff0c\u4ec5\u5728\u5176\u4ed6\u670d\u52a1\u5668\u90fd\u4e0d\u53ef\u7528\u65f6\u4f7f\u7528\n    \n    # \u957f\u8fde\u63a5\u914d\u7f6e\uff08\u63d0\u9ad8\u6027\u80fd\uff09\n    keepalive 32;  # \u4fdd\u630132\u4e2a\u957f\u8fde\u63a5\n}\n\n# ==================== \u865a\u62df\u4e3b\u673a\u914d\u7f6e ====================\nserver {\n    listen       80;\n    server_name  www.example.com;\n\n    location / {\n        # \u4ee3\u7406\u5230\u4e0a\u6e38\u670d\u52a1\u5668\u7ec4\n        proxy_pass http://backend_servers;\n\n        # \u8bf7\u6c42\u5934\u914d\u7f6e\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n        # \u652f\u6301\u957f\u8fde\u63a5\n        proxy_http_version 1.1;\n        proxy_set_header Connection "";\n\n        # \u8d85\u65f6\u914d\u7f6e\n        proxy_connect_timeout 5s;\n        proxy_send_timeout 60s;\n        proxy_read_timeout 60s;\n\n        # \u9519\u8bef\u5904\u7406\uff1a\u5982\u679c\u540e\u7aef\u8fd4\u56de502/503/504\uff0c\u5c1d\u8bd5\u4e0b\u4e00\u4e2a\u670d\u52a1\u5668\n        proxy_next_upstream error timeout http_502 http_503 http_504;\n        proxy_next_upstream_tries 2;      # \u6700\u591a\u5c1d\u8bd52\u6b21\n        proxy_next_upstream_timeout 10s;  # \u5c1d\u8bd5\u603b\u8d85\u65f6\u65f6\u95f4\n    }\n\n    # \u5065\u5eb7\u68c0\u67e5\u9875\u9762\uff08\u7528\u4e8e\u8d1f\u8f7d\u5747\u8861\u5668\u68c0\u67e5Nginx\u72b6\u6001\uff09\n    location /health {\n        access_log off;\n        return 200 "healthy\\n";\n        add_header Content-Type text/plain;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"\u670d\u52a1\u5668\u53c2\u6570\u8bf4\u660e",children:"\u670d\u52a1\u5668\u53c2\u6570\u8bf4\u660e"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u53c2\u6570"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u8bf4\u660e"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u793a\u4f8b"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"weight"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u6743\u91cd\uff0c\u9ed8\u8ba4\u4e3a1"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"weight=3"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"max_fails"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5931\u8d25\u6b21\u6570\uff0c\u8d85\u8fc7\u540e\u6807\u8bb0\u4e3a\u4e0d\u53ef\u7528"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"max_fails=2"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"fail_timeout"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5931\u8d25\u8d85\u65f6\u65f6\u95f4"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"fail_timeout=30s"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"backup"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5907\u4efd\u670d\u52a1\u5668"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"backup"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"down"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u6807\u8bb0\u670d\u52a1\u5668\u6c38\u4e45\u4e0d\u53ef\u7528"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"down"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"max_conns"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u6700\u5927\u8fde\u63a5\u6570\u9650\u5236"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"max_conns=100"})})]})]})]}),"\n",(0,s.jsxs)(n.admonition,{title:"\u5065\u5eb7\u68c0\u67e5\u673a\u5236",type:"info",children:[(0,s.jsx)(n.p,{children:"Nginx\u81ea\u5e26\u88ab\u52a8\u5065\u5eb7\u68c0\u67e5\uff1a"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u5f53\u540e\u7aef\u670d\u52a1\u5668\u8fde\u7eed\u5931\u8d25 ",(0,s.jsx)(n.code,{children:"max_fails"})," \u6b21\u540e\uff0c\u6807\u8bb0\u4e3a\u4e0d\u53ef\u7528"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5728 ",(0,s.jsx)(n.code,{children:"fail_timeout"})," \u65f6\u95f4\u5185\u4e0d\u518d\u5206\u914d\u8bf7\u6c42"]}),"\n",(0,s.jsx)(n.li,{children:"\u65f6\u95f4\u5230\u671f\u540e\u81ea\u52a8\u5c1d\u8bd5\u6062\u590d"}),"\n",(0,s.jsx)(n.li,{children:"\u4e3b\u52a8\u5065\u5eb7\u68c0\u67e5\u9700\u8981\u5546\u4e1a\u7248Nginx Plus\u6216\u4f7f\u7528\u7b2c\u4e09\u65b9\u6a21\u5757"}),"\n"]})]}),"\n",(0,s.jsx)(n.h3,{id:"httpsssl\u914d\u7f6e",children:"HTTPS/SSL\u914d\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="/etc/nginx/conf.d/ssl.conf" showLineNumbers',children:'# ==================== HTTP\u91cd\u5b9a\u5411\u5230HTTPS ====================\nserver {\n    listen       80;\n    server_name  example.com www.example.com;\n\n    # \u5c06\u6240\u6709HTTP\u8bf7\u6c42\u91cd\u5b9a\u5411\u5230HTTPS\n    return 301 https://$server_name$request_uri;\n}\n\n# ==================== HTTPS\u914d\u7f6e ====================\nserver {\n    listen       443 ssl http2;  # \u542f\u7528SSL\u548cHTTP/2\n    server_name  example.com www.example.com;\n\n    # === SSL\u8bc1\u4e66\u914d\u7f6e ===\n    ssl_certificate      /etc/nginx/ssl/example.com.crt;      # \u8bc1\u4e66\u6587\u4ef6\n    ssl_certificate_key  /etc/nginx/ssl/example.com.key;      # \u79c1\u94a5\u6587\u4ef6\n    ssl_trusted_certificate /etc/nginx/ssl/ca-bundle.crt;     # CA\u8bc1\u4e66\u94fe\n\n    # === SSL\u534f\u8bae\u548c\u52a0\u5bc6\u5957\u4ef6 ===\n    ssl_protocols        TLSv1.2 TLSv1.3;  # \u4ec5\u652f\u6301TLS 1.2\u548c1.3\n    ssl_ciphers          HIGH:!aNULL:!MD5:!RC4:!3DES;  # \u52a0\u5bc6\u5957\u4ef6\n    ssl_prefer_server_ciphers on;  # \u4f18\u5148\u4f7f\u7528\u670d\u52a1\u5668\u7aef\u52a0\u5bc6\u5957\u4ef6\n\n    # === SSL\u4f1a\u8bdd\u7f13\u5b58 ===\n    ssl_session_cache    shared:SSL:10m;   # \u5171\u4eab\u7f13\u5b58\uff0c\u5927\u5c0f10MB\n    ssl_session_timeout  10m;              # \u4f1a\u8bdd\u8d85\u65f6\u65f6\u95f410\u5206\u949f\n    ssl_session_tickets  off;              # \u5173\u95edsession ticket\uff08\u66f4\u5b89\u5168\uff09\n\n    # === OCSP Stapling\uff08\u63d0\u9ad8SSL\u63e1\u624b\u6027\u80fd\uff09===\n    ssl_stapling on;\n    ssl_stapling_verify on;\n    resolver 8.8.8.8 8.8.4.4 valid=300s;   # DNS\u89e3\u6790\u5668\n    resolver_timeout 5s;\n\n    # === \u5b89\u5168\u5934\u90e8 ===\n    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;  # HSTS\n    add_header X-Frame-Options "SAMEORIGIN" always;\n    add_header X-Content-Type-Options "nosniff" always;\n    add_header X-XSS-Protection "1; mode=block" always;\n\n    # === \u7ad9\u70b9\u914d\u7f6e ===\n    root /usr/share/nginx/html;\n    index index.html;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.admonition,{title:"\u514d\u8d39SSL\u8bc1\u4e66",type:"tip",children:[(0,s.jsxs)(n.p,{children:["\u63a8\u8350\u4f7f\u7528 ",(0,s.jsx)(n.a,{href:"https://letsencrypt.org/",children:"Let's Encrypt"})," \u83b7\u53d6\u514d\u8d39SSL\u8bc1\u4e66\uff1a"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u5b89\u88c5certbot\nsudo apt install certbot python3-certbot-nginx\n\n# \u81ea\u52a8\u914d\u7f6eNginx SSL\nsudo certbot --nginx -d example.com -d www.example.com\n\n# \u81ea\u52a8\u7eed\u671f\uff08\u6dfb\u52a0\u5230crontab\uff09\n0 0 * * * certbot renew --quiet\n"})})]}),"\n",(0,s.jsx)(n.h2,{id:"\u5e38\u7528\u53d8\u91cf\u53c2\u8003",children:"\u5e38\u7528\u53d8\u91cf\u53c2\u8003"}),"\n",(0,s.jsx)(n.p,{children:"Nginx\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u5185\u7f6e\u53d8\u91cf\uff0c\u53ef\u5728\u914d\u7f6e\u4e2d\u4f7f\u7528\uff1a"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u53d8\u91cf"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u8bf4\u660e"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u793a\u4f8b\u503c"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$host"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u8bf7\u6c42\u7684\u4e3b\u673a\u540d"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"example.com"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$uri"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5f53\u524d\u8bf7\u6c42\u7684URI\uff08\u4e0d\u542b\u53c2\u6570\uff09"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"/api/users"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$request_uri"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b8c\u6574\u7684\u539f\u59cb\u8bf7\u6c42URI\uff08\u542b\u53c2\u6570\uff09"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"/api/users?id=1"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$args"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u8bf7\u6c42\u53c2\u6570"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"id=1&name=test"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$remote_addr"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5ba2\u6237\u7aefIP\u5730\u5740"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"192.168.1.100"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$remote_port"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5ba2\u6237\u7aef\u7aef\u53e3"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"54321"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$server_addr"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u670d\u52a1\u5668IP\u5730\u5740"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"10.0.0.1"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$server_port"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u670d\u52a1\u5668\u7aef\u53e3"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"80"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$scheme"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u8bf7\u6c42\u534f\u8bae"}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.code,{children:"http"})," \u6216 ",(0,s.jsx)(n.code,{children:"https"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$request_method"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u8bf7\u6c42\u65b9\u6cd5"}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.code,{children:"GET"})," ",(0,s.jsx)(n.code,{children:"POST"})," \u7b49"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$content_type"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Content-Type\u5934"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"application/json"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$http_user_agent"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"User-Agent\u5934"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"Mozilla/5.0..."})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"$http_referer"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Referer\u5934"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"https://google.com"})})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,s.jsx)(n.h3,{id:"\u5de5\u4f5c\u8fdb\u7a0b\u4f18\u5316",children:"\u5de5\u4f5c\u8fdb\u7a0b\u4f18\u5316"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# \u81ea\u52a8\u8bbe\u7f6e\u4e3aCPU\u6838\u5fc3\u6570\nworker_processes auto;\n\n# \u5c06worker\u8fdb\u7a0b\u7ed1\u5b9a\u5230\u7279\u5b9aCPU\u6838\u5fc3\uff08\u907f\u514d\u8fdb\u7a0b\u5207\u6362\u5f00\u9500\uff09\nworker_cpu_affinity auto;\n\n# \u6bcf\u4e2aworker\u8fdb\u7a0b\u7684\u6700\u5927\u8fde\u63a5\u6570\nevents {\n    worker_connections 4096;\n    use epoll;  # Linux\u4f7f\u7528epoll\n    multi_accept on;  # \u5141\u8bb8\u4e00\u6b21\u63a5\u53d7\u591a\u4e2a\u8fde\u63a5\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u6587\u4ef6\u4f20\u8f93\u4f18\u5316",children:"\u6587\u4ef6\u4f20\u8f93\u4f18\u5316"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"http {\n    # \u9ad8\u6548\u6587\u4ef6\u4f20\u8f93\n    sendfile on;\n    tcp_nopush on;\n    tcp_nodelay on;\n\n    # \u6587\u4ef6\u53e5\u67c4\u7f13\u5b58\n    open_file_cache max=10000 inactive=60s;\n    open_file_cache_valid 30s;\n    open_file_cache_min_uses 2;\n    open_file_cache_errors on;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"gzip\u538b\u7f29\u4f18\u5316",children:"Gzip\u538b\u7f29\u4f18\u5316"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'http {\n    gzip on;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;  # \u538b\u7f29\u7ea7\u522b1-9\uff0c6\u662f\u6027\u80fd\u548c\u538b\u7f29\u6bd4\u7684\u5e73\u8861\u70b9\n    gzip_types text/plain text/css text/xml text/javascript \n               application/json application/javascript \n               application/xml+rss application/rss+xml \n               font/truetype font/opentype \n               application/vnd.ms-fontobject \n               image/svg+xml;\n    gzip_disable "msie6";  # \u7981\u7528IE6\u7684gzip\n    gzip_min_length 1000;  # \u5c0f\u4e8e1KB\u7684\u6587\u4ef6\u4e0d\u538b\u7f29\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u7f13\u5b58\u914d\u7f6e",children:"\u7f13\u5b58\u914d\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# \u4ee3\u7406\u7f13\u5b58\u914d\u7f6e\nproxy_cache_path /var/cache/nginx levels=1:2 keys_zone=my_cache:10m \n                 max_size=1g inactive=60m use_temp_path=off;\n\nserver {\n    location / {\n        proxy_pass http://backend;\n        \n        # \u542f\u7528\u7f13\u5b58\n        proxy_cache my_cache;\n        proxy_cache_valid 200 304 12h;  # \u6210\u529f\u54cd\u5e94\u7f13\u5b5812\u5c0f\u65f6\n        proxy_cache_valid any 1m;        # \u5176\u4ed6\u54cd\u5e94\u7f13\u5b581\u5206\u949f\n        \n        # \u7f13\u5b58\u952e\n        proxy_cache_key "$scheme$request_method$host$request_uri";\n        \n        # \u663e\u793a\u7f13\u5b58\u72b6\u6001\n        add_header X-Cache-Status $upstream_cache_status;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\u6545\u969c\u6392\u67e5",children:"\u6545\u969c\u6392\u67e5"}),"\n",(0,s.jsx)(n.h3,{id:"\u67e5\u770b\u65e5\u5fd7",children:"\u67e5\u770b\u65e5\u5fd7"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# \u5b9e\u65f6\u67e5\u770b\u8bbf\u95ee\u65e5\u5fd7\ntail -f /var/log/nginx/access.log\n\n# \u5b9e\u65f6\u67e5\u770b\u9519\u8bef\u65e5\u5fd7\ntail -f /var/log/nginx/error.log\n\n# \u67e5\u770b\u6700\u8fd1100\u884c\u9519\u8bef\u65e5\u5fd7\ntail -n 100 /var/log/nginx/error.log\n\n# \u641c\u7d22\u7279\u5b9a\u9519\u8bef\ngrep "error" /var/log/nginx/error.log | tail -n 50\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u5e38\u89c1\u9519\u8bef\u6392\u67e5",children:"\u5e38\u89c1\u9519\u8bef\u6392\u67e5"}),"\n",(0,s.jsxs)(n.admonition,{title:"502 Bad Gateway",type:"danger",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u539f\u56e0"}),"\uff1a"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u540e\u7aef\u670d\u52a1\u672a\u542f\u52a8\u6216\u65e0\u6cd5\u8fde\u63a5"}),"\n",(0,s.jsx)(n.li,{children:"\u540e\u7aef\u670d\u52a1\u54cd\u5e94\u8d85\u65f6"}),"\n",(0,s.jsx)(n.li,{children:"SELinux\u963b\u6b62\u8fde\u63a5"}),"\n"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u6392\u67e5\u6b65\u9aa4"}),"\uff1a"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# 1. \u68c0\u67e5\u540e\u7aef\u670d\u52a1\u662f\u5426\u8fd0\u884c\nsystemctl status backend-service\n\n# 2. \u6d4b\u8bd5\u80fd\u5426\u8fde\u63a5\u540e\u7aef\ncurl http://localhost:8080\n\n# 3. \u68c0\u67e5SELinux\u72b6\u6001\uff08CentOS/RHEL\uff09\ngetenforce\n# \u4e34\u65f6\u5173\u95edSELinux\nsudo setenforce 0\n\n# 4. \u5141\u8bb8Nginx\u7f51\u7edc\u8fde\u63a5\nsudo setsebool -P httpd_can_network_connect 1\n"})})]}),"\n",(0,s.jsxs)(n.admonition,{title:"413 Request Entity Too Large",type:"warning",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u539f\u56e0"}),"\uff1a\u4e0a\u4f20\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7\u9650\u5236"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u89e3\u51b3\u65b9\u6848"}),"\uff1a"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"http {\n    client_max_body_size 100M;  # \u8bbe\u7f6e\u6700\u5927\u4e0a\u4f20\u5927\u5c0f\n}\n"})})]}),"\n",(0,s.jsxs)(n.admonition,{title:"504 Gateway Timeout",type:"warning",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u539f\u56e0"}),"\uff1a\u540e\u7aef\u5904\u7406\u8bf7\u6c42\u8d85\u65f6"]}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u89e3\u51b3\u65b9\u6848"}),"\uff1a"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"location / {\n    proxy_pass http://backend;\n    proxy_connect_timeout 300s;\n    proxy_send_timeout 300s;\n    proxy_read_timeout 300s;\n}\n"})})]}),"\n",(0,s.jsx)(n.h3,{id:"\u6d4b\u8bd5\u914d\u7f6e\u6587\u4ef6",children:"\u6d4b\u8bd5\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u6d4b\u8bd5\u914d\u7f6e\u6587\u4ef6\u8bed\u6cd5\nnginx -t\n\n# \u67e5\u770b\u8be6\u7ec6\u9519\u8bef\u4fe1\u606f\nnginx -t -v\n\n# \u6d4b\u8bd5\u914d\u7f6e\u5e76\u67e5\u770b\u6240\u6709\u914d\u7f6e\u9879\nnginx -T\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5b89\u5168\u52a0\u56fa",children:"\u5b89\u5168\u52a0\u56fa"}),"\n",(0,s.jsx)(n.h3,{id:"\u9690\u85cf\u7248\u672c\u53f7",children:"\u9690\u85cf\u7248\u672c\u53f7"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"http {\n    server_tokens off;  # \u9690\u85cfNginx\u7248\u672c\u53f7\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u9650\u5236\u8bf7\u6c42\u901f\u7387",children:"\u9650\u5236\u8bf7\u6c42\u901f\u7387"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"http {\n    # \u5b9a\u4e49\u9650\u6d41\u533a\u57df\uff1a\u6bcf\u4e2aIP\u6bcf\u79d2\u6700\u591a10\u4e2a\u8bf7\u6c42\n    limit_req_zone $binary_remote_addr zone=api_limit:10m rate=10r/s;\n\n    server {\n        location /api/ {\n            # \u5e94\u7528\u9650\u6d41\uff1a\u5141\u8bb8\u7a81\u53d120\u4e2a\u8bf7\u6c42\uff0c\u5ef6\u8fdf\u5904\u7406\u8d85\u51fa\u7684\u8bf7\u6c42\n            limit_req zone=api_limit burst=20 nodelay;\n            \n            proxy_pass http://backend;\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u9650\u5236\u8fde\u63a5\u6570",children:"\u9650\u5236\u8fde\u63a5\u6570"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"http {\n    # \u5b9a\u4e49\u9650\u5236\u533a\u57df\uff1a\u6bcf\u4e2aIP\u6700\u591a10\u4e2a\u5e76\u53d1\u8fde\u63a5\n    limit_conn_zone $binary_remote_addr zone=addr:10m;\n\n    server {\n        # \u5e94\u7528\u8fde\u63a5\u9650\u5236\n        limit_conn addr 10;\n        \n        location /download/ {\n            limit_conn addr 1;       # \u4e0b\u8f7d\u76ee\u5f55\u6bcf\u4e2aIP\u53ea\u5141\u8bb81\u4e2a\u8fde\u63a5\n            limit_rate 500k;         # \u9650\u901f500KB/s\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u9632\u6b62\u6076\u610f\u8bbf\u95ee",children:"\u9632\u6b62\u6076\u610f\u8bbf\u95ee"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"server {\n    # \u7981\u6b62\u7279\u5b9aUser-Agent\n    if ($http_user_agent ~* (bot|spider|crawler|scanner)) {\n        return 403;\n    }\n\n    # \u7981\u6b62\u7279\u5b9a\u8bf7\u6c42\u65b9\u6cd5\n    if ($request_method !~ ^(GET|POST|HEAD)$) {\n        return 405;\n    }\n\n    # \u9632\u6b62\u76ee\u5f55\u904d\u5386\u653b\u51fb\n    location ~ /\\. {\n        deny all;\n        access_log off;\n        log_not_found off;\n    }\n\n    # \u7981\u6b62\u8bbf\u95ee\u654f\u611f\u6587\u4ef6\n    location ~* \\.(sql|bak|swp|old|tmp)$ {\n        deny all;\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u6700\u4f73\u5b9e\u8df5\u603b\u7ed3",children:"\u6700\u4f73\u5b9e\u8df5\u603b\u7ed3"}),"\n",(0,s.jsx)(n.admonition,{title:"\u914d\u7f6e\u6587\u4ef6\u7ec4\u7ec7",type:"tip",children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u6a21\u5757\u5316\u914d\u7f6e"}),"\uff1a\u5c06\u4e0d\u540c\u529f\u80fd\u62c6\u5206\u5230\u72ec\u7acb\u6587\u4ef6"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/etc/nginx/\n\u251c\u2500\u2500 nginx.conf           # \u4e3b\u914d\u7f6e\n\u251c\u2500\u2500 conf.d/             # \u901a\u7528\u914d\u7f6e\n\u2502   \u251c\u2500\u2500 gzip.conf\n\u2502   \u2514\u2500\u2500 security.conf\n\u2514\u2500\u2500 sites-enabled/      # \u7ad9\u70b9\u914d\u7f6e\n    \u251c\u2500\u2500 example.com.conf\n    \u2514\u2500\u2500 api.example.com.conf\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u4f7f\u7528include\u6307\u4ee4"}),"\uff1a\u63d0\u9ad8\u53ef\u7ef4\u62a4\u6027"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"http {\n    include /etc/nginx/conf.d/*.conf;\n    include /etc/nginx/sites-enabled/*.conf;\n}\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u6ce8\u91ca\u91cd\u8981\u914d\u7f6e"}),"\uff1a\u4fbf\u4e8e\u56e2\u961f\u534f\u4f5c"]}),"\n"]}),"\n"]})}),"\n",(0,s.jsx)(n.admonition,{title:"\u6027\u80fd\u4f18\u5316\u6e05\u5355",type:"tip",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 \u8bbe\u7f6e\u5408\u7406\u7684 ",(0,s.jsx)(n.code,{children:"worker_processes"})," \u548c ",(0,s.jsx)(n.code,{children:"worker_connections"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 \u542f\u7528 ",(0,s.jsx)(n.code,{children:"sendfile"}),"\u3001",(0,s.jsx)(n.code,{children:"tcp_nopush"}),"\u3001",(0,s.jsx)(n.code,{children:"tcp_nodelay"})]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u914d\u7f6e Gzip \u538b\u7f29"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u542f\u7528\u9759\u6001\u8d44\u6e90\u6d4f\u89c8\u5668\u7f13\u5b58"}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 \u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"upstream"})," \u7684 ",(0,s.jsx)(n.code,{children:"keepalive"})," \u957f\u8fde\u63a5"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u914d\u7f6e\u5408\u7406\u7684\u8d85\u65f6\u65f6\u95f4"}),"\n"]})}),"\n",(0,s.jsx)(n.admonition,{title:"\u5b89\u5168\u52a0\u56fa\u6e05\u5355",type:"tip",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 \u9690\u85cfNginx\u7248\u672c\u53f7 (",(0,s.jsx)(n.code,{children:"server_tokens off"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u4f7f\u7528HTTPS\u5e76\u914d\u7f6eHSTS"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u914d\u7f6e\u8bf7\u6c42\u901f\u7387\u9650\u5236\u548c\u8fde\u63a5\u6570\u9650\u5236"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u8bbe\u7f6e\u5b89\u5168\u54cd\u5e94\u5934\uff08X-Frame-Options\u3001X-XSS-Protection\u7b49\uff09"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u7981\u6b62\u8bbf\u95ee\u9690\u85cf\u6587\u4ef6\u548c\u654f\u611f\u6587\u4ef6"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u5b9a\u671f\u66f4\u65b0Nginx\u7248\u672c"}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"\u53c2\u8003\u8d44\u6e90",children:"\u53c2\u8003\u8d44\u6e90"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://nginx.org/en/docs/",children:"Nginx\u5b98\u65b9\u6587\u6863"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://nginx.org/en/docs/beginners_guide.html",children:"Nginx\u65b0\u624b\u6307\u5357"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://nginx.org/en/docs/dirindex.html",children:"Nginx\u914d\u7f6e\u6307\u4ee4\u7d22\u5f15"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://nginx.org/en/docs/varindex.html",children:"Nginx\u53d8\u91cf\u7d22\u5f15"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://nginx.org/en/docs/http/load_balancing.html",children:"\u4f7f\u7528Nginx\u4f5c\u4e3aHTTP\u8d1f\u8f7d\u5747\u8861\u5668"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://nginx.org/en/docs/http/configuring_https_servers.html",children:"\u914d\u7f6eHTTPS\u670d\u52a1\u5668"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},19365:(e,n,t)=>{t.d(n,{A:()=>r});t(96540);var l=t(18215);const s={tabItem:"tabItem_Ymn6"};var i=t(74848);function r({children:e,hidden:n,className:t}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,l.A)(s.tabItem,t),hidden:n,children:e})}},11470:(e,n,t)=>{t.d(n,{A:()=>A});var l=t(96540),s=t(18215),i=t(17559),r=t(23104),d=t(56347),c=t(205),o=t(57485),a=t(31682),x=t(70679);function h(e){return l.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,l.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,l.useMemo)((()=>{const e=n??function(e){return h(e).map((({props:{value:e,label:n,attributes:t,default:l}})=>({value:e,label:n,attributes:t,default:l})))}(t);return function(e){const n=(0,a.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function j({value:e,tabValues:n}){return n.some((n=>n.value===e))}function g({queryString:e=!1,groupId:n}){const t=(0,d.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,o.aZ)(s),(0,l.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})}),[s,t])]}function u(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,i=p(e),[r,d]=(0,l.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!j({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:i}))),[o,a]=g({queryString:t,groupId:s}),[h,u]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,x.Dv)(n);return[t,(0,l.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:s}),m=(()=>{const e=o??h;return j({value:e,tabValues:i})?e:null})();(0,c.A)((()=>{m&&d(m)}),[m]);return{selectedValue:r,selectValue:(0,l.useCallback)((e=>{if(!j({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);d(e),a(e),u(e)}),[a,u,i]),tabValues:i}}var m=t(92303);const _={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=t(74848);function y({className:e,block:n,selectedValue:t,selectValue:l,tabValues:i}){const d=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),o=e=>{const n=e.currentTarget,s=d.indexOf(n),r=i[s].value;r!==t&&(c(n),l(r))},a=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const t=d.indexOf(e.currentTarget)+1;n=d[t]??d[0];break}case"ArrowLeft":{const t=d.indexOf(e.currentTarget)-1;n=d[t]??d[d.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:i.map((({value:e,label:n,attributes:l})=>(0,f.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{d.push(e)},onKeyDown:a,onClick:o,...l,className:(0,s.A)("tabs__item",_.tabItem,l?.className,{"tabs__item--active":t===e}),children:n??e},e)))})}function v({lazy:e,children:n,selectedValue:t}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find((e=>e.props.value===t));return e?(0,l.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,l.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function b(e){const n=u(e);return(0,f.jsxs)("div",{className:(0,s.A)(i.G.tabs.container,"tabs-container",_.tabList),children:[(0,f.jsx)(y,{...n,...e}),(0,f.jsx)(v,{...n,...e})]})}function A(e){const n=(0,m.A)();return(0,f.jsx)(b,{...e,children:h(e.children)},String(n))}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>d});var l=t(96540);const s={},i=l.createContext(s);function r(e){const n=l.useContext(i);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),l.createElement(i.Provider,{value:n},e.children)}}}]);