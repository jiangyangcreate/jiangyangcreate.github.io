"use strict";(self.webpackChunkjiangmiemie=self.webpackChunkjiangmiemie||[]).push([[5550],{5382:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>a,frontMatter:()=>l,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python\u6807\u51c6\u5e93/1\u6587\u672c\u5904\u7406\u670d\u52a1/difflib","title":"difflib","description":"difflib \u662f Python \u6807\u51c6\u5e93\u4e2d\u7528\u4e8e\u6bd4\u8f83\u5e8f\u5217\u5dee\u5f02\u7684\u6a21\u5757\uff0c\u6838\u5fc3\u7b97\u6cd5\u57fa\u4e8e 1986 \u5e74\u7684 Ratcliff/Obershelp \u7b97\u6cd5\uff08\u53c8\u79f0 gestalt pattern matching\uff09\uff0c\u81f3\u4eca\u4ecd\u662f\u5de5\u4e1a\u754c\u6700\u5e38\u7528\u7684\u6587\u672c\u76f8\u4f3c\u5ea6\u4e0e diff \u751f\u6210\u5de5\u5177\u3002","source":"@site/docs/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python\u6807\u51c6\u5e93/1\u6587\u672c\u5904\u7406\u670d\u52a1/difflib.mdx","sourceDirName":"\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python\u6807\u51c6\u5e93/1\u6587\u672c\u5904\u7406\u670d\u52a1","slug":"/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python\u6807\u51c6\u5e93/1\u6587\u672c\u5904\u7406\u670d\u52a1/difflib","permalink":"/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python\u6807\u51c6\u5e93/1\u6587\u672c\u5904\u7406\u670d\u52a1/difflib","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"difflib"},"sidebar":"tutorialSidebar","previous":{"title":"re","permalink":"/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python\u6807\u51c6\u5e93/1\u6587\u672c\u5904\u7406\u670d\u52a1/re"},"next":{"title":"readline","permalink":"/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python\u6807\u51c6\u5e93/1\u6587\u672c\u5904\u7406\u670d\u52a1/readline"}}');var r=i(74848),s=i(28453);const l={sidebar_position:2,title:"difflib"},c=void 0,d={},o=[{value:"SequenceMatcher",id:"sequencematcher",level:2},{value:"ratio()\u3001quick_ratio()\u3001real_quick_ratio()",id:"ratioquick_ratioreal_quick_ratio",level:3},{value:"get_matching_blocks()",id:"get_matching_blocks",level:3},{value:"get_close_matches",id:"get_close_matches",level:2},{value:"Differ",id:"differ",level:2},{value:"unified_diff",id:"unified_diff",level:2},{value:"HtmlDiff",id:"htmldiff",level:2}];function h(e){const n={admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"difflib"})," \u662f Python \u6807\u51c6\u5e93\u4e2d\u7528\u4e8e\u6bd4\u8f83\u5e8f\u5217\u5dee\u5f02\u7684\u6a21\u5757\uff0c\u6838\u5fc3\u7b97\u6cd5\u57fa\u4e8e 1986 \u5e74\u7684 Ratcliff/Obershelp \u7b97\u6cd5\uff08\u53c8\u79f0 gestalt pattern matching\uff09\uff0c\u81f3\u4eca\u4ecd\u662f\u5de5\u4e1a\u754c\u6700\u5e38\u7528\u7684\u6587\u672c\u76f8\u4f3c\u5ea6\u4e0e diff \u751f\u6210\u5de5\u5177\u3002"]}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["\u4e0d\u8981\u4e0e ",(0,r.jsx)(n.code,{children:"filecmp"})," \u6df7\u6dc6\u3002",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"filecmp.cmp(..., shallow=False)"})," \u4ec5\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b8c\u5168\u76f8\u540c\uff0c\u4e14\u6027\u80fd\u8fdc\u4e0d\u5982\u76f4\u63a5\u8ba1\u7b97 blake3/xxh3 hash\u3002",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"filecmp"})," \u552f\u4e00\u4ecd\u6709\u4ef7\u503c\u7684\u573a\u666f\u662f ",(0,r.jsx)(n.code,{children:"dircmp"})," \u7684\u76ee\u5f55\u62a5\u544a\u548c ",(0,r.jsx)(n.code,{children:"shall=True"})," \u5feb\u901f\u8fc7\u6ee4\u3002"]})}),"\n",(0,r.jsx)(n.h2,{id:"sequencematcher",children:"SequenceMatcher"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"SequenceMatcher"})," \u662f ",(0,r.jsx)(n.code,{children:"difflib"})," \u7684\u5e95\u5c42\u5b9e\u73b0\uff0c\u53ef\u6bd4\u8f83\u4efb\u610f\u5e8f\u5217\uff08\u6700\u5e38\u7528\u7684\u662f\u5b57\u7b26\u4e32\uff09\uff0c\u652f\u6301\u8ba1\u7b97\u76f8\u4f3c\u5ea6\u3001\u63d0\u53d6\u5339\u914d\u5757\u7b49\u64cd\u4f5c\u3002"]}),"\n",(0,r.jsx)(n.h3,{id:"ratioquick_ratioreal_quick_ratio",children:"ratio()\u3001quick_ratio()\u3001real_quick_ratio()"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:'from difflib import SequenceMatcher\n\ndef similarity(a: str, b: str) -> float:\n    return SequenceMatcher(None, a.lower(), b.lower()).ratio()\n\n# \u793a\u4f8b\nprint(similarity("Python is good", "python is good!"))     # 0.9032258064516129\nprint(similarity("\u4eca\u5929\u5929\u6c14\u5f88\u597d", "\u4eca\u5929\u5929\u6c14\u975e\u5e38\u597d"))         # 0.8571428571428571\n'})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u65b9\u6cd5"}),(0,r.jsx)(n.th,{children:"\u7cbe\u5ea6"}),(0,r.jsx)(n.th,{children:"\u901f\u5ea6"}),(0,r.jsx)(n.th,{children:"\u63a8\u8350\u573a\u666f"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ratio()"})}),(0,r.jsx)(n.td,{children:"\u9ad8"}),(0,r.jsx)(n.td,{children:"\u4e2d\u7b49"}),(0,r.jsx)(n.td,{children:"\u6700\u7ec8\u76f8\u4f3c\u5ea6\u5224\u5b9a\uff08\u6700\u5e38\u7528\uff09"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"quick_ratio()"})}),(0,r.jsx)(n.td,{children:"\u4e2d"}),(0,r.jsx)(n.td,{children:"\u5feb"}),(0,r.jsx)(n.td,{children:"\u6d77\u91cf\u6570\u636e\u521d\u7b5b"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"real_quick_ratio()"})}),(0,r.jsx)(n.td,{children:"\u4f4e"}),(0,r.jsx)(n.td,{children:"\u6781\u5feb"}),(0,r.jsx)(n.td,{children:"\u4ebf\u7ea7\u6587\u672c\u7c97\u7b5b"})]})]})]}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ratio()"})," \u662f ",(0,r.jsx)(n.code,{children:"SequenceMatcher"})," \u7684\u6838\u5fc3\u65b9\u6cd5\uff0c\u7528\u4e8e\u8ba1\u7b97\u4e24\u4e2a\u5e8f\u5217\u7684\u76f8\u4f3c\u5ea6\u3002\u5b83\u8fd4\u56de\u4e00\u4e2a\u4ecb\u4e8e 0.0 \u548c 1.0 \u4e4b\u95f4\u7684\u6d6e\u70b9\u6570\uff0c\u8868\u793a\u4e24\u4e2a\u5e8f\u5217\u7684\u76f8\u4f3c\u7a0b\u5ea6\u3002"]}),(0,r.jsx)(n.p,{children:"\u63a8\u8350\u7528\u4e8e\u7b54\u6848\u5b8c\u5168\u4e00\u81f4\u6027\u5224\u65ad\uff0c\u4f8b\u5982\u5927\u6a21\u578b\u751f\u6210\u4ee3\u7801\u4e0e\u6807\u51c6\u7b54\u6848\u7684\u5b8c\u5168\u4e00\u81f4\u6027\u5224\u65ad\u3002"})]}),"\n",(0,r.jsx)(n.h3,{id:"get_matching_blocks",children:"get_matching_blocks()"}),"\n",(0,r.jsxs)(n.p,{children:["\u8fd4\u56de\u4e00\u4e2a ",(0,r.jsx)(n.code,{children:"Match(a, b, size)"})," \u4e09\u5143\u7ec4\u5217\u8868\uff0c\u8868\u793a\u5728\u5e8f\u5217 a \u7684\u4f4d\u7f6e a \u5f00\u59cb\u3001\u5728 b \u7684\u4f4d\u7f6e b \u5f00\u59cb\u7684\u8fde\u7eed\u5339\u914d\u957f\u5ea6\u4e3a size\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:"from difflib import SequenceMatcher\n\ns1 = \"ABCDEFFF123GGGHIJK\"\ns2 = \"ABCDXXXFFF456GGGHIJKMNOP\"\n\nmatcher = SequenceMatcher(None, s1, s2)\nblocks = matcher.get_matching_blocks()\n\nfor block in blocks:\n    if block.size > 0:\n        print(f\"\u5339\u914d: '{s1[block.a:block.a+block.size]}' (\u957f\u5ea6 {block.size})\")\n# \u5339\u914d: 'ABCDE' (\u957f\u5ea6 5)\n# \u5339\u914d: 'FFF123GGG' (\u957f\u5ea6 9)   \u2190 \u6ce8\u610f\uff1a\u8fd9\u91cc\u662f 9\uff0c\u4e0d\u662f 10\uff08\u56e0\u4e2d\u95f4\u6570\u5b57\u4e0d\u540c\uff09\n# \u5339\u914d: 'HIJK' (\u957f\u5ea6 4)\n"})}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsx)(n.p,{children:"\u4e00\u884c\u4ee3\u7801\u63d0\u53d6\u6700\u957f\u516c\u5171\u5b50\u4e32\uff08\u5168\u5c40\u6700\u4f18\uff09"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:'def longest_common_substring(s1: str, s2: str) -> str:\n    matcher = SequenceMatcher(None, s1, s2)\n    match = max(matcher.get_matching_blocks(), key=lambda m: m.size)\n    return s1[match.a:match.a + match.size]\n\nprint(longest_common_substring(\n    "ABCDEFFF123GGGHIJK",\n    "ABCDXXXFFF456GGGHIJKMNOP"\n))\n# \u8f93\u51fa\uff1aFFF123GGG \uff08\u957f\u5ea6 9\uff0c\u5f53\u524d\u5168\u5c40\u6700\u957f\u8fde\u7eed\u516c\u5171\u5b50\u4e32\uff09\n'})})]}),"\n",(0,r.jsx)(n.h2,{id:"get_close_matches",children:"get_close_matches"}),"\n",(0,r.jsx)(n.p,{children:"\u4ece\u5019\u9009\u5217\u8868\u4e2d\u8fd4\u56de\u4e0e\u76ee\u6807\u6700\u76f8\u4f3c\u7684 n \u4e2a\u9009\u9879\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:'from difflib import get_close_matches\n\nprint(get_close_matches("appel", ["apple", "apply", "ape", "banana"], n=3, cutoff=0.6))\n# [\'apple\', \'apply\', \'ape\']\n\nprint(get_close_matches("grok", ["groq", "gork", "glok"], n=1, cutoff=0.8))\n# [\'grok\'] \u6216 []\uff08\u5982\u679c\u90fd\u4e0d\u8fbe\u6807\uff09\n'})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u53c2\u6570"}),(0,r.jsx)(n.th,{children:"\u8bf4\u660e"}),(0,r.jsx)(n.th,{children:"\u63a8\u8350\u503c"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"n"})}),(0,r.jsx)(n.td,{children:"\u8fd4\u56de\u6700\u591a\u6570\u91cf"}),(0,r.jsx)(n.td,{children:"1~5"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"cutoff"})}),(0,r.jsx)(n.td,{children:"\u76f8\u4f3c\u5ea6\u9608\u503c\uff080~1\uff09"}),(0,r.jsx)(n.td,{children:"0.6~0.8\uff08\u5e38\u7528\uff09"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"\u5178\u578b\u5e94\u7528\uff1a\u547d\u4ee4\u884c\u53c2\u6570\u7ea0\u9519\u3001\u914d\u7f6e\u9879\u62fc\u5199\u63d0\u793a\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"differ",children:"Differ"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:'from difflib import Differ\n\nold = ["\u7b2c\u4e00\u884c", "\u7b2c\u4e8c\u884c", "\u7b2c\u4e09\u884c"]\nnew = ["\u7b2c\u4e00\u884c", "\u7b2c\u4e8c\u884c\u5df2\u4fee\u6539", "\u7b2c\u4e09\u884c"]\n\nd = Differ()\ndiff = list(d.compare(old, new))\n\nprint("\\n".join(diff))\n#   \u7b2c\u4e00\u884c\n# - \u7b2c\u4e8c\u884c\n# + \u7b2c\u4e8c\u884c\u5df2\u4fee\u6539\n# ?       ++++++\n#   \u7b2c\u4e09\u884c\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u524d\u7f00\u542b\u4e49\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"'  '"}),"\uff1a\u4e24\u8fb9\u76f8\u540c"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"'- '"}),"\uff1a\u4ec5\u5728\u65e7\u6587\u672c"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"'+ '"}),"\uff1a\u4ec5\u5728\u65b0\u6587\u672c"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"'?'"}),"\uff1a\u6307\u793a\u5b57\u7b26\u7ea7\u5dee\u5f02\u4f4d\u7f6e"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"unified_diff",children:"unified_diff"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:'from difflib import unified_diff\n\nold = ["line1\\n", "line2\\n", "line3\\n"]\nnew = ["line1\\n", "line2 modified\\n", "line3\\n"]\n\ndiff = unified_diff(\n    old, new,\n    fromfile="old.txt",\n    tofile="new.txt",\n    lineterm=""\n)\n\nprint("\\n".join(diff))\n# --- old.txt\n# +++ new.txt\n# @@ -1,3 +1,3 @@\n#  line1\n# -line2\n# +line2 modified\n#  line3\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u63a8\u8350\u7528\u4e8e\uff1a\u751f\u6210 patch\u3001\u4ee3\u7801\u5ba1\u67e5\u3001\u914d\u7f6e\u53d8\u66f4\u8bb0\u5f55\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"htmldiff",children:"HtmlDiff"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:'from difflib import HtmlDiff\n\nold = ["\u7b2c\u4e00\u884c", "\u7b2c\u4e8c\u884c", "\u7b2c\u4e09\u884c"]\nnew = ["\u7b2c\u4e00\u884c", "\u7b2c\u4e8c\u884c\u5df2\u4fee\u6539", "\u7b2c\u4e09\u884c"]\n\nhtml = HtmlDiff().make_file(\n    old, new,\n    fromdesc="\u65e7\u7248\u672c",\n    todesc="\u65b0\u7248\u672c",\n    context=True,    # \u53ea\u663e\u793a\u5dee\u5f02\u9644\u8fd1\u884c\n    numlines=3\n)\n\nwith open("diff.html", "w", encoding="utf-8") as f:\n    f.write(html)\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u751f\u6210\u7684 HTML \u6587\u4ef6\u652f\u6301\u884c\u5185\u5b57\u7b26\u9ad8\u4eae\uff0c\u9002\u5408\u5185\u7f51\u914d\u7f6e\u5bf9\u6bd4\u3001\u65e5\u5fd7\u5ba1\u67e5\u9875\u9762\u3002"})]})}function a(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var t=i(96540);const r={},s=t.createContext(r);function l(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);