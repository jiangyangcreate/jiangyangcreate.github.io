"use strict";(self.webpackChunkjiangmiemie=self.webpackChunkjiangmiemie||[]).push([[1142],{79933:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"Python\u6807\u51c6\u5e93/13\u7f51\u7edc\u548c\u8fdb\u7a0b\u95f4\u901a\u4fe1/socket","title":"socket","description":"socket \u4f4e\u5c42\u7ea7\u7684\u7f51\u7edc\u63a5\u53e3\u5e93\uff0c\u63d0\u4f9b BSD \u5957\u63a5\u5b57\u7684 Python \u63a5\u53e3","source":"@site/docs/docs/Python\u6807\u51c6\u5e93/13\u7f51\u7edc\u548c\u8fdb\u7a0b\u95f4\u901a\u4fe1/socket.mdx","sourceDirName":"Python\u6807\u51c6\u5e93/13\u7f51\u7edc\u548c\u8fdb\u7a0b\u95f4\u901a\u4fe1","slug":"/Python\u6807\u51c6\u5e93/13\u7f51\u7edc\u548c\u8fdb\u7a0b\u95f4\u901a\u4fe1/socket","permalink":"/docs/Python\u6807\u51c6\u5e93/13\u7f51\u7edc\u548c\u8fdb\u7a0b\u95f4\u901a\u4fe1/socket","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"socket","description":"socket \u4f4e\u5c42\u7ea7\u7684\u7f51\u7edc\u63a5\u53e3\u5e93\uff0c\u63d0\u4f9b BSD \u5957\u63a5\u5b57\u7684 Python \u63a5\u53e3"},"sidebar":"tutorialSidebar","previous":{"title":"\u7f51\u7edc\u4e0e\u901a\u4fe1","permalink":"/docs/Python\u6807\u51c6\u5e93/13\u7f51\u7edc\u548c\u8fdb\u7a0b\u95f4\u901a\u4fe1/"},"next":{"title":"asyncio","permalink":"/docs/Python\u6807\u51c6\u5e93/13\u7f51\u7edc\u548c\u8fdb\u7a0b\u95f4\u901a\u4fe1/asyncio"}}');var c=s(74848),r=s(28453),o=s(11470),d=s(19365);const i={sidebar_position:1,title:"socket",description:"socket \u4f4e\u5c42\u7ea7\u7684\u7f51\u7edc\u63a5\u53e3\u5e93\uff0c\u63d0\u4f9b BSD \u5957\u63a5\u5b57\u7684 Python \u63a5\u53e3"},l=void 0,a={},h=[{value:"\u5957\u63a5\u5b57\u534f\u8bae\u65cf",id:"\u5957\u63a5\u5b57\u534f\u8bae\u65cf",level:2},{value:"\u5730\u5740\u683c\u5f0f\u793a\u4f8b",id:"\u5730\u5740\u683c\u5f0f\u793a\u4f8b",level:3},{value:"\u5957\u63a5\u5b57\u7c7b\u578b",id:"\u5957\u63a5\u5b57\u7c7b\u578b",level:2},{value:"\u5de5\u4f5c\u6d41\u7a0b",id:"\u5de5\u4f5c\u6d41\u7a0b",level:3},{value:"\u521b\u5efa\u5957\u63a5\u5b57",id:"\u521b\u5efa\u5957\u63a5\u5b57",level:2},{value:"socket.socket()",id:"socketsocket",level:3},{value:"\u5957\u63a5\u5b57\u9009\u9879",id:"\u5957\u63a5\u5b57\u9009\u9879",level:2},{value:"setsockopt()",id:"setsockopt",level:3},{value:"getsockopt()",id:"getsockopt",level:3},{value:"setblocking()",id:"setblocking",level:3},{value:"\u8d85\u65f6\u5904\u7406",id:"\u8d85\u65f6\u5904\u7406",level:2},{value:"settimeout()",id:"settimeout",level:3},{value:"gettimeout()",id:"gettimeout",level:3},{value:"\u5730\u5740\u89e3\u6790\u51fd\u6570",id:"\u5730\u5740\u89e3\u6790\u51fd\u6570",level:2},{value:"gethostbyaddr()",id:"gethostbyaddr",level:3},{value:"getservbyname()",id:"getservbyname",level:3},{value:"\u670d\u52a1\u5668\u7aef\u64cd\u4f5c",id:"\u670d\u52a1\u5668\u7aef\u64cd\u4f5c",level:2},{value:"bind()",id:"bind",level:3},{value:"listen()\u3001accept()",id:"listenaccept",level:3},{value:"\u5ba2\u6237\u7aef\u64cd\u4f5c",id:"\u5ba2\u6237\u7aef\u64cd\u4f5c",level:2},{value:"connect()\u3001connect_ex()",id:"connectconnect_ex",level:3},{value:"\u6570\u636e\u4f20\u8f93",id:"\u6570\u636e\u4f20\u8f93",level:2},{value:"send()\u3001sendall()\u3001sendto()",id:"sendsendallsendto",level:3},{value:"recv()\u3001recvfrom()",id:"recvrecvfrom",level:3},{value:"\u5173\u95ed\u5957\u63a5\u5b57",id:"\u5173\u95ed\u5957\u63a5\u5b57",level:2},{value:"close()",id:"close",level:3},{value:"shutdown()",id:"shutdown",level:3},{value:"getsockname()",id:"getsockname",level:3},{value:"getpeername()",id:"getpeername",level:3},{value:"\u793a\u4f8b\uff1a\u591a\u7ebf\u7a0bTCP\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef",id:"\u793a\u4f8b\u591a\u7ebf\u7a0btcp\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef",level:2}];function x(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components},{HoverText:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("HoverText",!0),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"socket"})," \u6a21\u5757\u63d0\u4f9b\u4e86\u8bbf\u95ee ",(0,c.jsx)(s,{text:"BSD \u5957\u63a5\u5b57",explanation:"Berkeley Software Distribution (\u4f2f\u514b\u5229\u8f6f\u4ef6\u5957\u4ef6)\u7f51\u7edc\u7f16\u7a0b\u63a5\u53e3\uff0c\u662f Unix/Linux \u7cfb\u7edf\u4e2d\u7f51\u7edc\u901a\u4fe1\u7684\u6807\u51c6 API\u3002\u5b83\u63d0\u4f9b\u4e86\u4e00\u5957\u7528\u4e8e\u7f51\u7edc\u901a\u4fe1\u7684\u7cfb\u7edf\u8c03\u7528\u63a5\u53e3\uff0c\u652f\u6301 TCP\u3001UDP \u7b49\u591a\u79cd\u7f51\u7edc\u534f\u8bae\u3002"})," \u7684\u63a5\u53e3\uff0c\u662f\u6240\u6709\u73b0\u4ee3 Unix \u7cfb\u7edf\u3001Windows\u3001macOS \u548c\u5176\u4ed6\u4e00\u4e9b\u5e73\u53f0\u4e0a\u8fdb\u884c\u7f51\u7edc\u7f16\u7a0b\u7684\u57fa\u7840\u3002"]}),"\n",(0,c.jsx)(n.h2,{id:"\u5957\u63a5\u5b57\u534f\u8bae\u65cf",children:"\u5957\u63a5\u5b57\u534f\u8bae\u65cf"}),"\n",(0,c.jsx)(n.p,{children:"\u6839\u636e\u7cfb\u7edf\u4ee5\u53ca\u6784\u5efa\u9009\u9879\uff0c\u6b64\u6a21\u5757\u63d0\u4f9b\u4e86\u5404\u79cd\u5957\u63a5\u5b57\u534f\u8bae\u7c07\u3002\u5e38\u7528\u7684\u534f\u8bae\u65cf\u5305\u62ec\uff1a"}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u534f\u8bae\u65cf"}),(0,c.jsx)(n.th,{children:"\u5e38\u91cf"}),(0,c.jsx)(n.th,{children:"\u5730\u5740\u683c\u5f0f"}),(0,c.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"IPv4"}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"AF_INET"})}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"(host, port)"})," \u5143\u7ec4",(0,c.jsx)("br",{}),(0,c.jsx)(n.code,{children:"host"}),": \u4e3b\u673a\u540d\u6216 IPv4 \u5730\u5740\u5b57\u7b26\u4e32",(0,c.jsx)("br",{}),(0,c.jsx)(n.code,{children:"port"}),": \u6574\u6570\u7aef\u53e3\u53f7",(0,c.jsx)("br",{}),"\u7279\u6b8a\u503c: ",(0,c.jsx)(n.code,{children:"''"})," \u8868\u793a\u6240\u6709\u63a5\u53e3\uff0c",(0,c.jsx)(n.code,{children:"'<broadcast>'"})," \u8868\u793a\u5e7f\u64ad\u5730\u5740"]}),(0,c.jsx)(n.td,{children:"\u7528\u4e8e IPv4 \u7f51\u7edc\u901a\u4fe1"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"IPv6"}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"AF_INET6"})}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"(host, port, flowinfo, scope_id)"})," \u56db\u5143\u7ec4",(0,c.jsx)("br",{}),(0,c.jsx)(n.code,{children:"host"}),": IPv6 \u5730\u5740\u5b57\u7b26\u4e32",(0,c.jsx)("br",{}),(0,c.jsx)(n.code,{children:"port"}),": \u6574\u6570\u7aef\u53e3\u53f7",(0,c.jsx)("br",{}),(0,c.jsx)(n.code,{children:"flowinfo"}),": \u6d41\u4fe1\u606f\uff08\u901a\u5e38\u4e3a 0\uff09",(0,c.jsx)("br",{}),(0,c.jsx)(n.code,{children:"scope_id"}),": \u4f5c\u7528\u57df ID\uff08\u901a\u5e38\u4e3a 0\uff09",(0,c.jsx)("br",{}),"\u7b80\u5316\u5f62\u5f0f: ",(0,c.jsx)(n.code,{children:"(host, port)"})]}),(0,c.jsx)(n.td,{children:"\u7528\u4e8e IPv6 \u7f51\u7edc\u901a\u4fe1"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"Unix\u57df"}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"AF_UNIX"})}),(0,c.jsxs)(n.td,{children:["\u6587\u4ef6\u7cfb\u7edf\u8def\u5f84\u5b57\u7b26\u4e32",(0,c.jsx)("br",{}),"\u4f8b\u5982: ",(0,c.jsx)(n.code,{children:"'/tmp/mysocket.sock'"})]}),(0,c.jsx)(n.td,{children:"\u7528\u4e8e\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"\u539f\u59cb\u5957\u63a5\u5b57"}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"AF_PACKET"})}),(0,c.jsxs)(n.td,{children:["\u63a5\u53e3\u540d\u79f0\u5b57\u7b26\u4e32",(0,c.jsx)("br",{}),"\u4f8b\u5982: ",(0,c.jsx)(n.code,{children:"'eth0'"})]}),(0,c.jsx)(n.td,{children:"\u7528\u4e8e\u5e95\u5c42\u7f51\u7edc\u5305\u8bbf\u95ee\uff08Linux\uff09"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"\u84dd\u7259"}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"AF_BLUETOOTH"})}),(0,c.jsx)(n.td,{children:"\u84dd\u7259\u5730\u5740\u5143\u7ec4\uff0c\u683c\u5f0f\u53d6\u51b3\u4e8e\u534f\u8bae"}),(0,c.jsx)(n.td,{children:"\u7528\u4e8e\u84dd\u7259\u901a\u4fe1"})]})]})]}),"\n",(0,c.jsx)(n.h3,{id:"\u5730\u5740\u683c\u5f0f\u793a\u4f8b",children:"\u5730\u5740\u683c\u5f0f\u793a\u4f8b"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\n# AF_INET \u5730\u5740\u793a\u4f8b\naddress_v4_1 = ('www.example.com', 80)           # \u4f7f\u7528\u4e3b\u673a\u540d\naddress_v4_2 = ('192.168.1.1', 8080)             # \u4f7f\u7528 IPv4 \u5730\u5740\naddress_v4_3 = ('', 8080)                        # \u7ed1\u5b9a\u5230\u6240\u6709\u63a5\u53e3 (INADDR_ANY)\naddress_v4_4 = ('<broadcast>', 8080)             # \u5e7f\u64ad\u5730\u5740 (INADDR_BROADCAST)\n\n# AF_INET6 \u5730\u5740\u793a\u4f8b\naddress_v6_1 = ('2001:0db8::1', 8080, 0, 0)      # \u5b8c\u6574\u5f62\u5f0f\naddress_v6_2 = ('2001:0db8::1', 8080)            # \u7b80\u5316\u5f62\u5f0f\uff08\u7701\u7565 flowinfo \u548c scope_id\uff09\n\n# AF_UNIX \u5730\u5740\u793a\u4f8b\naddress_unix = '/tmp/mysocket.sock'              # Unix \u57df\u5957\u63a5\u5b57\u8def\u5f84\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u5957\u63a5\u5b57\u7c7b\u578b",children:"\u5957\u63a5\u5b57\u7c7b\u578b"}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u7c7b\u578b"}),(0,c.jsx)(n.th,{children:"\u5e38\u91cf"}),(0,c.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"TCP\u6d41"}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"SOCK_STREAM"})}),(0,c.jsx)(n.td,{children:"\u9762\u5411\u8fde\u63a5\u7684\u53ef\u9760\u4f20\u8f93\uff0c\u7528\u4e8e TCP"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"UDP\u6570\u636e\u62a5"}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"SOCK_DGRAM"})}),(0,c.jsx)(n.td,{children:"\u65e0\u8fde\u63a5\u4e0d\u53ef\u9760\u4f20\u8f93\uff0c\u7528\u4e8e UDP"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"\u539f\u59cb\u5957\u63a5\u5b57"}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"SOCK_RAW"})}),(0,c.jsx)(n.td,{children:(0,c.jsx)(s,{text:"\u539f\u59cb\u7f51\u7edc\u534f\u8bae\u8bbf\u95ee",explanation:"\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u76f4\u63a5\u8bbf\u95ee\u7f51\u7edc\u5c42\u6570\u636e\u5305\uff0c\u7ed5\u8fc7\u4f20\u8f93\u5c42\u534f\u8bae\u5904\u7406\u3002\u53ef\u4ee5\u81ea\u5b9a\u4e49\u534f\u8bae\u5934\uff0c\u7528\u4e8e\u7f51\u7edc\u76d1\u63a7\u3001\u5b89\u5168\u5de5\u5177\u3001\u534f\u8bae\u5f00\u53d1\u7b49\u573a\u666f\u3002\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u3002"})})]})]})]}),"\n",(0,c.jsx)(n.admonition,{type:"warning",children:(0,c.jsx)(n.p,{children:"\u4f7f\u7528\u539f\u59cb\u5957\u63a5\u5b57\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff0c\u4e14\u53ef\u4ee5\u7ed5\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u7684\u7f51\u7edc\u5b89\u5168\u673a\u5236\uff0c\u53ef\u80fd\u88ab\u6076\u610f\u8f6f\u4ef6\u5229\u7528\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u5e94\u8c28\u614e\u4f7f\u7528\u3002"})}),"\n",(0,c.jsx)(n.h3,{id:"\u5de5\u4f5c\u6d41\u7a0b",children:"\u5de5\u4f5c\u6d41\u7a0b"}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u7c7b\u578b"}),(0,c.jsx)(n.th,{children:"\u5de5\u4f5c\u6d41\u7a0b"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"TCP\u670d\u52a1\u5668"}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"\u521b\u5efaSocket"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u7ed1\u5b9a\u5730\u5740(bind)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u76d1\u542c(listen)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u63a5\u53d7\u8fde\u63a5(accept)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u6536\u53d1\u6570\u636e(send/recv)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u5173\u95edSocket(close)"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"TCP\u5ba2\u6237\u7aef"}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"\u521b\u5efaSocket"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u8fde\u63a5\u670d\u52a1\u5668(connect)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u6536\u53d1\u6570\u636e(send/recv)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u5173\u95edSocket(close)"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"UDP\u670d\u52a1\u5668"}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"\u521b\u5efaSocket"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u7ed1\u5b9a\u5730\u5740(bind)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u6536\u53d1\u6570\u636e(recvfrom/sendto)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u5173\u95edSocket(close)"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"UDP\u5ba2\u6237\u7aef"}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"\u521b\u5efaSocket"})," \u2192 ",(0,c.jsx)(n.code,{children:"(\u53ef\u9009\u7ed1\u5b9a)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u6536\u53d1\u6570\u636e(sendto/recvfrom)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u5173\u95edSocket(close)"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"\u539f\u59cb\u5957\u63a5\u5b57"}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"\u521b\u5efaSocket"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u7ed1\u5b9a\u5730\u5740(bind)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u8bbe\u7f6e\u9009\u9879(setsockopt)"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u6536\u53d1\u539f\u59cb\u6570\u636e\u5305"})," \u2192 ",(0,c.jsx)(n.code,{children:"\u5173\u95edSocket(close)"})]})]})]})]}),"\n",(0,c.jsxs)(n.admonition,{type:"tip",children:[(0,c.jsx)(n.p,{children:"TCP \u548c UDP \u90fd\u662f\u5168\u53cc\u5de5\u901a\u4fe1\uff0c\u53ef\u4ee5\u540c\u65f6\u53d1\u9001\u548c\u63a5\u6536\u6570\u636e\u3002"}),(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsxs)(n.strong,{children:["TCP \u7684 ",(0,c.jsx)(n.code,{children:"send/recv"})]}),"\uff1a\u5efa\u7acb\u8fde\u63a5\u540e\u53ef\u4ee5\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"send()"})," \u53d1\u9001\u6570\u636e\uff0c\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"recv()"})," \u63a5\u6536\u6570\u636e\uff0c\u4e24\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u4ea4\u66ff\u6216\u5e76\u53d1\u8fdb\u884c"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsxs)(n.strong,{children:["UDP \u7684 ",(0,c.jsx)(n.code,{children:"recvfrom/sendto"})]}),"\uff1a\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"recvfrom()"})," \u63a5\u6536\u6570\u636e\uff08\u8fd4\u56de\u6570\u636e\u548c\u53d1\u9001\u65b9\u5730\u5740\uff09\uff0c\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"sendto()"})," \u53d1\u9001\u6570\u636e\uff08\u9700\u8981\u6307\u5b9a\u76ee\u6807\u5730\u5740\uff09\u3002UDP \u65e0\u8fde\u63a5\uff0c\u6bcf\u6b21\u53d1\u9001\u90fd\u9700\u6307\u5b9a\u5730\u5740"]}),"\n"]})]}),"\n",(0,c.jsx)(n.h2,{id:"\u521b\u5efa\u5957\u63a5\u5b57",children:"\u521b\u5efa\u5957\u63a5\u5b57"}),"\n",(0,c.jsx)(n.h3,{id:"socketsocket",children:"socket.socket()"}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u5957\u63a5\u5b57\u5bf9\u8c61\u7684\u57fa\u672c\u65b9\u6cd5\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\n# \u521b\u5efa TCP \u5957\u63a5\u5b57\uff08IPv4\uff09\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n# \u521b\u5efa UDP \u5957\u63a5\u5b57\uff08IPv4\uff09\nsock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\n\n# \u4f7f\u7528\u9ed8\u8ba4\u53c2\u6570\uff08\u9ed8\u8ba4\u662f AF_INET, SOCK_STREAM\uff09\nsock = socket.socket()\n"})}),"\n",(0,c.jsx)(n.admonition,{type:"tip",children:(0,c.jsxs)(n.p,{children:["\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"socket.socket()"})," \u521b\u5efa TCP \u5957\u63a5\u5b57\u5c31\u8db3\u591f\u4e86\uff0c\u9ed8\u8ba4\u53c2\u6570\u4f1a\u81ea\u52a8\u9009\u62e9\u6700\u5e38\u7528\u7684\u914d\u7f6e\u3002"]})}),"\n",(0,c.jsx)(n.h2,{id:"\u5957\u63a5\u5b57\u9009\u9879",children:"\u5957\u63a5\u5b57\u9009\u9879"}),"\n",(0,c.jsx)(n.h3,{id:"setsockopt",children:"setsockopt()"}),"\n",(0,c.jsx)(n.p,{children:"\u8bbe\u7f6e\u5957\u63a5\u5b57\u9009\u9879\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n# \u5141\u8bb8\u5730\u5740\u91cd\u7528\uff08\u907f\u514d Address already in use \u9519\u8bef\uff09\nsock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n\n# \u8bbe\u7f6e\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f\nsock.setsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF, 8192)\n\n# \u8bbe\u7f6e\u53d1\u9001\u7f13\u51b2\u533a\u5927\u5c0f\nsock.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 8192)\n\n# \u7ed1\u5b9a\u5730\u5740\u524d\u8bbe\u7f6e\u9009\u9879\nsock.bind(('localhost', 8080))\n"})}),"\n",(0,c.jsx)(n.h3,{id:"getsockopt",children:"getsockopt()"}),"\n",(0,c.jsx)(n.p,{children:"\u83b7\u53d6\u5957\u63a5\u5b57\u9009\u9879\u7684\u503c\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n# \u83b7\u53d6\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f\nrcvbuf = sock.getsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF)\nprint(f'\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f: {rcvbuf}')\n\n# \u68c0\u67e5 SO_REUSEADDR \u9009\u9879\nreuse = sock.getsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR)\nprint(f'\u5730\u5740\u91cd\u7528: {bool(reuse)}')\n"})}),"\n",(0,c.jsx)(n.h3,{id:"setblocking",children:"setblocking()"}),"\n",(0,c.jsx)(n.p,{children:"\u8bbe\u7f6e\u5957\u63a5\u5b57\u4e3a\u963b\u585e\u6216\u975e\u963b\u585e\u6a21\u5f0f\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n# \u8bbe\u7f6e\u4e3a\u975e\u963b\u585e\u6a21\u5f0f\nsock.setblocking(False)\n\n# \u8bbe\u7f6e\u4e3a\u963b\u585e\u6a21\u5f0f\uff08\u9ed8\u8ba4\uff09\nsock.setblocking(True)\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u8d85\u65f6\u5904\u7406",children:"\u8d85\u65f6\u5904\u7406"}),"\n",(0,c.jsx)(n.h3,{id:"settimeout",children:"settimeout()"}),"\n",(0,c.jsx)(n.p,{children:"\u8bbe\u7f6e\u5957\u63a5\u5b57\u64cd\u4f5c\u7684\u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n# \u8bbe\u7f6e 5 \u79d2\u8d85\u65f6\nsock.settimeout(5.0)\n\ntry:\n    sock.connect(('www.example.com', 80))\n    data = sock.recv(1024)\nexcept socket.timeout:\n    print('\u64cd\u4f5c\u8d85\u65f6')\nexcept OSError as e:\n    print(f'\u9519\u8bef: {e}')\n"})}),"\n",(0,c.jsx)(n.h3,{id:"gettimeout",children:"gettimeout()"}),"\n",(0,c.jsx)(n.p,{children:"\u83b7\u53d6\u5f53\u524d\u8d85\u65f6\u8bbe\u7f6e\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n# \u83b7\u53d6\u8d85\u65f6\u8bbe\u7f6e\uff08None \u8868\u793a\u65e0\u8d85\u65f6\uff09\ntimeout = sock.gettimeout()\nprint(f'\u8d85\u65f6\u8bbe\u7f6e: {timeout}')\n"})}),"\n",(0,c.jsx)(n.admonition,{type:"info",children:(0,c.jsxs)(n.p,{children:["\u8d85\u65f6\u8bbe\u7f6e\u5f71\u54cd\u4ee5\u4e0b\u64cd\u4f5c\uff1a",(0,c.jsx)(n.code,{children:"connect()"}),", ",(0,c.jsx)(n.code,{children:"recv()"}),", ",(0,c.jsx)(n.code,{children:"send()"}),", ",(0,c.jsx)(n.code,{children:"accept()"}),"\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a ",(0,c.jsx)(n.code,{children:"None"}),"\uff08\u9ed8\u8ba4\uff09\uff0c\u64cd\u4f5c\u4f1a\u65e0\u9650\u671f\u963b\u585e\u3002"]})}),"\n",(0,c.jsx)(n.h2,{id:"\u5730\u5740\u89e3\u6790\u51fd\u6570",children:"\u5730\u5740\u89e3\u6790\u51fd\u6570"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"gethostname()"})," \u83b7\u53d6\u672c\u5730\u4e3b\u673a\u7684\u6807\u51c6\u4e3b\u673a\u540d\u3002\n",(0,c.jsx)(n.code,{children:"gethostbyname()"})," \u5c06\u4e3b\u673a\u540d\u8f6c\u6362\u4e3a IPv4 \u5730\u5740\u3002\n",(0,c.jsx)(n.code,{children:"gethostbyaddr()"})," \u5c06 IP \u5730\u5740\u8f6c\u6362\u4e3a\u4e3b\u673a\u540d\uff08\u53cd\u5411\u89e3\u6790\uff09\u3002\n",(0,c.jsx)(n.code,{children:"getservbyname()"})," \u6839\u636e\u670d\u52a1\u540d\u548c\u534f\u8bae\u83b7\u53d6\u7aef\u53e3\u53f7\u3002\n",(0,c.jsx)(n.code,{children:"getservbyport()"})," \u6839\u636e\u7aef\u53e3\u53f7\u548c\u534f\u8bae\u83b7\u53d6\u670d\u52a1\u540d\u3002"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:"import socket\n\nhostname = socket.gethostname()\nprint(hostname) # Allen\n\nlocal_ip = socket.gethostbyname('localhost')\nprint(f'\u672c\u5730 IP: {local_ip}') # 127.0.0.1\n\n# \u89e3\u6790\u4e3b\u673a\u540d\nip = socket.gethostbyname('www.baidu.com')\nprint(f'IP \u5730\u5740: {ip}') #183.2.172.177\n\nhostname, aliases, addresses = socket.gethostbyname_ex('www.baidu.com')\nprint(f'\u4e3b\u673a\u540d: {hostname}') # www.a.shifen.com\nprint(f'\u522b\u540d: {aliases}') # ['www.baidu.com']\nprint(f'IP \u5730\u5740: {addresses}') #  ['183.2.172.177', '183.2.172.17']\n\n"})}),"\n",(0,c.jsx)(n.h3,{id:"gethostbyaddr",children:"gethostbyaddr()"}),"\n",(0,c.jsx)(n.p,{children:"\u5c06 IP \u5730\u5740\u8f6c\u6362\u4e3a\u4e3b\u673a\u540d\uff08\u53cd\u5411\u89e3\u6790\uff09\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\ntry:\n    hostname, aliases, addresses = socket.gethostbyaddr('93.184.216.34')\n    print(f'\u4e3b\u673a\u540d: {hostname}')\n    print(f'\u522b\u540d: {aliases}')\n    print(f'IP \u5730\u5740: {addresses}')\nexcept socket.herror:\n    print('\u65e0\u6cd5\u89e3\u6790\u5730\u5740')\n"})}),"\n",(0,c.jsx)(n.h3,{id:"getservbyname",children:"getservbyname()"}),"\n",(0,c.jsx)(n.p,{children:"\u6839\u636e\u670d\u52a1\u540d\u548c\u534f\u8bae\u83b7\u53d6\u7aef\u53e3\u53f7\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\n# \u83b7\u53d6 HTTP \u670d\u52a1\u7684\u7aef\u53e3\u53f7\nhttp_port = socket.getservbyname('http', 'tcp')\nprint(f'HTTP \u7aef\u53e3: {http_port}')\n\n# \u83b7\u53d6 FTP \u670d\u52a1\u7684\u7aef\u53e3\u53f7\nftp_port = socket.getservbyname('ftp', 'tcp')\nprint(f'FTP \u7aef\u53e3: {ftp_port}')\n\n# UDP \u670d\u52a1\ndns_port = socket.getservbyname('domain', 'udp')\nprint(f'DNS \u7aef\u53e3: {dns_port}')\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u670d\u52a1\u5668\u7aef\u64cd\u4f5c",children:"\u670d\u52a1\u5668\u7aef\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.h3,{id:"bind",children:"bind()"}),"\n",(0,c.jsx)(n.p,{children:"\u5c06\u5957\u63a5\u5b57\u7ed1\u5b9a\u5230\u7279\u5b9a\u7684\u7f51\u7edc\u5730\u5740\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n# \u7ed1\u5b9a\u5230\u672c\u5730\u5730\u5740\u548c\u7aef\u53e3\nsock.bind(('localhost', 8080))\n\n# \u7ed1\u5b9a\u5230\u6240\u6709\u7f51\u7edc\u63a5\u53e3\nsock.bind(('', 8080))\n\n# \u7ed1\u5b9a\u5230 Unix \u57df\u5957\u63a5\u5b57\nunix_sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)\nunix_sock.bind('/tmp/mysocket.sock')\n"})}),"\n",(0,c.jsx)(n.admonition,{type:"warning",children:(0,c.jsxs)(n.p,{children:["\u5982\u679c\u7aef\u53e3\u5df2\u88ab\u5360\u7528\uff0c",(0,c.jsx)(n.code,{children:"bind()"})," \u4f1a\u629b\u51fa ",(0,c.jsx)(n.code,{children:"OSError: [Errno 98] Address already in use"}),"\u3002\u53ef\u4ee5\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"SO_REUSEADDR"})," \u9009\u9879\u6765\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\u3002"]})}),"\n",(0,c.jsx)(n.h3,{id:"listenaccept",children:"listen()\u3001accept()"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"listen()"})," \u4f7f\u5957\u63a5\u5b57\u8fdb\u5165\u76d1\u542c\u72b6\u6001\uff0c\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"accept()"})," \u63a5\u53d7\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u8fd4\u56de\u65b0\u7684\u5957\u63a5\u5b57\u5bf9\u8c61\u548c\u5ba2\u6237\u7aef\u5730\u5740\u3002"]}),"\n",(0,c.jsx)(n.p,{children:"accept() \u4f1a\u963b\u585e\uff0c\u76f4\u5230\u6709\u5ba2\u6237\u7aef\u8fde\u63a5\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:'import socket\n\nsock = socket.socket()\n\nsock.bind((\'localhost\', 8080))\nsock.listen(5)\n\nclient_sock, client_addr = sock.accept()\nprint(f"""\u6536\u5230\u6765\u81ea {client_addr} \u7684\u8fde\u63a5""")\n\nmessage = client_sock.recv(1024).decode(\'utf-8\') or "\u7a7a\u6d88\u606f"\nprint(f"""\u6d88\u606f\u4e3a: {message}""")\n'})}),"\n",(0,c.jsx)(n.h2,{id:"\u5ba2\u6237\u7aef\u64cd\u4f5c",children:"\u5ba2\u6237\u7aef\u64cd\u4f5c"}),"\n",(0,c.jsx)(n.h3,{id:"connectconnect_ex",children:"connect()\u3001connect_ex()"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"connect()"})," \u5efa\u7acb\u4e0e\u670d\u52a1\u5668\u7684\u8fde\u63a5\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"connect_ex()"})," \u7c7b\u4f3c ",(0,c.jsx)(n.code,{children:"connect()"}),"\uff0c\u4f46\u8fd4\u56de\u9519\u8bef\u7801\u800c\u4e0d\u662f\u629b\u51fa\u5f02\u5e38\u3002"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\ntry:\n    sock.connect(('localhost', 8080))\n    print('\u8fde\u63a5\u6210\u529f')\nexcept OSError as e:\n    print(f'\u8fde\u63a5\u5931\u8d25\uff0c\u9519\u8bef\u7801: {e.errno}')\n\nerr = sock.connect_ex(('localhost', 8080))\nif err == 0:\n    print('\u8fde\u63a5\u6210\u529f')\nelse:\n    print(f'\u8fde\u63a5\u5931\u8d25\uff0c\u9519\u8bef\u7801: {err}')\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u6570\u636e\u4f20\u8f93",children:"\u6570\u636e\u4f20\u8f93"}),"\n",(0,c.jsx)(n.h3,{id:"sendsendallsendto",children:"send()\u3001sendall()\u3001sendto()"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"send()"})," \u53d1\u9001\u6570\u636e\uff0c\u8fd4\u56de\u53d1\u9001\u7684\u5b57\u8282\u6570\u3002\n",(0,c.jsx)(n.code,{children:"sendall()"})," \u53d1\u9001\u6240\u6709\u6570\u636e\uff0c\u76f4\u5230\u5168\u90e8\u53d1\u9001\u5b8c\u6210\u3002\n",(0,c.jsx)(n.code,{children:"sendto()"})," \u53d1\u9001\u6570\u636e\u5230\u6307\u5b9a\u5730\u5740\u3002"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",metastring:"showLineNumbers",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nsock.connect(('localhost', 8080))\n\n# \u53d1\u9001\u6570\u636e\uff08\u53ef\u80fd\u53ea\u53d1\u9001\u90e8\u5206\u6570\u636e\uff09\u5982\u679c\u53ea\u53d1\u9001\u4e86\u90e8\u5206\u6570\u636e\uff0c\u9700\u8981\u7ee7\u7eed\u53d1\u9001\u5269\u4f59\u90e8\u5206\u3002\nsent = sock.send(b'Hello, Server')\nprint(f'\u53d1\u9001\u4e86 {sent} \u5b57\u8282')\n\n# \u53d1\u9001\u6240\u6709\u6570\u636e\uff0c\u76f4\u5230\u5168\u90e8\u53d1\u9001\u5b8c\u6210\u3002\u786e\u4fdd\u6240\u6709\u6570\u636e\u90fd\u88ab\u53d1\u9001\nmessage = b'Hello, Server' * 100\nsock.sendall(message)\nprint('\u6240\u6709\u6570\u636e\u5df2\u53d1\u9001')\n\n# \u53d1\u9001 UDP \u6570\u636e\u5230\u6307\u5b9a\u5730\u5740\nsock.sendto(b'Hello, Server', ('localhost', 8080))\n"})}),"\n",(0,c.jsx)(n.h3,{id:"recvrecvfrom",children:"recv()\u3001recvfrom()"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"recv()"})," \u63a5\u6536\u6570\u636e\uff0c\u8fd4\u56de\u63a5\u6536\u5230\u7684\u6570\u636e\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"recvfrom()"})," \u63a5\u6536\u6570\u636e\uff0c\u8fd4\u56de\u63a5\u6536\u5230\u7684\u6570\u636e\u548c\u53d1\u9001\u65b9\u5730\u5740\u3002"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nsock.connect(('localhost', 8080))\n\n# \u63a5\u6536\u6700\u591a 1024 \u5b57\u8282\uff081kb\uff09\ndata = sock.recv(1024)\nprint(f'\u63a5\u6536\u5230 {len(data)} \u5b57\u8282: {data}')\n\ndata, addr = sock.recvfrom(1024)\nprint(f'\u4ece {addr} \u63a5\u6536\u5230: {data}')\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u5173\u4e8e\u6700\u591a\u63a5\u6536\u5b57\u8282\u6570\uff1a"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"recv(bufsize)"})," \u4e2d\u7684 ",(0,c.jsx)(n.code,{children:"bufsize"})," \u53c2\u6570\u6307\u5b9a",(0,c.jsx)(n.strong,{children:"\u5355\u6b21\u8c03\u7528\u6700\u591a\u63a5\u6536\u7684\u5b57\u8282\u6570"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"\u7406\u8bba\u4e0a\u6ca1\u6709\u4e25\u683c\u4e0a\u9650"}),"\uff0c\u4f46\u5b9e\u9645\u4f7f\u7528\u53d7\u4ee5\u4e0b\u56e0\u7d20\u9650\u5236\uff1a","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u7cfb\u7edf\u5185\u5b58\u5927\u5c0f"}),"\n",(0,c.jsxs)(n.li,{children:["\u5957\u63a5\u5b57\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f\uff08",(0,c.jsx)(n.code,{children:"SO_RCVBUF"}),"\uff0c\u901a\u5e38\u9ed8\u8ba4 64KB \u6216\u66f4\u5927\uff09"]}),"\n",(0,c.jsx)(n.li,{children:"\u7f51\u7edc MTU\uff08\u6700\u5927\u4f20\u8f93\u5355\u5143\uff0c\u4ee5\u592a\u7f51\u901a\u5e38\u4e3a 1500 \u5b57\u8282\uff09"}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsxs)(n.strong,{children:["\u5b9e\u9645\u63a5\u6536\u7684\u5b57\u8282\u6570\u53ef\u80fd\u5c11\u4e8e ",(0,c.jsx)(n.code,{children:"bufsize"})]}),"\uff0c\u53d6\u51b3\u4e8e\u5f53\u524d\u53ef\u7528\u7684\u6570\u636e\u91cf"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"\u5e38\u7528\u503c"}),"\uff1a",(0,c.jsx)(n.code,{children:"1024"})," (1KB)\u3001",(0,c.jsx)(n.code,{children:"2048"})," (2KB)\u3001",(0,c.jsx)(n.code,{children:"4096"})," (4KB)\u3001",(0,c.jsx)(n.code,{children:"8192"})," (8KB) \u7b49\uff08\u901a\u5e38\u4f7f\u7528 2 \u7684\u5e42\u6b21\uff09"]}),"\n"]}),"\n",(0,c.jsx)(n.admonition,{type:"tip",children:(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"recv()"})," \u53c2\u6570\u53ea\u662f\u9650\u5236\u5355\u6b21\u8bfb\u53d6\u7684\u6700\u5927\u5b57\u8282\u6570\uff0c\u4e0d\u9650\u5236\u53ef\u4ee5\u591a\u6b21\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"recv()"})," \u63a5\u6536\u7684\u603b\u6570\u636e\u91cf\u3002\u5982\u679c\u9700\u8981\u63a5\u6536\u56fa\u5b9a\u5927\u5c0f\u7684\u6570\u636e\uff0c\u9700\u8981\u5728\u5faa\u73af\u4e2d\u591a\u6b21\u8c03\u7528\u76f4\u5230\u63a5\u6536\u5b8c\u6210\u3002"]})}),"\n",(0,c.jsx)(n.h2,{id:"\u5173\u95ed\u5957\u63a5\u5b57",children:"\u5173\u95ed\u5957\u63a5\u5b57"}),"\n",(0,c.jsx)(n.h3,{id:"close",children:"close()"}),"\n",(0,c.jsx)(n.p,{children:"\u5173\u95ed\u5957\u63a5\u5b57\uff0c\u91ca\u653e\u8d44\u6e90\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nsock.connect(('www.example.com', 80))\n\n# \u5173\u95ed\u5957\u63a5\u5b57\nsock.close()\n"})}),"\n",(0,c.jsx)(n.h3,{id:"shutdown",children:"shutdown()"}),"\n",(0,c.jsx)(n.p,{children:"\u5173\u95ed\u8fde\u63a5\u7684\u4e00\u90e8\u5206\u6216\u5168\u90e8\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nsock.connect(('www.example.com', 80))\n\n# SHUT_RD: \u5173\u95ed\u63a5\u6536\n# SHUT_WR: \u5173\u95ed\u53d1\u9001\n# SHUT_RDWR: \u5173\u95ed\u63a5\u6536\u548c\u53d1\u9001\nsock.shutdown(socket.SHUT_RDWR)\nsock.close()\n"})}),"\n",(0,c.jsx)(n.h3,{id:"getsockname",children:"getsockname()"}),"\n",(0,c.jsx)(n.p,{children:"\u83b7\u53d6\u5957\u63a5\u5b57\u81ea\u5df1\u7684\u5730\u5740\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nsock.bind(('localhost', 8080))\n\n# \u83b7\u53d6\u7ed1\u5b9a\u540e\u7684\u5730\u5740\naddr, port = sock.getsockname()\nprint(f'\u672c\u5730\u5730\u5740: {addr}:{port}')\n"})}),"\n",(0,c.jsx)(n.h3,{id:"getpeername",children:"getpeername()"}),"\n",(0,c.jsx)(n.p,{children:"\u83b7\u53d6\u5df2\u8fde\u63a5\u5957\u63a5\u5b57\u7684\u8fdc\u7a0b\u5730\u5740\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"import socket\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nsock.connect(('www.example.com', 80))\n\n# \u83b7\u53d6\u8fdc\u7a0b\u5730\u5740\naddr, port = sock.getpeername()\nprint(f'\u8fdc\u7a0b\u5730\u5740: {addr}:{port}')\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u793a\u4f8b\u591a\u7ebf\u7a0btcp\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef",children:"\u793a\u4f8b\uff1a\u591a\u7ebf\u7a0bTCP\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef"}),"\n",(0,c.jsxs)(n.p,{children:["\u4f7f\u7528\u6807\u51c6\u5e93\u7684 ",(0,c.jsx)(n.code,{children:"threading"})," \u6a21\u5757\u5b9e\u73b0TCP\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\uff0c\u652f\u6301\u540c\u65f6\u6536\u53d1\u6570\u636e\uff1a"]}),"\n","\n",(0,c.jsxs)(o.A,{children:[(0,c.jsxs)(d.A,{value:"server",label:"\u670d\u52a1\u7aef",default:!0,children:[(0,c.jsx)(n.p,{children:"\u4e3b\u7ebf\u7a0b\u8d1f\u8d23\u76d1\u542c\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u6bcf\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u5c31\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b(handle_client)\u6765\u5904\u7406\u8be5\u94fe\u63a5\u7684\u6536\u53d1\u6570\u636e\u3002"}),(0,c.jsx)(n.p,{children:"\u8be5\u7ebf\u7a0b(handle_client)\u53c8\u5305\u542b\u4e24\u4e2a\u7ebf\u7a0b(send_data, recv_data)\u6765\u5904\u7406\u8be5\u94fe\u63a5\u7684\u6536\u53d1\u6570\u636e\u3002"}),(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="tcp_server.py"',children:"import socket\nimport threading\n\ndef handle_client(client_sock, client_addr):\n    \"\"\"\u5904\u7406\u5ba2\u6237\u7aef\u8fde\u63a5\u7684\u7ebf\u7a0b\u51fd\u6570\"\"\"\n    print(f'\u5ba2\u6237\u7aef {client_addr} \u5df2\u8fde\u63a5')\n    \n    # \u521b\u5efa\u53d1\u9001\u6570\u636e\u7684\u7ebf\u7a0b\n    def send_data():\n        try:\n            while True:\n                message = input(f'\u5411 {client_addr} \u53d1\u9001: ')\n                if not message:\n                    break\n                client_sock.sendall(message.encode('utf-8'))\n        except (ConnectionResetError, BrokenPipeError):\n            print(f'\u5ba2\u6237\u7aef {client_addr} \u65ad\u5f00\u8fde\u63a5')\n    \n    # \u521b\u5efa\u63a5\u6536\u6570\u636e\u7684\u7ebf\u7a0b\n    def recv_data():\n        try:\n            while True:\n                data = client_sock.recv(1024)\n                if not data:\n                    break\n                print(f'\u6536\u5230\u6765\u81ea {client_addr} \u7684\u6d88\u606f: {data.decode(\"utf-8\")}')\n        except (ConnectionResetError, BrokenPipeError):\n            print(f'\u5ba2\u6237\u7aef {client_addr} \u65ad\u5f00\u8fde\u63a5')\n        finally:\n            client_sock.close()\n    \n    # \u542f\u52a8\u53d1\u9001\u548c\u63a5\u6536\u7ebf\u7a0b\n    send_thread = threading.Thread(target=send_data, daemon=True)\n    recv_thread = threading.Thread(target=recv_data, daemon=True)\n    \n    send_thread.start()\n    recv_thread.start()\n    \n    # \u7b49\u5f85\u63a5\u6536\u7ebf\u7a0b\u7ed3\u675f\uff08\u5ba2\u6237\u7aef\u65ad\u5f00\u8fde\u63a5\uff09\n    recv_thread.join()\n    print(f'\u5ba2\u6237\u7aef {client_addr} \u8fde\u63a5\u5df2\u5173\u95ed')\n\ndef main():\n    # \u521b\u5efaTCP\u5957\u63a5\u5b57\n    server_sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    # \u5141\u8bb8\u5730\u5740\u91cd\u7528\uff08\u907f\u514d Address already in use \u9519\u8bef\uff09\n    server_sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n    server_sock.bind(('localhost', 8888))\n    server_sock.listen(5)\n    \n    print('\u670d\u52a1\u5668\u542f\u52a8\uff0c\u76d1\u542c 0.0.0.0:8888')\n    print('\u7b49\u5f85\u5ba2\u6237\u7aef\u8fde\u63a5...')\n    \n    try:\n        while True:\n            # \u63a5\u53d7\u5ba2\u6237\u7aef\u8fde\u63a5\n            client_sock, client_addr = server_sock.accept()\n            \n            # \u4e3a\u6bcf\u4e2a\u5ba2\u6237\u7aef\u521b\u5efa\u65b0\u7ebf\u7a0b\n            client_thread = threading.Thread(\n                target=handle_client,\n                args=(client_sock, client_addr),\n                daemon=True\n            )\n            client_thread.start()\n    except KeyboardInterrupt:\n        print('\\n\u670d\u52a1\u5668\u5173\u95ed')\n    finally:\n        server_sock.close()\n\nif __name__ == '__main__':\n    main()\n"})})]}),(0,c.jsx)(d.A,{value:"client",label:"\u5ba2\u6237\u7aef",children:(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",metastring:'showLineNumbers title="tcp_client.py"',children:"import socket\nimport threading\n\ndef send_data(client_sock):\n    \"\"\"\u53d1\u9001\u6570\u636e\u7684\u7ebf\u7a0b\u51fd\u6570\"\"\"\n    try:\n        while True:\n            message = input('\u53d1\u9001\u6d88\u606f: ')\n            if not message:\n                break\n            client_sock.sendall(message.encode('utf-8'))\n    except (ConnectionResetError, BrokenPipeError):\n        print('\u670d\u52a1\u5668\u65ad\u5f00\u8fde\u63a5')\n    except Exception as e:\n        print(f'\u53d1\u9001\u9519\u8bef: {e}')\n\ndef recv_data(client_sock):\n    \"\"\"\u63a5\u6536\u6570\u636e\u7684\u7ebf\u7a0b\u51fd\u6570\"\"\"\n    try:\n        while True:\n            data = client_sock.recv(1024)\n            if not data:\n                break\n            print(f'\u6536\u5230\u6d88\u606f: {data.decode(\"utf-8\")}')\n    except (ConnectionResetError, BrokenPipeError):\n        print('\u670d\u52a1\u5668\u65ad\u5f00\u8fde\u63a5')\n    except Exception as e:\n        print(f'\u63a5\u6536\u9519\u8bef: {e}')\n    finally:\n        client_sock.close()\n\ndef main():\n    # \u521b\u5efaTCP\u5957\u63a5\u5b57\u5e76\u8fde\u63a5\u670d\u52a1\u5668\n    client_sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    \n    try:\n        client_sock.connect(('localhost', 8888))\n        print('\u5df2\u8fde\u63a5\u5230\u670d\u52a1\u5668 localhost:8888')\n        print('\u53ef\u4ee5\u5f00\u59cb\u53d1\u9001\u548c\u63a5\u6536\u6d88\u606f\uff08\u8f93\u5165\u7a7a\u6d88\u606f\u9000\u51fa\uff09')\n        \n        # \u521b\u5efa\u53d1\u9001\u548c\u63a5\u6536\u7ebf\u7a0b\n        send_thread = threading.Thread(target=send_data, args=(client_sock,), daemon=True)\n        recv_thread = threading.Thread(target=recv_data, args=(client_sock,), daemon=True)\n        \n        # \u542f\u52a8\u7ebf\u7a0b\n        send_thread.start()\n        recv_thread.start()\n        \n        # \u7b49\u5f85\u53d1\u9001\u7ebf\u7a0b\u7ed3\u675f\uff08\u7528\u6237\u8f93\u5165\u7a7a\u6d88\u606f\uff09\n        send_thread.join()\n        \n    except ConnectionRefusedError:\n        print('\u65e0\u6cd5\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u8bf7\u786e\u4fdd\u670d\u52a1\u5668\u5df2\u542f\u52a8')\n    except Exception as e:\n        print(f'\u8fde\u63a5\u9519\u8bef: {e}')\n    finally:\n        client_sock.close()\n        print('\u5ba2\u6237\u7aef\u5df2\u5173\u95ed')\n\nif __name__ == '__main__':\n    main()\n"})})})]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(x,{...e})}):x(e)}},19365:(e,n,s)=>{s.d(n,{A:()=>o});s(96540);var t=s(18215);const c={tabItem:"tabItem_Ymn6"};var r=s(74848);function o({children:e,hidden:n,className:s}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)(c.tabItem,s),hidden:n,children:e})}},11470:(e,n,s)=>{s.d(n,{A:()=>y});var t=s(96540),c=s(18215),r=s(17559),o=s(23104),d=s(56347),i=s(205),l=s(57485),a=s(31682),h=s(70679);function x(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:s}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return x(e).map((({props:{value:e,label:n,attributes:s,default:t}})=>({value:e,label:n,attributes:s,default:t})))}(s);return function(e){const n=(0,a.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,s])}function j({value:e,tabValues:n}){return n.some((n=>n.value===e))}function u({queryString:e=!1,groupId:n}){const s=(0,d.W6)(),c=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(c),(0,t.useCallback)((e=>{if(!c)return;const n=new URLSearchParams(s.location.search);n.set(c,e),s.replace({...s.location,search:n.toString()})}),[c,s])]}function k(e){const{defaultValue:n,queryString:s=!1,groupId:c}=e,r=p(e),[o,d]=(0,t.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!j({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=n.find((e=>e.default))??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:r}))),[l,a]=u({queryString:s,groupId:c}),[x,k]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,c]=(0,h.Dv)(n);return[s,(0,t.useCallback)((e=>{n&&c.set(e)}),[n,c])]}({groupId:c}),m=(()=>{const e=l??x;return j({value:e,tabValues:r})?e:null})();(0,i.A)((()=>{m&&d(m)}),[m]);return{selectedValue:o,selectValue:(0,t.useCallback)((e=>{if(!j({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);d(e),a(e),k(e)}),[a,k,r]),tabValues:r}}var m=s(92303);const _={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=s(74848);function g({className:e,block:n,selectedValue:s,selectValue:t,tabValues:r}){const d=[],{blockElementScrollPositionUntilNextRender:i}=(0,o.a_)(),l=e=>{const n=e.currentTarget,c=d.indexOf(n),o=r[c].value;o!==s&&(i(n),t(o))},a=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const s=d.indexOf(e.currentTarget)+1;n=d[s]??d[0];break}case"ArrowLeft":{const s=d.indexOf(e.currentTarget)-1;n=d[s]??d[d.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,c.A)("tabs",{"tabs--block":n},e),children:r.map((({value:e,label:n,attributes:t})=>(0,v.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{d.push(e)},onKeyDown:a,onClick:l,...t,className:(0,c.A)("tabs__item",_.tabItem,t?.className,{"tabs__item--active":s===e}),children:n??e},e)))})}function f({lazy:e,children:n,selectedValue:s}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find((e=>e.props.value===s));return e?(0,t.cloneElement)(e,{className:(0,c.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function b(e){const n=k(e);return(0,v.jsxs)("div",{className:(0,c.A)(r.G.tabs.container,"tabs-container",_.tabList),children:[(0,v.jsx)(g,{...n,...e}),(0,v.jsx)(f,{...n,...e})]})}function y(e){const n=(0,m.A)();return(0,v.jsx)(b,{...e,children:x(e.children)},String(n))}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var t=s(96540);const c={},r=t.createContext(c);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);