"use strict";(self.webpackChunkjiangmiemie=self.webpackChunkjiangmiemie||[]).push([[2526],{43284:(n,e,d)=>{d.r(e),d.d(e,{assets:()=>t,contentTitle:()=>l,default:()=>o,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"\u6570\u636e\u5206\u6790/Pandas","title":"Pandas","description":"Pandas \u662f\u57fa\u4e8e NumPy \u6784\u5efa\u7684\u6570\u636e\u5206\u6790\u5e93\uff0c\u63d0\u4f9b\u4e86\u9ad8\u6548\u3001\u7075\u6d3b\u7684\u6570\u636e\u7ed3\u6784\uff0c\u8ba9\u6570\u636e\u5904\u7406\u548c\u5206\u6790\u53d8\u5f97\u66f4\u52a0\u7b80\u5355\u3002","source":"@site/docs/docs/\u6570\u636e\u5206\u6790/Pandas.mdx","sourceDirName":"\u6570\u636e\u5206\u6790","slug":"/\u6570\u636e\u5206\u6790/Pandas","permalink":"/docs/\u6570\u636e\u5206\u6790/Pandas","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Pandas"},"sidebar":"tutorialSidebar","previous":{"title":"NumPy","permalink":"/docs/\u6570\u636e\u5206\u6790/NumPy"},"next":{"title":"\u6570\u636e\u5e93\ud83d\udd28","permalink":"/docs/\u6570\u636e\u5e93/"}}');var s=d(74848),a=d(28453);const r={sidebar_position:3,title:"Pandas"},l=void 0,t={},c=[{value:"\u6570\u636e\u7ed3\u6784",id:"\u6570\u636e\u7ed3\u6784",level:2},{value:"Series",id:"series",level:3},{value:"DataFrame",id:"dataframe",level:3},{value:"Index",id:"index",level:3},{value:"\u6570\u636eIO",id:"\u6570\u636eio",level:2},{value:"CSV/Excel \u6587\u4ef6",id:"csvexcel-\u6587\u4ef6",level:3},{value:"JSON \u6587\u4ef6",id:"json-\u6587\u4ef6",level:3},{value:"SQL \u6570\u636e\u5e93",id:"sql-\u6570\u636e\u5e93",level:3},{value:"\u6570\u636e\u9009\u62e9",id:"\u6570\u636e\u9009\u62e9",level:2},{value:"\u57fa\u672c\u9009\u62e9",id:"\u57fa\u672c\u9009\u62e9",level:3},{value:"loc \u548c iloc",id:"loc-\u548c-iloc",level:3},{value:"\u6761\u4ef6\u7b5b\u9009",id:"\u6761\u4ef6\u7b5b\u9009",level:3},{value:"\u6570\u636e\u6e05\u6d17",id:"\u6570\u636e\u6e05\u6d17",level:2},{value:"\u7f3a\u5931\u503c\u5904\u7406",id:"\u7f3a\u5931\u503c\u5904\u7406",level:3},{value:"\u91cd\u590d\u503c\u5904\u7406",id:"\u91cd\u590d\u503c\u5904\u7406",level:3},{value:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362",id:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362",level:3},{value:"\u6570\u636e\u8f6c\u6362",id:"\u6570\u636e\u8f6c\u6362",level:2},{value:"apply/map/applymap",id:"applymapapplymap",level:3},{value:"\u6392\u5e8f",id:"\u6392\u5e8f",level:3},{value:"\u6570\u636e\u5408\u5e76",id:"\u6570\u636e\u5408\u5e76",level:3},{value:"\u6570\u636e\u5206\u6790",id:"\u6570\u636e\u5206\u6790",level:2},{value:"\u5206\u7ec4\u805a\u5408\uff08GroupBy\uff09",id:"\u5206\u7ec4\u805a\u5408groupby",level:3},{value:"\u6570\u636e\u900f\u89c6\uff08Pivot\uff09",id:"\u6570\u636e\u900f\u89c6pivot",level:3}];function p(n){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.a,{href:"https://pandas.pydata.org/docs",children:"Pandas"})," \u662f\u57fa\u4e8e NumPy \u6784\u5efa\u7684\u6570\u636e\u5206\u6790\u5e93\uff0c\u63d0\u4f9b\u4e86\u9ad8\u6548\u3001\u7075\u6d3b\u7684\u6570\u636e\u7ed3\u6784\uff0c\u8ba9\u6570\u636e\u5904\u7406\u548c\u5206\u6790\u53d8\u5f97\u66f4\u52a0\u7b80\u5355\u3002"]}),"\n",(0,s.jsx)(e.p,{children:"\u63a8\u8350\u5148\u5728\u5b98\u65b9\u6587\u6863\u6d4f\u89c8API\u76ee\u5f55\uff0c\u53ef\u4ee5\u5feb\u901f\u8fd9\u4e2a\u8fd9\u4e2a\u6846\u67b6\u7684\u5e94\u7528\u8303\u56f4\u6709\u4e2a\u4e86\u89e3\u3002\u518d\u5411\u4e0b\u9605\u8bfb\u5e38\u7528\u7684API\u4f7f\u7528\u65b9\u6cd5\u3002"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Pandas \u7684\u6838\u5fc3\u6570\u636e\u7ed3\u6784\uff1a"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Series"}),"\uff1a\u4e00\u7ef4\u6570\u636e\u7ed3\u6784\uff0c\u5e26\u6807\u7b7e\u7684\u6570\u7ec4\uff08\u7c7b\u4f3c\u4e8e Excel \u7684\u4e00\u5217\uff09"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"DataFrame"}),"\uff1a\u4e8c\u7ef4\u6570\u636e\u7ed3\u6784\uff0c\u5e26\u6807\u7b7e\u7684\u8868\u683c\uff08\u7c7b\u4f3c\u4e8e Excel \u8868\u683c\u6216 SQL \u8868\uff09"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Pandas \u7684\u6838\u5fc3\u4f18\u52bf\uff1a"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u7075\u6d3b\u7684\u6570\u636e\u7ed3\u6784"}),"\uff1a\u8f7b\u677e\u5904\u7406\u5404\u79cd\u7c7b\u578b\u7684\u6570\u636e"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u5f3a\u5927\u7684\u6570\u636e\u64cd\u4f5c"}),"\uff1a\u7b5b\u9009\u3001\u5206\u7ec4\u3001\u5408\u5e76\u3001\u900f\u89c6\u7b49"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u65f6\u95f4\u5e8f\u5217\u652f\u6301"}),"\uff1a\u5185\u7f6e\u65e5\u671f\u65f6\u95f4\u5904\u7406\u529f\u80fd"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u7f3a\u5931\u503c\u5904\u7406"}),"\uff1a\u65b9\u4fbf\u7684\u7f3a\u5931\u6570\u636e\u5904\u7406\u65b9\u6cd5"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u6570\u636eIO"}),"\uff1a\u652f\u6301 CSV\u3001Excel\u3001SQL\u3001JSON \u7b49\u683c\u5f0f"]}),"\n"]}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u6570\u636e\u7ed3\u6784\u5173\u7cfb\uff1a"})}),(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Series = \u4e00\u7ef4\u6570\u7ec4 + \u884c\u7d22\u5f15"}),"\n",(0,s.jsx)(e.li,{children:"DataFrame = \u591a\u4e2a Series \u7ec4\u6210\u7684\u4e8c\u7ef4\u8868 + \u884c\u7d22\u5f15 + \u5217\u7d22\u5f15"}),"\n",(0,s.jsx)(e.li,{children:"DataFrame \u53ef\u4ee5\u770b\u4f5c\u662f Series \u7684\u5b57\u5178\uff08\u5171\u7528\u884c\u7d22\u5f15\uff09"}),"\n"]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# Series\uff1a\u4e00\u5217\u6570\u636e\ns = pd.Series([1, 2, 3], index=['a', 'b', 'c'])\n\n# DataFrame\uff1a\u591a\u5217\u6570\u636e\ndf = pd.DataFrame({\n    'col1': [1, 2, 3],\n    'col2': [4, 5, 6]\n}, index=['a', 'b', 'c'])\n"})})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"https://pandas.pydata.org/docs/reference/index.html",children:"Pandas \u5b98\u65b9\u6587\u6863"})}),"\n",(0,s.jsx)(e.h2,{id:"\u6570\u636e\u7ed3\u6784",children:"\u6570\u636e\u7ed3\u6784"}),"\n",(0,s.jsx)(e.h3,{id:"series",children:"Series"}),"\n",(0,s.jsx)(e.p,{children:"Series \u662f\u5e26\u6807\u7b7e\u7684\u4e00\u7ef4\u6570\u7ec4\uff0c\u53ef\u4ee5\u5b58\u50a8\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\nimport numpy as np\n\n# \u4ece\u5217\u8868\u521b\u5efa\ns = pd.Series([1, 2, 3, 4])\nprint(s)\n# 0    1\n# 1    2\n# 2    3\n# 3    4\n# dtype: int64\n\n# \u6307\u5b9a\u7d22\u5f15\ns = pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])\nprint(s)\n# a    1\n# b    2\n# c    3\n# d    4\n# dtype: int64\n\n# \u4ece\u5b57\u5178\u521b\u5efa\ndata = {'Japan': 'Tokyo', 'Korea': 'Seoul', 'China': 'Beijing'}\ns = pd.Series(data)\nprint(s)\n# Japan     Tokyo\n# Korea     Seoul\n# China   Beijing\n# dtype: object\n\n# \u4ece\u6807\u91cf\u521b\u5efa\ns = pd.Series(5, index=['a', 'b', 'c'])\nprint(s)\n# a    5\n# b    5\n# c    5\n# dtype: int64\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Series \u7684\u5c5e\u6027\uff1a"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ns = pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])\n\n# \u67e5\u770b\u503c\nprint(s.values)  # [1 2 3 4]\n\n# \u67e5\u770b\u7d22\u5f15\nprint(s.index)   # Index(['a', 'b', 'c', 'd'], dtype='object')\n\n# \u67e5\u770b\u5f62\u72b6\nprint(s.shape)   # (4,)\n\n# \u67e5\u770b\u5927\u5c0f\nprint(s.size)    # 4\n\n# \u67e5\u770b\u6570\u636e\u7c7b\u578b\nprint(s.dtype)   # int64\n\n# \u8bbe\u7f6e\u540d\u79f0\ns.name = \"Numbers\"\ns.index.name = \"Letters\"\nprint(s)\n# Letters\n# a    1\n# b    2\n# c    3\n# d    4\n# Name: Numbers, dtype: int64\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Series \u7684\u7d22\u5f15\uff1a"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ns = pd.Series([10, 20, 30, 40], index=['a', 'b', 'c', 'd'])\n\n# \u901a\u8fc7\u6807\u7b7e\u7d22\u5f15\nprint(s['a'])      # 10\nprint(s[['a', 'c']])  # \u591a\u4e2a\u6807\u7b7e\n\n# \u901a\u8fc7\u4f4d\u7f6e\u7d22\u5f15\nprint(s[0])        # 10\nprint(s[[0, 2]])   # \u591a\u4e2a\u4f4d\u7f6e\n\n# \u5207\u7247\nprint(s['a':'c'])  # \u6807\u7b7e\u5207\u7247\uff08\u5305\u542b\u7ec8\u70b9\uff01\uff09\nprint(s[0:2])      # \u4f4d\u7f6e\u5207\u7247\uff08\u4e0d\u5305\u542b\u7ec8\u70b9\uff09\n\n# \u5e03\u5c14\u7d22\u5f15\nprint(s[s > 20])\n# c    30\n# d    40\n\n# \u6761\u4ef6\u7b5b\u9009\nprint(s[(s > 15) & (s < 35)])\n# b    20\n# c    30\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"warning",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u6807\u7b7e\u5207\u7247 vs \u4f4d\u7f6e\u5207\u7247\uff1a"})}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"s = pd.Series([10, 20, 30], index=['a', 'b', 'c'])\n\ns['a':'c']  # \u5305\u542b 'c'\uff0c\u7ed3\u679c\uff1aa=10, b=20, c=30\ns[0:2]      # \u4e0d\u5305\u542b\u7d22\u5f152\uff0c\u7ed3\u679c\uff1aa=10, b=20\n"})})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Series \u7684\u8fd0\u7b97\uff1a"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ns = pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])\n\n# \u5411\u91cf\u5316\u8fd0\u7b97\nprint(s + 10)       # \u6bcf\u4e2a\u5143\u7d20\u52a010\nprint(s * 2)        # \u6bcf\u4e2a\u5143\u7d20\u4e582\nprint(s ** 2)       # \u6bcf\u4e2a\u5143\u7d20\u5e73\u65b9\n\n# Series \u4e4b\u95f4\u7684\u8fd0\u7b97\ns1 = pd.Series([1, 2, 3], index=['a', 'b', 'c'])\ns2 = pd.Series([4, 5, 6], index=['b', 'c', 'd'])\nprint(s1 + s2)\n# a    NaN  # \u53ea\u5728 s1 \u4e2d\n# b    6.0  # 2 + 4\n# c    8.0  # 3 + 5\n# d    NaN  # \u53ea\u5728 s2 \u4e2d\n\n# \u901a\u7528\u51fd\u6570\nprint(np.sqrt(s))   # \u5e73\u65b9\u6839\nprint(np.exp(s))    # \u6307\u6570\n\n# \u7edf\u8ba1\u51fd\u6570\nprint(s.sum())      # 10\nprint(s.mean())     # 2.5\nprint(s.max())      # 4\nprint(s.min())      # 1\nprint(s.std())      # \u6807\u51c6\u5dee\nprint(s.describe()) # \u7edf\u8ba1\u63cf\u8ff0\n"})}),"\n",(0,s.jsx)(e.h3,{id:"dataframe",children:"DataFrame"}),"\n",(0,s.jsx)(e.p,{children:"DataFrame \u662f\u4e8c\u7ef4\u8868\u683c\u6570\u636e\u7ed3\u6784\uff0c\u6709\u884c\u7d22\u5f15\u548c\u5217\u7d22\u5f15\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\n# \u4ece\u5b57\u5178\u521b\u5efa\uff08\u63a8\u8350\uff09\ndata = {\n    'name': ['Alice', 'Bob', 'Charlie'],\n    'age': [25, 30, 35],\n    'city': ['Beijing', 'Shanghai', 'Guangzhou']\n}\ndf = pd.DataFrame(data)\nprint(df)\n#       name  age       city\n# 0    Alice   25    Beijing\n# 1      Bob   30   Shanghai\n# 2  Charlie   35  Guangzhou\n\n# \u6307\u5b9a\u7d22\u5f15\ndf = pd.DataFrame(data, index=['row1', 'row2', 'row3'])\nprint(df)\n\n# \u6307\u5b9a\u5217\u987a\u5e8f\ndf = pd.DataFrame(data, columns=['city', 'name', 'age'])\nprint(df)\n\n# \u4ece\u5217\u8868\u7684\u5217\u8868\u521b\u5efa\ndata = [\n    ['Alice', 25, 'Beijing'],\n    ['Bob', 30, 'Shanghai'],\n    ['Charlie', 35, 'Guangzhou']\n]\ndf = pd.DataFrame(data, columns=['name', 'age', 'city'])\nprint(df)\n\n# \u4ece NumPy \u6570\u7ec4\u521b\u5efa\ndata = np.array([['Japan', 'Tokyo', 4000],\n                 ['Korea', 'Seoul', 1300],\n                 ['China', 'Beijing', 9100]])\ndf = pd.DataFrame(data, columns=['nation', 'capital', 'GDP'])\nprint(df)\n\n# \u4ece Series \u5b57\u5178\u521b\u5efa\ns1 = pd.Series([1, 2, 3])\ns2 = pd.Series([4, 5, 6])\ndf = pd.DataFrame({'col1': s1, 'col2': s2})\nprint(df)\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"DataFrame \u7684\u5c5e\u6027\uff1a"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ndf = pd.DataFrame({\n    'A': [1, 2, 3],\n    'B': [4, 5, 6],\n    'C': [7, 8, 9]\n})\n\n# \u67e5\u770b\u5f62\u72b6\nprint(df.shape)      # (3, 3) - 3\u884c3\u5217\n\n# \u67e5\u770b\u5927\u5c0f\nprint(df.size)       # 9 - \u603b\u5143\u7d20\u6570\n\n# \u67e5\u770b\u7ef4\u5ea6\nprint(df.ndim)       # 2\n\n# \u67e5\u770b\u5217\u540d\nprint(df.columns)    # Index(['A', 'B', 'C'], dtype='object')\n\n# \u67e5\u770b\u884c\u7d22\u5f15\nprint(df.index)      # RangeIndex(start=0, stop=3, step=1)\n\n# \u67e5\u770b\u6570\u636e\u7c7b\u578b\nprint(df.dtypes)\n# A    int64\n# B    int64\n# C    int64\n\n# \u67e5\u770b\u503c\uff08NumPy \u6570\u7ec4\uff09\nprint(df.values)\n# [[1 4 7]\n#  [2 5 8]\n#  [3 6 9]]\n\n# \u67e5\u770b\u4fe1\u606f\nprint(df.info())\n# <class 'pandas.core.frame.DataFrame'>\n# RangeIndex: 3 entries, 0 to 2\n# Data columns (total 3 columns):\n#  #   Column  Non-Null Count  Dtype\n# ---  ------  --------------  -----\n#  0   A       3 non-null      int64\n#  1   B       3 non-null      int64\n#  2   C       3 non-null      int64\n\n# \u7edf\u8ba1\u63cf\u8ff0\nprint(df.describe())\n#               A         B         C\n# count  3.000000  3.000000  3.000000\n# mean   2.000000  5.000000  8.000000\n# std    1.000000  1.000000  1.000000\n# min    1.000000  4.000000  7.000000\n# 25%    1.500000  4.500000  7.500000\n# 50%    2.000000  5.000000  8.000000\n# 75%    2.500000  5.500000  8.500000\n# max    3.000000  6.000000  9.000000\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u67e5\u770b\u6570\u636e\uff1a"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ndf = pd.DataFrame({\n    'A': range(10),\n    'B': range(10, 20),\n    'C': range(20, 30)\n})\n\n# \u67e5\u770b\u524d\u51e0\u884c\nprint(df.head())     # \u9ed8\u8ba4\u524d5\u884c\nprint(df.head(3))    # \u524d3\u884c\n\n# \u67e5\u770b\u540e\u51e0\u884c\nprint(df.tail())     # \u9ed8\u8ba4\u540e5\u884c\nprint(df.tail(3))    # \u540e3\u884c\n\n# \u968f\u673a\u62bd\u6837\nprint(df.sample(3))  # \u968f\u673a3\u884c\nprint(df.sample(frac=0.5))  # \u968f\u673a50%\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u6570\u636e\u521d\u63a2\u5fc5\u5907\u4e09\u4ef6\u5957\uff1a"})}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"df.head()        # \u770b\u524d\u51e0\u884c\uff0c\u4e86\u89e3\u6570\u636e\u7ed3\u6784\ndf.info()        # \u770b\u5217\u4fe1\u606f\u3001\u7c7b\u578b\u3001\u7f3a\u5931\u503c\ndf.describe()    # \u770b\u7edf\u8ba1\u6458\u8981\n"})})]}),"\n",(0,s.jsx)(e.h3,{id:"index",children:"Index"}),"\n",(0,s.jsx)(e.p,{children:"Index \u662f Pandas \u7684\u884c\u7d22\u5f15\u6216\u5217\u7d22\u5f15\u5bf9\u8c61\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\n# \u521b\u5efa\u666e\u901a\u7d22\u5f15\nindex = pd.Index(['a', 'b', 'c', 'd'])\nprint(index)\n# Index(['a', 'b', 'c', 'd'], dtype='object')\n\n# \u6570\u503c\u7d22\u5f15\nindex = pd.Index([1, 2, 3, 4])\nprint(index)\n# Index([1, 2, 3, 4], dtype='int64')\n\n# Index \u662f\u4e0d\u53ef\u53d8\u7684\n# index[0] = 'x'  # TypeError\n\n# Index \u64cd\u4f5c\nindex1 = pd.Index(['A', 'B', 'C'])\nindex2 = pd.Index(['C', 'D', 'E'])\n\nprint(index1.union(index2))        # \u5e76\u96c6\nprint(index1.intersection(index2)) # \u4ea4\u96c6\nprint(index1.difference(index2))   # \u5dee\u96c6\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"MultiIndex\uff08\u591a\u91cd\u7d22\u5f15\uff09\uff1a"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\n# \u4ece\u5143\u7ec4\u5217\u8868\u521b\u5efa\nindex = pd.MultiIndex.from_tuples([\n    ('A', 1), ('A', 2), ('B', 1), ('B', 2)\n])\nprint(index)\n\n# \u4ece\u6570\u7ec4\u521b\u5efa\narrays = [\n    ['A', 'A', 'B', 'B'],\n    [1, 2, 1, 2]\n]\nindex = pd.MultiIndex.from_arrays(arrays, names=['letter', 'number'])\nprint(index)\n\n# \u5728 DataFrame \u4e2d\u4f7f\u7528\ndf = pd.DataFrame({\n    'value': [10, 20, 30, 40]\n}, index=index)\nprint(df)\n#                value\n# letter number       \n# A      1         10\n#        2         20\n# B      1         30\n#        2         40\n\n# \u8bbf\u95ee\u591a\u91cd\u7d22\u5f15\nprint(df.loc['A'])\n#        value\n# number      \n# 1         10\n# 2         20\n\nprint(df.loc[('A', 1)])\n# value    10\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"DatetimeIndex\uff08\u65f6\u95f4\u7d22\u5f15\uff09\uff1a"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\n# \u4ece\u65e5\u671f\u5b57\u7b26\u4e32\u521b\u5efa\ndates = pd.to_datetime(['2021-01-01', '2021-01-02', '2021-01-03'])\nprint(dates)\n# DatetimeIndex(['2021-01-01', '2021-01-02', '2021-01-03'])\n\n# \u751f\u6210\u65e5\u671f\u8303\u56f4\ndates = pd.date_range('2021-01-01', periods=10, freq='D')\nprint(dates)\n# DatetimeIndex(['2021-01-01', '2021-01-02', ..., '2021-01-10'])\n\n# \u4e0d\u540c\u9891\u7387\ndates_monthly = pd.date_range('2021-01', periods=12, freq='M')\ndates_hourly = pd.date_range('2021-01-01', periods=24, freq='H')\ndates_business = pd.date_range('2021-01-01', periods=10, freq='B')  # \u5de5\u4f5c\u65e5\n\n# \u5728 DataFrame \u4e2d\u4f7f\u7528\ndf = pd.DataFrame({\n    'value': range(10)\n}, index=dates)\nprint(df.head())\n\n# \u65f6\u95f4\u7d22\u5f15\u7684\u4f18\u52bf\nprint(df['2021-01-01'])     # \u6309\u65e5\u671f\u9009\u62e9\nprint(df['2021-01-01':'2021-01-03'])  # \u65e5\u671f\u8303\u56f4\nprint(df['2021-01'])        # \u6309\u6708\u9009\u62e9\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u65f6\u95f4\u9891\u7387\u4ee3\u7801\uff1a"})}),(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"D"}),"\uff1a\u65e5"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"W"}),"\uff1a\u5468"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"M"}),"\uff1a\u6708\u672b"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"MS"}),"\uff1a\u6708\u521d"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"Q"}),"\uff1a\u5b63\u5ea6\u672b"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"Y"}),"\uff1a\u5e74\u672b"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"H"}),"\uff1a\u5c0f\u65f6"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"T"})," \u6216 ",(0,s.jsx)(e.code,{children:"min"}),"\uff1a\u5206\u949f"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"S"}),"\uff1a\u79d2"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"B"}),"\uff1a\u5de5\u4f5c\u65e5"]}),"\n"]})]}),"\n",(0,s.jsx)(e.h2,{id:"\u6570\u636eio",children:"\u6570\u636eIO"}),"\n",(0,s.jsx)(e.p,{children:"Pandas \u652f\u6301\u591a\u79cd\u6570\u636e\u683c\u5f0f\u7684\u8bfb\u5199\uff0c\u8ba9\u6570\u636e\u4ea4\u6362\u53d8\u5f97\u975e\u5e38\u4fbf\u6377\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"csvexcel-\u6587\u4ef6",children:"CSV/Excel \u6587\u4ef6"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\n# \u521b\u5efa\u793a\u4f8b\u6570\u636e\ndata = [['Google', 10], ['Runoob', 12], ['Wiki', 13]]\ndf = pd.DataFrame(data, columns=['Site', 'Age'], dtype=float)\n\n# CSV \u6587\u4ef6\u8bfb\u5199\ndf.to_csv('file1.csv', index=False)     # \u5199\u5165 CSV\ndf = pd.read_csv('file1.csv')           # \u8bfb\u53d6 CSV\n\n# Excel \u6587\u4ef6\u8bfb\u5199\uff08.xlsx \u683c\u5f0f\uff09\ndf.to_excel('file1.xlsx', index=False)  # \u5199\u5165 Excel\ndf = pd.read_excel('file1.xlsx')        # \u8bfb\u53d6 Excel\n\n# Excel \u6587\u4ef6\u8bfb\u5199\uff08.xls \u683c\u5f0f\uff09\ndf.to_excel('file1.xls', index=False)\ndf = pd.read_excel('file1.xls')\n\nprint(df)\n#     Site   Age\n# 0  Google  10.0\n# 1  Runoob  12.0\n# 2    Wiki  13.0\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u5e38\u7528\u53c2\u6570\uff1a"})}),(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"index=False"}),"\uff1a\u4e0d\u4fdd\u5b58\u884c\u7d22\u5f15"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"header=None"}),"\uff1a\u6ca1\u6709\u5217\u540d\u65f6\u4f7f\u7528"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"encoding='utf-8'"}),"\uff1a\u6307\u5b9a\u7f16\u7801\u683c\u5f0f"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"sep=','"}),"\uff1a\u6307\u5b9a\u5206\u9694\u7b26\uff08CSV\uff09"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"sheet_name='Sheet1'"}),"\uff1a\u6307\u5b9a Excel \u5de5\u4f5c\u8868"]}),"\n"]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \u8bfb\u53d6 CSV \u65f6\u7684\u5e38\u7528\u53c2\u6570\ndf = pd.read_csv('data.csv', \n                 encoding='utf-8',    # \u7f16\u7801\n                 sep=',',             # \u5206\u9694\u7b26\n                 header=0,            # \u7b2c\u4e00\u884c\u4e3a\u5217\u540d\n                 index_col=0,         # \u7b2c\u4e00\u5217\u4e3a\u7d22\u5f15\n                 na_values=['NA', 'null'],  # \u7f3a\u5931\u503c\u6807\u8bb0\n                 skiprows=1,          # \u8df3\u8fc7\u7b2c\u4e00\u884c\n                 nrows=100)           # \u53ea\u8bfb100\u884c\n\n# \u8bfb\u53d6 Excel \u65f6\u7684\u5e38\u7528\u53c2\u6570\ndf = pd.read_excel('data.xlsx',\n                   sheet_name='Sheet1',  # \u5de5\u4f5c\u8868\u540d\n                   header=0,             # \u7b2c\u4e00\u884c\u4e3a\u5217\u540d\n                   usecols='A:C')        # \u53ea\u8bfbA\u5230C\u5217\n"})})]}),"\n",(0,s.jsx)(e.h3,{id:"json-\u6587\u4ef6",children:"JSON \u6587\u4ef6"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'import pandas as pd\n\n# \u51c6\u5907 JSON \u6570\u636e\ndata = [\n    {\n        "id": "A001",\n        "name": "\u83dc\u9e1f\u6559\u7a0b",\n        "url": "www.runoob.com",\n        "likes": 61\n    },\n    {\n        "id": "A002",\n        "name": "Google",\n        "url": "www.google.com",\n        "likes": 124\n    },\n    {\n        "id": "A003",\n        "name": "\u6dd8\u5b9d",\n        "url": "www.taobao.com",\n        "likes": 45\n    }\n]\n\n# \u521b\u5efa DataFrame\ndf = pd.DataFrame(data)\n\n# JSON \u6587\u4ef6\u8bfb\u5199\ndf.to_json(\'sites.json\')         # \u5199\u5165 JSON\ndf = pd.read_json(\'sites.json\')  # \u8bfb\u53d6 JSON\n\nprint(df.to_string())\n#      id    name             url  likes\n# 0  A001    \u83dc\u9e1f\u6559\u7a0b  www.runoob.com     61\n# 1  A002  Google  www.google.com    124\n# 2  A003      \u6dd8\u5b9d  www.taobao.com     45\n'})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"JSON \u683c\u5f0f\u9009\u9879\uff1a"})}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \u4e0d\u540c\u7684 JSON \u65b9\u5411\uff08orient \u53c2\u6570\uff09\ndf.to_json('data.json', orient='records')  # \u8bb0\u5f55\u5217\u8868\u683c\u5f0f\ndf.to_json('data.json', orient='index')    # \u4ee5\u7d22\u5f15\u4e3a\u952e\ndf.to_json('data.json', orient='columns')  # \u4ee5\u5217\u540d\u4e3a\u952e\uff08\u9ed8\u8ba4\uff09\ndf.to_json('data.json', orient='values')   # \u53ea\u4fdd\u5b58\u503c\n"})})]}),"\n",(0,s.jsx)(e.h3,{id:"sql-\u6570\u636e\u5e93",children:"SQL \u6570\u636e\u5e93"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"from sqlalchemy import create_engine, text\nimport pandas as pd\n\n# \u6570\u636e\u5e93\u8fde\u63a5\u914d\u7f6e\nMYSQL_HOST = 'localhost'\nMYSQL_PORT = 3306\nMYSQL_USER = 'employee_u'\nMYSQL_PASSWORD = 'employee_s'\nMYSQL_DB = 'employee'\n\n# \u521b\u5efa\u6570\u636e\u5e93\u5f15\u64ce\nengine = create_engine(\n    f'mysql+pymysql://{MYSQL_USER}:{MYSQL_PASSWORD}@{MYSQL_HOST}:{MYSQL_PORT}/{MYSQL_DB}',\n    echo=False\n)\n\n# \u51c6\u5907\u6570\u636e\ndataset = pd.DataFrame({\n    'Names': ['Abhinav', 'Aryan', 'Manthan'],\n    'DOB': ['10/01/2009', '24/03/2009', '28/02/2009']\n})\n\n# \u5199\u5165\u6570\u636e\u5e93\ndataset.to_sql('Employee_Data', con=engine, index=False, if_exists='replace')\n\n# \u8bfb\u53d6\u6570\u636e\u7684\u591a\u79cd\u65b9\u5f0f\nwith engine.connect() as conn:\n    # \u65b9\u5f0f1\uff1a\u8bfb\u53d6\u6574\u4e2a\u8868\n    df1 = pd.read_sql('Employee_Data', con=conn)\n    \n    # \u65b9\u5f0f2\uff1a\u4f7f\u7528 SQL \u67e5\u8be2\n    df2 = pd.read_sql_query(text(\"SELECT * FROM Employee_Data\"), con=conn)\n    \n    # \u65b9\u5f0f3\uff1a\u8bfb\u53d6\u8868\uff08\u4e13\u7528\u65b9\u6cd5\uff09\n    df3 = pd.read_sql_table(\"Employee_Data\", conn)\n\nprint(df2)\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"if_exists \u53c2\u6570\u63a7\u5236\u8868\u5b58\u5728\u65f6\u7684\u884c\u4e3a\uff1a"})}),(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"'fail'"}),"\uff1a\u5982\u679c\u8868\u5b58\u5728\uff0c\u62a5\u9519\uff08\u9ed8\u8ba4\uff09"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"'replace'"}),"\uff1a\u5220\u9664\u539f\u8868\uff0c\u521b\u5efa\u65b0\u8868"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"'append'"}),"\uff1a\u5728\u73b0\u6709\u8868\u4e2d\u8ffd\u52a0\u6570\u636e"]}),"\n"]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \u66ff\u6362\u8868\ndf.to_sql('table_name', con=engine, if_exists='replace')\n\n# \u8ffd\u52a0\u6570\u636e\ndf.to_sql('table_name', con=engine, if_exists='append')\n\n# \u5206\u6279\u5199\u5165\u5927\u91cf\u6570\u636e\ndf.to_sql('table_name', con=engine, chunksize=1000)\n"})})]}),"\n",(0,s.jsxs)(e.admonition,{type:"warning",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u6570\u636e\u5e93\u64cd\u4f5c\u6ce8\u610f\u4e8b\u9879\uff1a"})}),(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\u786e\u4fdd\u5b89\u88c5\u4e86\u76f8\u5e94\u7684\u6570\u636e\u5e93\u9a71\u52a8\uff08\u5982 ",(0,s.jsx)(e.code,{children:"pymysql"}),"\u3001",(0,s.jsx)(e.code,{children:"psycopg2"}),"\uff09"]}),"\n",(0,s.jsxs)(e.li,{children:["\u5927\u91cf\u6570\u636e\u5199\u5165\u65f6\uff0c\u8003\u8651\u4f7f\u7528 ",(0,s.jsx)(e.code,{children:"chunksize"})," \u53c2\u6570\u5206\u6279\u5199\u5165"]}),"\n",(0,s.jsx)(e.li,{children:"\u4f7f\u7528\u53c2\u6570\u5316\u67e5\u8be2\u9632\u6b62 SQL \u6ce8\u5165"}),"\n",(0,s.jsx)(e.li,{children:"\u8bb0\u5f97\u5173\u95ed\u6570\u636e\u5e93\u8fde\u63a5\u91ca\u653e\u8d44\u6e90"}),"\n"]})]}),"\n",(0,s.jsx)(e.h2,{id:"\u6570\u636e\u9009\u62e9",children:"\u6570\u636e\u9009\u62e9"}),"\n",(0,s.jsx)(e.p,{children:"Pandas \u63d0\u4f9b\u4e86\u591a\u79cd\u65b9\u5f0f\u6765\u9009\u62e9\u548c\u7b5b\u9009\u6570\u636e\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"\u57fa\u672c\u9009\u62e9",children:"\u57fa\u672c\u9009\u62e9"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ndf = pd.DataFrame({\n    'A': [1, 2, 3, 4],\n    'B': [5, 6, 7, 8],\n    'C': [9, 10, 11, 12]\n}, index=['row1', 'row2', 'row3', 'row4'])\n\nprint(df)\n#       A  B   C\n# row1  1  5   9\n# row2  2  6  10\n# row3  3  7  11\n# row4  4  8  12\n\n# \u9009\u62e9\u5217\nprint(df['A'])          # \u5355\u5217\uff0c\u8fd4\u56de Series\nprint(df[['A', 'C']])   # \u591a\u5217\uff0c\u8fd4\u56de DataFrame\n\n# \u9009\u62e9\u884c\uff08\u5207\u7247\uff09\nprint(df[0:2])          # \u524d\u4e24\u884c\nprint(df['row1':'row3']) # \u6807\u7b7e\u5207\u7247\uff08\u5305\u542b\u7ec8\u70b9\uff09\n\n# \u5217\u64cd\u4f5c\ndf['D'] = df['A'] + df['B']  # \u65b0\u589e\u5217\ndf['E'] = 100                 # \u5e38\u91cf\u5217\ndel df['E']                   # \u5220\u9664\u5217\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u5217\u9009\u62e9\u7684\u4e24\u79cd\u65b9\u5f0f\uff1a"})}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"df['A']      # \u63a8\u8350\uff1a\u603b\u662f\u6709\u6548\uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26\ndf.A         # \u4fbf\u6377\uff1a\u4f46\u5217\u540d\u4e0d\u80fd\u4e0e\u65b9\u6cd5\u91cd\u540d\n\n# \u4f8b\u5982\uff1a\ndf.count     # \u8fd9\u662f\u65b9\u6cd5\uff0c\u4e0d\u662f\u5217\ndf['count']  # \u8fd9\u624d\u662f\u9009\u62e9\u540d\u4e3a'count'\u7684\u5217\n"})})]}),"\n",(0,s.jsx)(e.h3,{id:"loc-\u548c-iloc",children:"loc \u548c iloc"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ndf = pd.DataFrame({\n    'A': [1, 2, 3, 4],\n    'B': [5, 6, 7, 8],\n    'C': [9, 10, 11, 12]\n}, index=['row1', 'row2', 'row3', 'row4'])\n\n# loc\uff1a\u57fa\u4e8e\u6807\u7b7e\u7684\u7d22\u5f15\nprint(df.loc['row1'])           # \u5355\u884c\nprint(df.loc[['row1', 'row3']]) # \u591a\u884c\nprint(df.loc['row1', 'A'])      # \u5355\u4e2a\u5143\u7d20\nprint(df.loc['row1':'row3', 'A':'B'])  # \u884c\u5217\u5207\u7247\n\n# iloc\uff1a\u57fa\u4e8e\u4f4d\u7f6e\u7684\u7d22\u5f15\nprint(df.iloc[0])         # \u7b2c\u4e00\u884c\nprint(df.iloc[[0, 2]])    # \u7b2c1\u548c\u7b2c3\u884c\nprint(df.iloc[0, 1])      # \u7b2c1\u884c\u7b2c2\u5217\nprint(df.iloc[0:2, 0:2])  # \u884c\u5217\u4f4d\u7f6e\u5207\u7247\n\n# \u5e03\u5c14\u7d22\u5f15\nprint(df.loc[df['A'] > 2])         # \u7b5b\u9009\u884c\nprint(df.loc[df['A'] > 2, ['A', 'C']])  # \u7b5b\u9009\u884c\u548c\u5217\n\n# \u8d4b\u503c\ndf.loc['row1', 'A'] = 100\ndf.iloc[0, 0] = 200\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"loc vs iloc vs []\uff1a"})}),(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u65b9\u5f0f"}),(0,s.jsx)(e.th,{children:"\u7d22\u5f15\u7c7b\u578b"}),(0,s.jsx)(e.th,{children:"\u5207\u7247\u884c\u4e3a"}),(0,s.jsx)(e.th,{children:"\u7528\u9014"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"[]"})}),(0,s.jsx)(e.td,{children:"\u5217\u540d/\u884c\u4f4d\u7f6e"}),(0,s.jsx)(e.td,{children:"\u4e0d\u5305\u542b\u7ec8\u70b9"}),(0,s.jsx)(e.td,{children:"\u7b80\u5355\u5217\u9009\u62e9\u3001\u884c\u5207\u7247"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:".loc[]"})}),(0,s.jsx)(e.td,{children:"\u6807\u7b7e"}),(0,s.jsx)(e.td,{children:"\u5305\u542b\u7ec8\u70b9"}),(0,s.jsx)(e.td,{children:"\u7075\u6d3b\u7684\u6807\u7b7e\u7d22\u5f15"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:".iloc[]"})}),(0,s.jsx)(e.td,{children:"\u4f4d\u7f6e"}),(0,s.jsx)(e.td,{children:"\u4e0d\u5305\u542b\u7ec8\u70b9"}),(0,s.jsx)(e.td,{children:"\u4f4d\u7f6e\u7d22\u5f15"})]})]})]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \u9009\u62e9\u5217\ndf['A']           # \u7b80\u5355\ndf.loc[:, 'A']    # \u660e\u786e\n\n# \u9009\u62e9\u884c\ndf[0:2]           # \u4f4d\u7f6e\u5207\u7247\ndf.loc['a':'c']   # \u6807\u7b7e\u5207\u7247\ndf.iloc[0:2]      # \u4f4d\u7f6e\u5207\u7247\n\n# \u884c\u5217\u7ec4\u5408\ndf.loc['a', 'A']  # \u6807\u7b7e\ndf.iloc[0, 0]     # \u4f4d\u7f6e\n"})})]}),"\n",(0,s.jsx)(e.h3,{id:"\u6761\u4ef6\u7b5b\u9009",children:"\u6761\u4ef6\u7b5b\u9009"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ndf = pd.DataFrame({\n    'name': ['Alice', 'Bob', 'Charlie', 'David'],\n    'age': [25, 30, 35, 28],\n    'city': ['Beijing', 'Shanghai', 'Beijing', 'Guangzhou'],\n    'salary': [5000, 6000, 7000, 5500]\n})\n\n# \u5355\u6761\u4ef6\u7b5b\u9009\nprint(df[df['age'] > 28])\n\n# \u591a\u6761\u4ef6\u7b5b\u9009\uff08\u4e0e\uff09\nprint(df[(df['age'] > 25) & (df['salary'] > 5500)])\n\n# \u591a\u6761\u4ef6\u7b5b\u9009\uff08\u6216\uff09\nprint(df[(df['city'] == 'Beijing') | (df['salary'] > 6000)])\n\n# \u4f7f\u7528 isin\nprint(df[df['city'].isin(['Beijing', 'Shanghai'])])\n\n# \u5b57\u7b26\u4e32\u5305\u542b\nprint(df[df['name'].str.contains('a')])\n\n# \u4f7f\u7528 query \u65b9\u6cd5\uff08\u66f4\u6613\u8bfb\uff09\nprint(df.query('age > 28 and salary > 5500'))\nprint(df.query('city == \"Beijing\" or salary > 6000'))\n\n# \u7b5b\u9009\u540e\u9009\u62e9\u5217\nprint(df.loc[df['age'] > 28, ['name', 'city']])\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u6761\u4ef6\u7b5b\u9009\u6280\u5de7\uff1a"})}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \u4f7f\u7528 & | ~ \u800c\u4e0d\u662f and or not\ndf[(df['age'] > 25) & (df['salary'] > 5000)]  # \u6b63\u786e\n# df[(df['age'] > 25) and (df['salary'] > 5000)]  # \u9519\u8bef\n\n# \u6761\u4ef6\u9700\u8981\u52a0\u62ec\u53f7\ndf[(df['age'] > 25) & (df['salary'] > 5000)]  # \u6b63\u786e\n# df[df['age'] > 25 & df['salary'] > 5000]  # \u9519\u8bef\n\n# query \u65b9\u6cd5\u66f4\u6e05\u6670\ndf.query('age > 25 and salary > 5000')  # \u53ef\u4ee5\u7528 and/or\n"})})]}),"\n",(0,s.jsx)(e.h2,{id:"\u6570\u636e\u6e05\u6d17",children:"\u6570\u636e\u6e05\u6d17"}),"\n",(0,s.jsx)(e.h3,{id:"\u7f3a\u5931\u503c\u5904\u7406",children:"\u7f3a\u5931\u503c\u5904\u7406"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\nimport numpy as np\n\ndf = pd.DataFrame({\n    'A': [1, 2, np.nan, 4],\n    'B': [5, np.nan, np.nan, 8],\n    'C': [9, 10, 11, 12]\n})\n\nprint(df)\n#      A    B   C\n# 0  1.0  5.0   9\n# 1  2.0  NaN  10\n# 2  NaN  NaN  11\n# 3  4.0  8.0  12\n\n# \u68c0\u6d4b\u7f3a\u5931\u503c\nprint(df.isna())        # \u6216 df.isnull()\nprint(df.isna().sum())  # \u6bcf\u5217\u7f3a\u5931\u503c\u6570\u91cf\n\n# \u68c0\u6d4b\u975e\u7f3a\u5931\u503c\nprint(df.notna())       # \u6216 df.notnull()\n\n# \u5220\u9664\u7f3a\u5931\u503c\nprint(df.dropna())              # \u5220\u9664\u542b\u6709\u7f3a\u5931\u503c\u7684\u884c\nprint(df.dropna(axis=1))        # \u5220\u9664\u542b\u6709\u7f3a\u5931\u503c\u7684\u5217\nprint(df.dropna(how='all'))     # \u5220\u9664\u5168\u4e3a\u7f3a\u5931\u503c\u7684\u884c\nprint(df.dropna(thresh=2))      # \u4fdd\u7559\u81f3\u5c11\u67092\u4e2a\u975e\u7f3a\u5931\u503c\u7684\u884c\n\n# \u586b\u5145\u7f3a\u5931\u503c\nprint(df.fillna(0))             # \u586b\u5145\u4e3a0\nprint(df.fillna({'A': 0, 'B': 99}))  # \u4e0d\u540c\u5217\u586b\u5145\u4e0d\u540c\u503c\nprint(df.fillna(method='ffill'))  # \u524d\u5411\u586b\u5145\nprint(df.fillna(method='bfill'))  # \u540e\u5411\u586b\u5145\nprint(df.fillna(df.mean()))     # \u7528\u5747\u503c\u586b\u5145\n\n# \u63d2\u503c\nprint(df.interpolate())         # \u7ebf\u6027\u63d2\u503c\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u7f3a\u5931\u503c\u5904\u7406\u7b56\u7565\uff1a"})}),(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u5220\u9664\uff1a"})}),(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u7f3a\u5931\u6bd4\u4f8b\u5c0f\uff08",(0,s.jsx)(e.code,{children:"<5%"}),"\uff09"]}),"\n",(0,s.jsx)(e.li,{children:"\u7f3a\u5931\u662f\u5b8c\u5168\u968f\u673a\u7684"}),"\n",(0,s.jsx)(e.li,{children:"\u6570\u636e\u91cf\u8db3\u591f\u5927"}),"\n"]}),(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u586b\u5145\uff1a"})}),(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5e38\u6570\uff1a0\u3001-1\u3001\u5747\u503c\u3001\u4e2d\u4f4d\u6570"}),"\n",(0,s.jsx)(e.li,{children:"\u524d\u540e\u503c\uff1affill\u3001bfill"}),"\n",(0,s.jsx)(e.li,{children:"\u63d2\u503c\uff1a\u7ebf\u6027\u3001\u591a\u9879\u5f0f"}),"\n"]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \u7edf\u8ba1\u7f3a\u5931\u503c\nmissing = df.isna().sum()\nmissing_pct = df.isna().sum() / len(df) * 100\nprint(pd.DataFrame({'count': missing, 'percentage': missing_pct}))\n\n# \u53ea\u4fdd\u7559\u5b8c\u6574\u6570\u636e\u7684\u5217\ndf_clean = df.dropna(axis=1)\n\n# \u7ec4\u5408\u7b56\u7565\ndf_filled = df.copy()\ndf_filled['A'].fillna(df_filled['A'].mean(), inplace=True)\ndf_filled['B'].fillna(method='ffill', inplace=True)\n"})})]}),"\n",(0,s.jsx)(e.h3,{id:"\u91cd\u590d\u503c\u5904\u7406",children:"\u91cd\u590d\u503c\u5904\u7406"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ndf = pd.DataFrame({\n    'A': [1, 1, 2, 3, 3],\n    'B': [5, 5, 6, 7, 7],\n    'C': [9, 9, 10, 11, 11]\n})\n\nprint(df)\n#    A  B   C\n# 0  1  5   9\n# 1  1  5   9\n# 2  2  6  10\n# 3  3  7  11\n# 4  3  7  11\n\n# \u68c0\u6d4b\u91cd\u590d\u884c\nprint(df.duplicated())\n# 0    False\n# 1     True\n# 2    False\n# 3    False\n# 4     True\n\n# \u7edf\u8ba1\u91cd\u590d\nprint(df.duplicated().sum())  # 2\n\n# \u5220\u9664\u91cd\u590d\u884c\nprint(df.drop_duplicates())   # \u4fdd\u7559\u7b2c\u4e00\u6b21\u51fa\u73b0\nprint(df.drop_duplicates(keep='last'))  # \u4fdd\u7559\u6700\u540e\u4e00\u6b21\u51fa\u73b0\nprint(df.drop_duplicates(keep=False))   # \u5220\u9664\u6240\u6709\u91cd\u590d\n\n# \u57fa\u4e8e\u7279\u5b9a\u5217\u53bb\u91cd\nprint(df.drop_duplicates(subset=['A']))\nprint(df.drop_duplicates(subset=['A', 'B']))\n\n# \u539f\u5730\u4fee\u6539\ndf.drop_duplicates(inplace=True)\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362",children:"\u6570\u636e\u7c7b\u578b\u8f6c\u6362"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ndf = pd.DataFrame({\n    'A': ['1', '2', '3'],\n    'B': [1.0, 2.0, 3.0],\n    'C': ['2021-01-01', '2021-01-02', '2021-01-03']\n})\n\nprint(df.dtypes)\n# A    object\n# B   float64\n# C    object\n\n# \u8f6c\u6362\u5355\u5217\ndf['A'] = df['A'].astype(int)\ndf['B'] = df['B'].astype(int)\ndf['C'] = pd.to_datetime(df['C'])\n\nprint(df.dtypes)\n# A             int64\n# B             int64\n# C    datetime64[ns]\n\n# \u6279\u91cf\u8f6c\u6362\ndf = df.astype({'A': 'int32', 'B': 'float32'})\n\n# \u5c1d\u8bd5\u8f6c\u6362\uff08\u5931\u8d25\u65f6\u4e0d\u62a5\u9519\uff09\ndf['A'] = pd.to_numeric(df['A'], errors='coerce')  # \u8f6c\u6362\u5931\u8d25\u53d8NaN\ndf['A'] = pd.to_numeric(df['A'], errors='ignore')  # \u8f6c\u6362\u5931\u8d25\u4fdd\u6301\u539f\u6837\n\n# \u5206\u7c7b\u7c7b\u578b\uff08\u8282\u7701\u5185\u5b58\uff09\ndf['category'] = pd.Categorical(['A', 'B', 'A', 'C'])\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u5e38\u7528\u7c7b\u578b\u8f6c\u6362\uff1a"})}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \u6570\u503c\u7c7b\u578b\npd.to_numeric(df['col'])          # \u8f6c\u6570\u503c\npd.to_numeric(df['col'], errors='coerce')  # \u5931\u8d25\u53d8NaN\n\n# \u65f6\u95f4\u7c7b\u578b\npd.to_datetime(df['col'])         # \u8f6c\u65e5\u671f\npd.to_datetime(df['col'], format='%Y-%m-%d')  # \u6307\u5b9a\u683c\u5f0f\n\n# \u5b57\u7b26\u4e32\u7c7b\u578b\ndf['col'].astype(str)             # \u8f6c\u5b57\u7b26\u4e32\n\n# \u5206\u7c7b\u7c7b\u578b\uff08\u9002\u5408\u91cd\u590d\u503c\u591a\u7684\u5217\uff09\ndf['col'] = df['col'].astype('category')\n"})})]}),"\n",(0,s.jsx)(e.h2,{id:"\u6570\u636e\u8f6c\u6362",children:"\u6570\u636e\u8f6c\u6362"}),"\n",(0,s.jsx)(e.h3,{id:"applymapapplymap",children:"apply/map/applymap"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\nimport numpy as np\n\ndf = pd.DataFrame({\n    'name': ['alice', 'bob', 'charlie'],\n    'age': [25, 30, 35],\n    'salary': [5000, 6000, 7000]\n})\n\n# map\uff1aSeries \u7ea7\u522b\u7684\u6620\u5c04\ndf['name_upper'] = df['name'].map(str.upper)\ndf['age_group'] = df['age'].map(lambda x: '\u5e74\u8f7b' if x < 30 else '\u6210\u719f')\n\n# \u4f7f\u7528\u5b57\u5178\u6620\u5c04\nname_mapping = {'alice': 'Alice', 'bob': 'Bob', 'charlie': 'Charlie'}\ndf['name_title'] = df['name'].map(name_mapping)\n\nprint(df)\n\n# apply\uff1aDataFrame/Series \u7ea7\u522b\u7684\u5e94\u7528\n# \u5bf9\u5217\u64cd\u4f5c\uff08axis=0\uff0c\u9ed8\u8ba4\uff09\nprint(df[['age', 'salary']].apply(np.mean))\n\n# \u5bf9\u884c\u64cd\u4f5c\uff08axis=1\uff09\ndf['total'] = df.apply(lambda row: row['age'] + row['salary'], axis=1)\n\n# \u8fd4\u56de\u591a\u4e2a\u503c\ndef analyze(series):\n    return pd.Series({\n        'min': series.min(),\n        'max': series.max(),\n        'mean': series.mean()\n    })\n\nprint(df[['age', 'salary']].apply(analyze))\n\n# applymap\uff1aDataFrame \u6240\u6709\u5143\u7d20\u7684\u6620\u5c04\ndf_num = df[['age', 'salary']]\ndf_doubled = df_num.applymap(lambda x: x * 2)\nprint(df_doubled)\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"map vs apply vs applymap\uff1a"})}),(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,s.jsx)(e.th,{children:"\u5e94\u7528\u5bf9\u8c61"}),(0,s.jsx)(e.th,{children:"\u4f5c\u7528"}),(0,s.jsx)(e.th,{children:"\u8fd4\u56de"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"map"})}),(0,s.jsx)(e.td,{children:"Series"}),(0,s.jsx)(e.td,{children:"\u5143\u7d20\u7ea7\u6620\u5c04"}),(0,s.jsx)(e.td,{children:"Series"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"apply"})}),(0,s.jsx)(e.td,{children:"Series/DataFrame"}),(0,s.jsx)(e.td,{children:"\u51fd\u6570\u5e94\u7528"}),(0,s.jsx)(e.td,{children:"Series/DataFrame"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"applymap"})}),(0,s.jsx)(e.td,{children:"DataFrame"}),(0,s.jsx)(e.td,{children:"\u6240\u6709\u5143\u7d20\u6620\u5c04"}),(0,s.jsx)(e.td,{children:"DataFrame"})]})]})]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# map\uff1a\u4e00\u5bf9\u4e00\u6620\u5c04\uff08\u6700\u5feb\uff09\ndf['col'].map({'A': 1, 'B': 2})\ndf['col'].map(lambda x: x * 2)\n\n# apply\uff1a\u7075\u6d3b\u51fd\u6570\u5e94\u7528\ndf['col'].apply(complex_function)\ndf.apply(lambda row: row['A'] + row['B'], axis=1)\n\n# applymap\uff1a\u6240\u6709\u5143\u7d20\uff08\u5df2\u5f03\u7528\uff0c\u5efa\u8bae\u7528map\uff09\ndf.applymap(lambda x: x * 2)\ndf.map(lambda x: x * 2)  # \u65b0\u7248\u63a8\u8350\n"})})]}),"\n",(0,s.jsx)(e.h3,{id:"\u6392\u5e8f",children:"\u6392\u5e8f"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ndf = pd.DataFrame({\n    'name': ['Charlie', 'Alice', 'Bob'],\n    'age': [35, 25, 30],\n    'salary': [7000, 5000, 6000]\n})\n\n# \u6309\u503c\u6392\u5e8f\nprint(df.sort_values('age'))  # \u6309age\u5347\u5e8f\nprint(df.sort_values('age', ascending=False))  # \u964d\u5e8f\n\n# \u591a\u5217\u6392\u5e8f\nprint(df.sort_values(['age', 'salary']))\nprint(df.sort_values(['age', 'salary'], ascending=[True, False]))\n\n# \u6309\u7d22\u5f15\u6392\u5e8f\ndf_indexed = df.set_index('name')\nprint(df_indexed.sort_index())  # \u6309\u884c\u7d22\u5f15\u6392\u5e8f\nprint(df_indexed.sort_index(axis=1))  # \u6309\u5217\u540d\u6392\u5e8f\n\n# \u539f\u5730\u6392\u5e8f\ndf.sort_values('age', inplace=True)\n\n# rank\uff1a\u8ba1\u7b97\u6392\u540d\ndf['age_rank'] = df['age'].rank()\ndf['salary_rank'] = df['salary'].rank(ascending=False)\ndf['age_rank_dense'] = df['age'].rank(method='dense')\n\nprint(df)\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"rank \u65b9\u6cd5\u7684 method \u53c2\u6570\uff1a"})}),(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"average"}),"\uff1a\u76f8\u540c\u503c\u53d6\u5e73\u5747\u6392\u540d\uff08\u9ed8\u8ba4\uff09"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"min"}),"\uff1a\u76f8\u540c\u503c\u53d6\u6700\u5c0f\u6392\u540d"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"max"}),"\uff1a\u76f8\u540c\u503c\u53d6\u6700\u5927\u6392\u540d"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"first"}),"\uff1a\u6309\u51fa\u73b0\u987a\u5e8f\u6392\u540d"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"dense"}),"\uff1a\u7d27\u5bc6\u6392\u540d\uff0c\u65e0\u8df3\u53f7"]}),"\n"]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"s = pd.Series([1, 3, 3, 5])\n\ns.rank(method='average')  # [1.0, 2.5, 2.5, 4.0]\ns.rank(method='min')      # [1.0, 2.0, 2.0, 4.0]\ns.rank(method='max')      # [1.0, 3.0, 3.0, 4.0]\ns.rank(method='first')    # [1.0, 2.0, 3.0, 4.0]\ns.rank(method='dense')    # [1.0, 2.0, 2.0, 3.0]\n"})})]}),"\n",(0,s.jsx)(e.h3,{id:"\u6570\u636e\u5408\u5e76",children:"\u6570\u636e\u5408\u5e76"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ndf1 = pd.DataFrame({\n    'A': [1, 2, 3],\n    'B': [4, 5, 6]\n})\n\ndf2 = pd.DataFrame({\n    'A': [7, 8, 9],\n    'B': [10, 11, 12]\n})\n\n# concat\uff1a\u5782\u76f4/\u6c34\u5e73\u62fc\u63a5\nprint(pd.concat([df1, df2]))  # \u5782\u76f4\u62fc\u63a5\uff08\u9ed8\u8ba4axis=0\uff09\nprint(pd.concat([df1, df2], axis=1))  # \u6c34\u5e73\u62fc\u63a5\nprint(pd.concat([df1, df2], ignore_index=True))  # \u91cd\u7f6e\u7d22\u5f15\n\n# merge\uff1a\u7c7bSQL\u7684\u5408\u5e76\nleft = pd.DataFrame({\n    'key': ['A', 'B', 'C'],\n    'value1': [1, 2, 3]\n})\n\nright = pd.DataFrame({\n    'key': ['A', 'B', 'D'],\n    'value2': [4, 5, 6]\n})\n\n# \u5185\u8fde\u63a5\uff08\u9ed8\u8ba4\uff09\nprint(pd.merge(left, right, on='key'))\n#   key  value1  value2\n# 0   A       1       4\n# 1   B       2       5\n\n# \u5de6\u8fde\u63a5\nprint(pd.merge(left, right, on='key', how='left'))\n#   key  value1  value2\n# 0   A       1     4.0\n# 1   B       2     5.0\n# 2   C       3     NaN\n\n# \u53f3\u8fde\u63a5\nprint(pd.merge(left, right, on='key', how='right'))\n\n# \u5916\u8fde\u63a5\nprint(pd.merge(left, right, on='key', how='outer'))\n#   key  value1  value2\n# 0   A     1.0     4.0\n# 1   B     2.0     5.0\n# 2   C     3.0     NaN\n# 3   D     NaN     6.0\n\n# \u4e0d\u540c\u5217\u540d\u8fde\u63a5\nleft = pd.DataFrame({'key_left': ['A', 'B'], 'value': [1, 2]})\nright = pd.DataFrame({'key_right': ['A', 'B'], 'value': [3, 4]})\nprint(pd.merge(left, right, left_on='key_left', right_on='key_right'))\n\n# join\uff1a\u57fa\u4e8e\u7d22\u5f15\u7684\u5408\u5e76\ndf1 = pd.DataFrame({'A': [1, 2]}, index=['a', 'b'])\ndf2 = pd.DataFrame({'B': [3, 4]}, index=['a', 'b'])\nprint(df1.join(df2))\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"merge \u7684 how \u53c2\u6570\uff1a"})}),(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,s.jsx)(e.th,{children:"SQL\u7b49\u4ef7"}),(0,s.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"inner"})}),(0,s.jsx)(e.td,{children:"INNER JOIN"}),(0,s.jsx)(e.td,{children:"\u4fdd\u7559\u4e24\u8fb9\u90fd\u6709\u7684\u952e"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"left"})}),(0,s.jsx)(e.td,{children:"LEFT JOIN"}),(0,s.jsx)(e.td,{children:"\u4fdd\u7559\u5de6\u8fb9\u6240\u6709\u952e"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"right"})}),(0,s.jsx)(e.td,{children:"RIGHT JOIN"}),(0,s.jsx)(e.td,{children:"\u4fdd\u7559\u53f3\u8fb9\u6240\u6709\u952e"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"outer"})}),(0,s.jsx)(e.td,{children:"FULL OUTER JOIN"}),(0,s.jsx)(e.td,{children:"\u4fdd\u7559\u6240\u6709\u952e"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"cross"})}),(0,s.jsx)(e.td,{children:"CROSS JOIN"}),(0,s.jsx)(e.td,{children:"\u7b1b\u5361\u5c14\u79ef"})]})]})]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \u591a\u5217\u8fde\u63a5\npd.merge(df1, df2, on=['key1', 'key2'])\n\n# \u89e3\u51b3\u91cd\u590d\u5217\u540d\npd.merge(df1, df2, on='key', suffixes=('_left', '_right'))\n\n# \u6307\u793a\u5668\uff1a\u663e\u793a\u6570\u636e\u6765\u6e90\npd.merge(df1, df2, on='key', how='outer', indicator=True)\n"})})]}),"\n",(0,s.jsx)(e.h2,{id:"\u6570\u636e\u5206\u6790",children:"\u6570\u636e\u5206\u6790"}),"\n",(0,s.jsx)(e.h3,{id:"\u5206\u7ec4\u805a\u5408groupby",children:"\u5206\u7ec4\u805a\u5408\uff08GroupBy\uff09"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\nimport numpy as np\n\ndf = pd.DataFrame({\n    'class': ['A', 'A', 'B', 'B', 'C', 'C'],\n    'name': ['Alice', 'Bob', 'Charlie', 'David', 'Eve', 'Frank'],\n    'score': [85, 90, 75, 80, 95, 88]\n})\n\n# \u57fa\u672c\u5206\u7ec4\ngrouped = df.groupby('class')\n\n# \u805a\u5408\u51fd\u6570\nprint(grouped['score'].mean())   # \u6bcf\u7ec4\u5e73\u5747\u5206\nprint(grouped['score'].sum())    # \u6bcf\u7ec4\u603b\u5206\nprint(grouped['score'].count())  # \u6bcf\u7ec4\u4eba\u6570\nprint(grouped['score'].max())    # \u6bcf\u7ec4\u6700\u9ad8\u5206\n\n# \u591a\u4e2a\u805a\u5408\u51fd\u6570\nprint(grouped['score'].agg(['mean', 'sum', 'count', 'max', 'min']))\n\n# \u4e0d\u540c\u5217\u4e0d\u540c\u805a\u5408\nprint(grouped.agg({\n    'score': ['mean', 'max'],\n    'name': 'count'\n}))\n\n# \u81ea\u5b9a\u4e49\u805a\u5408\u51fd\u6570\nprint(grouped['score'].agg(lambda x: x.max() - x.min()))\n\n# \u591a\u5217\u5206\u7ec4\ndf['semester'] = ['S1', 'S1', 'S1', 'S2', 'S2', 'S2']\nprint(df.groupby(['class', 'semester'])['score'].mean())\n\n# \u904d\u5386\u5206\u7ec4\nfor name, group in grouped:\n    print(f\"\\nClass {name}:\")\n    print(group)\n\n# transform\uff1a\u4fdd\u6301\u539fDataFrame\u5f62\u72b6\ndf['score_mean'] = grouped['score'].transform('mean')\ndf['score_normalized'] = grouped['score'].transform(lambda x: (x - x.mean()) / x.std())\nprint(df)\n\n# filter\uff1a\u7b5b\u9009\u5206\u7ec4\nprint(grouped.filter(lambda x: x['score'].mean() > 85))\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"GroupBy \u4e09\u90e8\u66f2\uff1aSplit-Apply-Combine"})}),(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Split"}),"\uff1a\u6309\u6761\u4ef6\u5206\u7ec4"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Apply"}),"\uff1a\u5bf9\u6bcf\u7ec4\u5e94\u7528\u51fd\u6570"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Combine"}),"\uff1a\u5408\u5e76\u7ed3\u679c"]}),"\n"]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \u5e38\u7528\u6a21\u5f0f\ndf.groupby('key').agg('mean')          # \u805a\u5408\ndf.groupby('key').transform('mean')    # \u8f6c\u6362\uff08\u4fdd\u6301\u5f62\u72b6\uff09\ndf.groupby('key').filter(lambda x: len(x) > 2)  # \u7b5b\u9009\u5206\u7ec4\ndf.groupby('key').apply(custom_function)  # \u81ea\u5b9a\u4e49\u51fd\u6570\n"})})]}),"\n",(0,s.jsx)(e.h3,{id:"\u6570\u636e\u900f\u89c6pivot",children:"\u6570\u636e\u900f\u89c6\uff08Pivot\uff09"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"import pandas as pd\n\ndf = pd.DataFrame({\n    'date': ['2021-01', '2021-01', '2021-02', '2021-02'],\n    'city': ['Beijing', 'Shanghai', 'Beijing', 'Shanghai'],\n    'sales': [100, 150, 120, 160],\n    'profit': [20, 30, 25, 35]\n})\n\n# pivot_table\uff1a\u521b\u5efa\u900f\u89c6\u8868\npivot = pd.pivot_table(\n    df,\n    values='sales',          # \u8981\u805a\u5408\u7684\u503c\n    index='date',            # \u884c\u7d22\u5f15\n    columns='city',          # \u5217\u7d22\u5f15\n    aggfunc='sum'            # \u805a\u5408\u51fd\u6570\n)\nprint(pivot)\n# city      Beijing  Shanghai\n# date                       \n# 2021-01       100       150\n# 2021-02       120       160\n\n# \u591a\u4e2a\u805a\u5408\u51fd\u6570\npivot = pd.pivot_table(\n    df,\n    values='sales',\n    index='date',\n    columns='city',\n    aggfunc=['sum', 'mean']\n)\nprint(pivot)\n\n# \u591a\u4e2a\u503c\u5217\npivot = pd.pivot_table(\n    df,\n    values=['sales', 'profit'],\n    index='date',\n    columns='city',\n    aggfunc='sum'\n)\nprint(pivot)\n\n# \u6dfb\u52a0\u5c0f\u8ba1\npivot = pd.pivot_table(\n    df,\n    values='sales',\n    index='date',\n    columns='city',\n    aggfunc='sum',\n    margins=True,\n    margins_name='Total'\n)\nprint(pivot)\n\n# stack/unstack\uff1a\u91cd\u5851\u6570\u636e\ndf_indexed = df.set_index(['date', 'city'])\nprint(df_indexed)\n\n# unstack\uff1a\u5c06\u884c\u7d22\u5f15\u8f6c\u4e3a\u5217\u7d22\u5f15\nprint(df_indexed.unstack())\n\n# stack\uff1a\u5c06\u5217\u7d22\u5f15\u8f6c\u4e3a\u884c\u7d22\u5f15\nprint(df_indexed.unstack().stack())\n"})}),"\n",(0,s.jsxs)(e.admonition,{type:"tip",children:[(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Pivot vs Pivot_table\uff1a"})}),(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"pivot"}),"\uff1a\u4e0d\u805a\u5408\uff0c\u8981\u6c42\u7d22\u5f15/\u5217\u7ec4\u5408\u552f\u4e00"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"pivot_table"}),"\uff1a\u53ef\u805a\u5408\uff0c\u5904\u7406\u91cd\u590d\u503c"]}),"\n"]}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# pivot\uff1a\u7b80\u5355\u91cd\u5851\ndf.pivot(index='date', columns='city', values='sales')\n\n# pivot_table\uff1a\u9700\u8981\u805a\u5408\ndf.pivot_table(\n    values='sales',\n    index='date',\n    columns='city',\n    aggfunc='sum'\n)\n"})})]})]})}function o(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(p,{...n})}):p(n)}},28453:(n,e,d)=>{d.d(e,{R:()=>r,x:()=>l});var i=d(96540);const s={},a=i.createContext(s);function r(n){const e=i.useContext(a);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),i.createElement(a.Provider,{value:e},n.children)}}}]);