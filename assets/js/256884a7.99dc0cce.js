"use strict";(self.webpackChunkjiangmiemie=self.webpackChunkjiangmiemie||[]).push([[6302],{66967:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python/30\u5f02\u6b65\u7f16\u7a0b","title":"\u5f02\u6b65\u7f16\u7a0b","description":"\u5f02\u6b65\u7f16\u7a0b\u662f Python 3.5+ \u5f15\u5165\u7684\u91cd\u8981\u7279\u6027\uff0c\u901a\u8fc7 async/await \u8bed\u6cd5\u63d0\u4f9b\u4e86\u4e00\u79cd\u4f18\u96c5\u7684\u65b9\u5f0f\u6765\u5904\u7406\u5e76\u53d1\u64cd\u4f5c\u3002\u5b83\u7279\u522b\u9002\u5408 I/O \u5bc6\u96c6\u578b\u4efb\u52a1\uff0c\u5982\u7f51\u7edc\u8bf7\u6c42\u3001\u6570\u636e\u5e93\u67e5\u8be2\u7b49\uff0c\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u7a0b\u5e8f\u6027\u80fd\u3002","source":"@site/docs/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python/30\u5f02\u6b65\u7f16\u7a0b.mdx","sourceDirName":"\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python","slug":"/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python/30\u5f02\u6b65\u7f16\u7a0b","permalink":"/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python/30\u5f02\u6b65\u7f16\u7a0b","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":30,"frontMatter":{"sidebar_position":30,"title":"\u5f02\u6b65\u7f16\u7a0b"},"sidebar":"tutorialSidebar","previous":{"title":"\u6587\u4ef6\u64cd\u4f5c","permalink":"/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python/29\u6587\u4ef6\u64cd\u4f5c"},"next":{"title":"\u4ee3\u7801\u6267\u884c\u4e0e\u8c03\u8bd5","permalink":"/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/Python/38\u4ee3\u7801\u6267\u884c\u4e0e\u8c03\u8bd5"}}');var a=s(74848),t=s(28453);const r={sidebar_position:30,title:"\u5f02\u6b65\u7f16\u7a0b"},c=void 0,l={},o=[{value:"\u5f02\u6b65\u7f16\u7a0b",id:"\u5f02\u6b65\u7f16\u7a0b",level:2},{value:"async \u548c await \u5173\u952e\u5b57",id:"async-\u548c-await-\u5173\u952e\u5b57",level:3},{value:"async for",id:"async-for",level:3},{value:"async with",id:"async-with",level:3},{value:"\u5185\u7f6e\u51fd\u6570",id:"\u5185\u7f6e\u51fd\u6570",level:2},{value:"aiter \u51fd\u6570\u548c anext \u51fd\u6570",id:"aiter-\u51fd\u6570\u548c-anext-\u51fd\u6570",level:3},{value:"asyncio",id:"asyncio",level:2},{value:"asyncio \u5e38\u7528\u51fd\u6570",id:"asyncio-\u5e38\u7528\u51fd\u6570",level:3},{value:"asyncio.gather()",id:"asynciogather",level:3},{value:"asyncio.create_task()",id:"asynciocreate_task",level:3}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e.admonition,{type:"info",children:[(0,a.jsxs)(e.p,{children:["\u5f02\u6b65\u7f16\u7a0b\u662f Python 3.5+ \u5f15\u5165\u7684\u91cd\u8981\u7279\u6027\uff0c\u901a\u8fc7 ",(0,a.jsx)(e.code,{children:"async"}),"/",(0,a.jsx)(e.code,{children:"await"})," \u8bed\u6cd5\u63d0\u4f9b\u4e86\u4e00\u79cd\u4f18\u96c5\u7684\u65b9\u5f0f\u6765\u5904\u7406\u5e76\u53d1\u64cd\u4f5c\u3002\u5b83\u7279\u522b\u9002\u5408 I/O \u5bc6\u96c6\u578b\u4efb\u52a1\uff0c\u5982\u7f51\u7edc\u8bf7\u6c42\u3001\u6570\u636e\u5e93\u67e5\u8be2\u7b49\uff0c\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u7a0b\u5e8f\u6027\u80fd\u3002"]}),(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"# \u4f20\u7edf\u540c\u6b65\u65b9\u5f0f - \u603b\u8017\u65f6 = \u4efb\u52a11 + \u4efb\u52a12 + \u4efb\u52a13\n# \u5f02\u6b65\u65b9\u5f0f - \u603b\u8017\u65f6 \u2248 max(\u4efb\u52a11, \u4efb\u52a12, \u4efb\u52a13)\n\nasync def main():\n    # \u4e09\u4e2a\u7f51\u7edc\u8bf7\u6c42\u53ef\u4ee5\u5e76\u53d1\u6267\u884c\n    results = await asyncio.gather(\n        fetch_data('url1'),\n        fetch_data('url2'),\n        fetch_data('url3')\n    )\n"})}),(0,a.jsx)(e.p,{children:(0,a.jsx)(e.a,{href:"https://peps.python.org/pep-0492/",children:"PEP 492 \u2013 \u534f\u7a0b\u4e0e async/await \u8bed\u6cd5"})})]}),"\n",(0,a.jsx)(e.h2,{id:"\u5f02\u6b65\u7f16\u7a0b",children:"\u5f02\u6b65\u7f16\u7a0b"}),"\n",(0,a.jsx)(e.p,{children:"\u5f02\u6b65\u7f16\u7a0b\u662f\u4e00\u79cd\u7f16\u7a0b\u8303\u5f0f\uff0c\u5b83\u5141\u8bb8\u7a0b\u5e8f\u5728\u7b49\u5f85\u67d0\u4e9b\u64cd\u4f5c\uff08\u5982 I/O\uff09\u5b8c\u6210\u65f6\u7ee7\u7eed\u6267\u884c\u5176\u4ed6\u4efb\u52a1\uff0c\u800c\u4e0d\u662f\u963b\u585e\u7b49\u5f85\u3002"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u5f02\u6b65\u7f16\u7a0b\u7684\u4f18\u52bf\uff1a"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"\u9ad8\u6548\u5e76\u53d1"}),"\uff1a\u540c\u65f6\u5904\u7406\u591a\u4e2a I/O \u64cd\u4f5c\uff0c\u4e0d\u9700\u8981\u591a\u7ebf\u7a0b"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"\u8d44\u6e90\u8282\u7701"}),"\uff1a\u907f\u514d\u4e86\u7ebf\u7a0b\u5207\u6362\u7684\u5f00\u9500"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"\u4ee3\u7801\u4f18\u96c5"}),"\uff1a\u4f7f\u7528 async/await \u8bed\u6cd5\uff0c\u907f\u514d\u56de\u8c03\u5730\u72f1"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"\u6027\u80fd\u63d0\u5347"}),"\uff1a\u5728 I/O \u5bc6\u96c6\u578b\u4efb\u52a1\u4e2d\u6027\u80fd\u663e\u8457\u63d0\u5347"]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u9002\u7528\u573a\u666f\uff1a"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u7f51\u7edc\u8bf7\u6c42\uff08API \u8c03\u7528\u3001\u722c\u866b\uff09"}),"\n",(0,a.jsx)(e.li,{children:"\u6570\u636e\u5e93\u67e5\u8be2"}),"\n",(0,a.jsx)(e.li,{children:"\u6587\u4ef6 I/O \u64cd\u4f5c"}),"\n",(0,a.jsx)(e.li,{children:"WebSocket \u901a\u4fe1"}),"\n"]}),"\n",(0,a.jsx)(e.admonition,{type:"warning",children:(0,a.jsxs)(e.p,{children:["\u5f02\u6b65\u7f16\u7a0b\u4e0d\u9002\u5408 CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u3002\u5bf9\u4e8e\u8ba1\u7b97\u5bc6\u96c6\u578b\u64cd\u4f5c\uff0c\u5e94\u8be5\u4f7f\u7528\u591a\u8fdb\u7a0b\uff08",(0,a.jsx)(e.code,{children:"multiprocessing"}),"\uff09\u3002"]})}),"\n",(0,a.jsx)(e.h3,{id:"async-\u548c-await-\u5173\u952e\u5b57",children:"async \u548c await \u5173\u952e\u5b57"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"async"})," \u5173\u952e\u5b57\u7528\u4e8e\u5b9a\u4e49\u534f\u7a0b\u51fd\u6570\uff0c",(0,a.jsx)(e.code,{children:"await"})," \u5173\u952e\u5b57\u7528\u4e8e\u7b49\u5f85\u534f\u7a0b\u6267\u884c\u5b8c\u6210\u3002"]}),"\n",(0,a.jsxs)(e.p,{children:["async \u534f\u7a0b\u51fd\u6570\u4e0d\u80fd\u76f4\u63a5\u8c03\u7528\uff0c\u6700\u7ec8\u90fd\u9700\u8981\u901a\u8fc7",(0,a.jsx)(e.code,{children:"asyncio"}),"\u6807\u51c6\u5e93\u8c03\u7528\u3002"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'import asyncio\n\nasync def hello():\n    await asyncio.sleep(1)\n    return "Hello, World!"\n\n# \u5728\u53e6\u4e00\u4e2a async \u51fd\u6570\u5185\u90e8\u4f7f\u7528 await \u8c03\u7528\u534f\u7a0b\u51fd\u6570\nasync def main():\n    """\u4f46\u6700\u7ec8\u8fd8\u662f\u9700\u8981\u56de\u5230asyncio.run()\u4e2d\u6267\u884c"""\n    result = await hello()\n    print(result)\n# \u65b9\u5f0f1: asyncio.run() - Python 3.7+ \u63a8\u8350\u65b9\u5f0f\nasyncio.run(main())\n\n# \u65b9\u5f0f2: asyncio.create_task() - \u5728\u8fd0\u884c\u7684\u4e8b\u4ef6\u5faa\u73af\u4e2d\u521b\u5efa\u4efb\u52a1\nasync def create_tasks():\n    task = asyncio.create_task(hello())  # \u521b\u5efa\u4efb\u52a1\n    # \u53ef\u4ee5\u5728\u7b49\u5f85\u4e4b\u524d\u505a\u5176\u4ed6\u4e8b\u60c5\n    print("\u4efb\u52a1\u5df2\u521b\u5efa\uff0c\u7ee7\u7eed\u505a\u5176\u4ed6\u4e8b\u60c5...")\n    result = await task  # \u6267\u884c\u4efb\u52a1\uff0c\u5e76\u7b49\u5f85\u4efb\u52a1\u5b8c\u6210\n    print(result)\n\nasyncio.run(create_tasks())\n\n# \u65b9\u5f0f3: asyncio.gather() - \u5e76\u53d1\u6267\u884c\u591a\u4e2a\u534f\u7a0b\nasync def run_multiple():\n    results = await asyncio.gather(hello(), hello(), hello())\n    print(results)  # [\'Hello, World!\', \'Hello, World!\', \'Hello, World!\']\n\nasyncio.run(run_multiple())\n\n# \u65b9\u5f0f4: \u624b\u52a8\u7ba1\u7406\u4e8b\u4ef6\u5faa\u73af \nloop = asyncio.get_event_loop()\ntry:\n    result = loop.run_until_complete(hello())\n    print(result)\nfinally:\n    loop.close()\n\n'})}),"\n",(0,a.jsx)(e.h3,{id:"async-for",children:"async for"}),"\n",(0,a.jsxs)(e.p,{children:["\u5f02\u6b65\u8fed\u4ee3\u5668\u4f7f\u7528 ",(0,a.jsx)(e.code,{children:"async for"})," \u8bed\u6cd5\uff0c\u9002\u7528\u4e8e\u9700\u8981\u5f02\u6b65\u83b7\u53d6\u6570\u636e\u7684\u573a\u666f\u3002"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'import asyncio\n\nclass AsyncRange:\n    """\u5f02\u6b65\u8303\u56f4\u8fed\u4ee3\u5668"""\n    def __init__(self, start, end):\n        self.current = start\n        self.end = end\n    \n    def __aiter__(self):\n        return self\n    \n    async def __anext__(self):\n        if self.current >= self.end:\n            raise StopAsyncIteration\n        await asyncio.sleep(0.5)  # \u6a21\u62df\u5f02\u6b65\u64cd\u4f5c\n        self.current += 1\n        return self.current - 1\n\nasync def main():\n    # \u4f7f\u7528 async for \u8fed\u4ee3\n    async for num in AsyncRange(0, 5):\n        print(f"\u83b7\u53d6\u6570\u5b57: {num}")\n\nasyncio.run(main())\n# \u8f93\u51fa:\n# \u83b7\u53d6\u6570\u5b57: 0\n# \u83b7\u53d6\u6570\u5b57: 1\n# \u83b7\u53d6\u6570\u5b57: 2\n# \u83b7\u53d6\u6570\u5b57: 3\n# \u83b7\u53d6\u6570\u5b57: 4\n'})}),"\n",(0,a.jsx)(e.h3,{id:"async-with",children:"async with"}),"\n",(0,a.jsxs)(e.p,{children:["\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u4f7f\u7528 ",(0,a.jsx)(e.code,{children:"async with"})," \u8bed\u6cd5\uff0c\u7528\u4e8e\u7ba1\u7406\u5f02\u6b65\u8d44\u6e90\u3002"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'import asyncio\n\nclass AsyncResource:\n    """\u5f02\u6b65\u8d44\u6e90\u7ba1\u7406\u5668"""\n    async def __aenter__(self):\n        print("\u83b7\u53d6\u8d44\u6e90...")\n        await asyncio.sleep(1)\n        print("\u8d44\u6e90\u5df2\u83b7\u53d6")\n        return self\n    \n    async def __aexit__(self, exc_type, exc_val, exc_tb):\n        print("\u91ca\u653e\u8d44\u6e90...")\n        await asyncio.sleep(1)\n        print("\u8d44\u6e90\u5df2\u91ca\u653e")\n\nasync def main():\n    async with AsyncResource() as resource:\n        print("\u4f7f\u7528\u8d44\u6e90")\n        await asyncio.sleep(0.5)\n\nasyncio.run(main())\n# \u8f93\u51fa:\n# \u83b7\u53d6\u8d44\u6e90...\n# \u8d44\u6e90\u5df2\u83b7\u53d6\n# \u4f7f\u7528\u8d44\u6e90\n# \u91ca\u653e\u8d44\u6e90...\n# \u8d44\u6e90\u5df2\u91ca\u653e\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u5185\u7f6e\u51fd\u6570",children:"\u5185\u7f6e\u51fd\u6570"}),"\n",(0,a.jsx)(e.h3,{id:"aiter-\u51fd\u6570\u548c-anext-\u51fd\u6570",children:"aiter \u51fd\u6570\u548c anext \u51fd\u6570"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"aiter()"})," \u548c ",(0,a.jsx)(e.code,{children:"anext()"})," \u662f\u5f02\u6b65\u7248\u672c\u7684 ",(0,a.jsx)(e.code,{children:"iter()"})," \u548c ",(0,a.jsx)(e.code,{children:"next()"}),"\uff0c\u7528\u4e8e\u5904\u7406\u5f02\u6b65\u8fed\u4ee3\u5668\u3002"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u51fd\u6570\u7b7e\u540d\uff1a"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"aiter(async_iterable) -> async_iterator"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"anext(async_iterator, default=None) -> awaitable"})}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u9b54\u672f\u65b9\u6cd5\u4e0e\u5185\u7f6e\u51fd\u6570\u7684\u5173\u7cfb\uff1a"})}),"\n",(0,a.jsxs)(e.table,{children:[(0,a.jsx)(e.thead,{children:(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.th,{children:"\u9b54\u672f\u65b9\u6cd5"}),(0,a.jsx)(e.th,{children:"\u5185\u7f6e\u51fd\u6570"}),(0,a.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,a.jsxs)(e.tbody,{children:[(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"__aiter__()"})}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"aiter()"})}),(0,a.jsx)(e.td,{children:"\u8fd4\u56de\u5f02\u6b65\u8fed\u4ee3\u5668\u5bf9\u8c61"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"__anext__()"})}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"anext()"})}),(0,a.jsx)(e.td,{children:"\u8fd4\u56de\u4e0b\u4e00\u4e2a\u5f02\u6b65\u8fed\u4ee3\u503c"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"__iter__()"})}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"iter()"})}),(0,a.jsx)(e.td,{children:"\u540c\u6b65\u7248\u672c\uff1a\u8fd4\u56de\u8fed\u4ee3\u5668"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"__next__()"})}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"next()"})}),(0,a.jsx)(e.td,{children:"\u540c\u6b65\u7248\u672c\uff1a\u8fd4\u56de\u4e0b\u4e00\u4e2a\u503c"})]})]})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'import asyncio\n\nclass AsyncCounter:\n    """\u5f02\u6b65\u8ba1\u6570\u5668"""\n    def __init__(self, max_count):\n        self.count = 0\n        self.max_count = max_count\n    \n    def __aiter__(self):\n        # aiter(obj) \u4f1a\u8c03\u7528 obj.__aiter__()\n        return self\n    \n    async def __anext__(self):\n        # anext(obj) \u4f1a\u8c03\u7528 obj.__anext__()\n        if self.count >= self.max_count:\n            raise StopAsyncIteration\n        await asyncio.sleep(0.5)\n        self.count += 1\n        return self.count\n\nasync def main():\n    counter = AsyncCounter(3)\n    \n    # \u4f7f\u7528 aiter \u548c anext\n    async_iter = aiter(counter)\n    \n    # \u83b7\u53d6\u7b2c\u4e00\u4e2a\u503c\n    value1 = await anext(async_iter)\n    print(f"\u503c1: {value1}")  # \u503c1: 1\n    \n    # \u83b7\u53d6\u7b2c\u4e8c\u4e2a\u503c\n    value2 = await anext(async_iter)\n    print(f"\u503c2: {value2}")  # \u503c2: 2\n    \n    # \u83b7\u53d6\u7b2c\u4e09\u4e2a\u503c\n    value3 = await anext(async_iter)\n    print(f"\u503c3: {value3}")  # \u503c3: 3\n    \n    # \u4f7f\u7528\u9ed8\u8ba4\u503c\u907f\u514d StopAsyncIteration\n    value4 = await anext(async_iter, "\u6ca1\u6709\u66f4\u591a\u6570\u636e")\n    print(f"\u503c4: {value4}")  # \u503c4: \u6ca1\u6709\u66f4\u591a\u6570\u636e\n\nasyncio.run(main())\n'})}),"\n",(0,a.jsxs)(e.admonition,{type:"tip",children:[(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u7406\u89e3\u9b54\u672f\u65b9\u6cd5\u4e0e\u5185\u7f6e\u51fd\u6570\u7684\u5173\u7cfb\uff1a"})}),(0,a.jsx)(e.p,{children:"\u5185\u7f6e\u51fd\u6570\u662f\u5bf9\u9b54\u672f\u65b9\u6cd5\u7684\u5c01\u88c5\uff0c\u63d0\u4f9b\u4e86\u66f4\u53cb\u597d\u7684\u8c03\u7528\u65b9\u5f0f\u3002"}),(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"import asyncio\n\nclass MyAsyncIterable:\n    def __aiter__(self):\n        return self\n    \n    async def __anext__(self):\n        # \u8fd4\u56de\u4e0b\u4e00\u4e2a\u503c...\n        pass\n\nobj = MyAsyncIterable()\n\n# \u8fd9\u4e24\u79cd\u65b9\u5f0f\u662f\u7b49\u4ef7\u7684\uff1a\nasync_iter1 = aiter(obj)      # \u63a8\u8350\uff1a\u4f7f\u7528\u5185\u7f6e\u51fd\u6570\nasync_iter2 = obj.__aiter__()  # \u4e0d\u63a8\u8350\uff1a\u76f4\u63a5\u8c03\u7528\u9b54\u672f\u65b9\u6cd5\n\n# \u540c\u6837\uff0c\u8fd9\u4e24\u79cd\u65b9\u5f0f\u4e5f\u662f\u7b49\u4ef7\u7684\uff1a\nvalue1 = await anext(async_iter1)      # \u63a8\u8350\nvalue2 = await async_iter2.__anext__()  # \u4e0d\u63a8\u8350\n"})}),(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u4e3a\u4ec0\u4e48\u8981\u7528\u5185\u7f6e\u51fd\u6570\uff1f"})}),(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"\u53ef\u8bfb\u6027\u66f4\u597d"}),"\uff1a",(0,a.jsx)(e.code,{children:"aiter(obj)"})," \u6bd4 ",(0,a.jsx)(e.code,{children:"obj.__aiter__()"})," \u66f4\u6e05\u6670"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"\u9075\u5faa\u7ea6\u5b9a"}),"\uff1aPython \u98ce\u683c\u6307\u5357\u63a8\u8350\u4f7f\u7528\u5185\u7f6e\u51fd\u6570"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"\u7c7b\u578b\u68c0\u67e5"}),"\uff1a\u5185\u7f6e\u51fd\u6570\u4f1a\u8fdb\u884c\u5fc5\u8981\u7684\u68c0\u67e5\u548c\u5904\u7406"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"\u5411\u540e\u517c\u5bb9"}),"\uff1a\u5185\u7f6e\u51fd\u6570\u53ef\u80fd\u5305\u542b\u989d\u5916\u7684\u903b\u8f91\u548c\u4f18\u5316"]}),"\n"]}),(0,a.jsx)(e.p,{children:"\u7c7b\u6bd4\u540c\u6b65\u7248\u672c\uff1a"}),(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"# \u540c\u6b65\u8fed\u4ee3\u5668\nmy_list = [1, 2, 3]\n\n# \u63a8\u8350\u5199\u6cd5\nit = iter(my_list)    # \u800c\u4e0d\u662f my_list.__iter__()\nvalue = next(it)      # \u800c\u4e0d\u662f it.__next__()\n\n# \u5f02\u6b65\u8fed\u4ee3\u5668\nasync def demo():\n    async_obj = MyAsyncIterable()\n    \n    # \u63a8\u8350\u5199\u6cd5\n    async_it = aiter(async_obj)    # \u800c\u4e0d\u662f async_obj.__aiter__()\n    value = await anext(async_it)  # \u800c\u4e0d\u662f await async_it.__anext__()\n"})})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'# \u5b9e\u9645\u5e94\u7528\uff1a\u5f02\u6b65\u6570\u636e\u6d41\u5904\u7406\nimport asyncio\n\nasync def async_data_stream():\n    """\u6a21\u62df\u5f02\u6b65\u6570\u636e\u6d41"""\n    for i in range(5):\n        await asyncio.sleep(0.5)\n        yield f"\u6570\u636e-{i}"\n\nasync def process_stream():\n    # \u4f7f\u7528 async for \u5904\u7406\u6570\u636e\u6d41\n    async for data in async_data_stream():\n        print(f"\u5904\u7406: {data}")\n    \n    # \u7b49\u4ef7\u4e8e\u4f7f\u7528 aiter \u548c anext\n    print("\\n\u4f7f\u7528 aiter/anext:")\n    stream = aiter(async_data_stream())\n    while True:\n        try:\n            data = await anext(stream)\n            print(f"\u5904\u7406: {data}")\n        except StopAsyncIteration:\n            break\n\nasyncio.run(process_stream())\n'})}),"\n",(0,a.jsx)(e.h2,{id:"asyncio",children:"asyncio"}),"\n",(0,a.jsx)(e.h3,{id:"asyncio-\u5e38\u7528\u51fd\u6570",children:"asyncio \u5e38\u7528\u51fd\u6570"}),"\n",(0,a.jsx)(e.p,{children:"\u867d\u7136 asyncio \u662f\u6807\u51c6\u5e93\uff0c\u4f46\u8fd9\u91cc\u5217\u51fa\u4e00\u4e9b\u5e38\u7528\u51fd\u6570\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'import asyncio\n\nasync def demo_asyncio_functions():\n    # 1. asyncio.sleep() - \u5f02\u6b65\u7761\u7720\n    await asyncio.sleep(1)\n\n    # 2. asyncio.wait_for() - \u8bbe\u7f6e\u8d85\u65f6\n    try:\n        result = await asyncio.wait_for(\n            asyncio.sleep(5),\n            timeout=2.0\n        )\n    except asyncio.TimeoutError:\n        print("\u64cd\u4f5c\u8d85\u65f6")\n    \n    # 3. asyncio.as_completed() - \u6309\u5b8c\u6210\u987a\u5e8f\u83b7\u53d6\u7ed3\u679c\n    tasks = [\n        asyncio.create_task(asyncio.sleep(2, result="\u6162\u4efb\u52a1")),\n        asyncio.create_task(asyncio.sleep(1, result="\u5feb\u4efb\u52a1"))\n    ]\n    for coro in asyncio.as_completed(tasks):\n        result = await coro\n        print(f"\u5b8c\u6210: {result}")\n    # \u8f93\u51fa\u987a\u5e8f: \u5feb\u4efb\u52a1, \u6162\u4efb\u52a1\n\nasyncio.run(demo_asyncio_functions())\n'})}),"\n",(0,a.jsx)(e.h3,{id:"asynciogather",children:"asyncio.gather()"}),"\n",(0,a.jsxs)(e.p,{children:["\u4f7f\u7528 ",(0,a.jsx)(e.code,{children:"asyncio.gather()"})," \u6216 ",(0,a.jsx)(e.code,{children:"asyncio.create_task()"})," \u53ef\u4ee5\u5e76\u53d1\u6267\u884c\u591a\u4e2a\u534f\u7a0b\u3002"]}),"\n",(0,a.jsx)(e.p,{children:"\u51fd\u6570\u7b7e\u540d\uff1a"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"asyncio.gather(*coros_or_futures, loop=None, return_exceptions=False) -> List[Any]"})}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"\u53c2\u6570\u8bf4\u660e\uff1a"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"*coros_or_futures"}),"\uff1a\u534f\u7a0b\u6216 future \u5bf9\u8c61"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"loop=None"}),"\uff1a\u4e8b\u4ef6\u5faa\u73af\uff0c\u9ed8\u8ba4\u4f7f\u7528\u5f53\u524d\u4e8b\u4ef6\u5faa\u73af"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"return_exceptions=False"}),"\uff1a\u662f\u5426\u8fd4\u56de\u5f02\u5e38\uff0c\u9ed8\u8ba4\u4e0d\u8fd4\u56de"]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"\u8fd4\u56de\u503c\u8bf4\u660e\uff1a"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u8fd4\u56de\u7ed3\u679c\u4e3a\u5217\u8868\uff0c\u5217\u8868\u4e2d\u5305\u542b\u6240\u6709\u534f\u7a0b\u6216 future \u5bf9\u8c61\u7684\u8fd4\u56de\u7ed3\u679c"}),"\n",(0,a.jsxs)(e.li,{children:["\u5982\u679c",(0,a.jsx)(e.code,{children:"return_exceptions=True"}),"\uff0c\u5219\u8fd4\u56de\u7ed3\u679c\u4e3a\u5217\u8868\uff0c\u5217\u8868\u4e2d\u5305\u542b\u6240\u6709\u534f\u7a0b\u6216 future \u5bf9\u8c61\u7684\u8fd4\u56de\u7ed3\u679c\uff0c\u5305\u62ec\u5f02\u5e38"]}),"\n"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'import asyncio\nimport time\n\nasync def task(name, duration):\n    """\u6a21\u62df\u4e00\u4e2a\u5f02\u6b65\u4efb\u52a1"""\n    print(f"\u4efb\u52a1 {name} \u5f00\u59cb")\n    await asyncio.sleep(duration)\n    print(f"\u4efb\u52a1 {name} \u5b8c\u6210")\n    return f"\u7ed3\u679c-{name}"\n\nasync def main():\n    # \u65b9\u6cd51: \u4f7f\u7528 gather \u5e76\u53d1\u6267\u884c\n    start = time.time()\n    results = await asyncio.gather(\n        task("A", 2),\n        task("B", 1),\n        task("C", 3)\n    )\n    print(f"\u7ed3\u679c: {results}")\n    print(f"\u603b\u8017\u65f6: {time.time() - start:.2f}\u79d2")\n    # \u603b\u8017\u65f6\u7ea63\u79d2\uff08\u6700\u957f\u4efb\u52a1\u7684\u65f6\u95f4\uff09\uff0c\u800c\u975e6\u79d2\n\nasyncio.run(main())\n# \u8f93\u51fa:\n# \u4efb\u52a1 A \u5f00\u59cb\n# \u4efb\u52a1 B \u5f00\u59cb\n# \u4efb\u52a1 C \u5f00\u59cb\n# \u4efb\u52a1 B \u5b8c\u6210\n# \u4efb\u52a1 A \u5b8c\u6210\n# \u4efb\u52a1 C \u5b8c\u6210\n# \u7ed3\u679c: [\'\u7ed3\u679c-A\', \'\u7ed3\u679c-B\', \'\u7ed3\u679c-C\']\n# \u603b\u8017\u65f6: 3.00\u79d2\n'})}),"\n",(0,a.jsx)(e.h3,{id:"asynciocreate_task",children:"asyncio.create_task()"}),"\n",(0,a.jsxs)(e.p,{children:["\u4f7f\u7528 ",(0,a.jsx)(e.code,{children:"asyncio.gather()"})," \u6216 ",(0,a.jsx)(e.code,{children:"asyncio.create_task()"})," \u53ef\u4ee5\u5e76\u53d1\u6267\u884c\u591a\u4e2a\u534f\u7a0b\u3002"]}),"\n",(0,a.jsx)(e.p,{children:"\u51fd\u6570\u7b7e\u540d\uff1a"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.code,{children:"asyncio.create_task(coro, *, name=None)"})}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"\u53c2\u6570\u8bf4\u660e\uff1a"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"coro"}),"\uff1a\u534f\u7a0b\u5bf9\u8c61"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.code,{children:"name=None"}),"\uff1a\u4efb\u52a1\u540d\u79f0\uff0c\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e"]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"\u8fd4\u56de\u503c\u8bf4\u660e\uff1a"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u8fd4\u56de\u7ed3\u679c\u4e3a\u4efb\u52a1\u5bf9\u8c61"}),"\n"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'import asyncio\nimport time\n\nasync def task(name, duration):\n    """\u6a21\u62df\u4e00\u4e2a\u5f02\u6b65\u4efb\u52a1"""\n    print(f"\u4efb\u52a1 {name} \u5f00\u59cb")\n    await asyncio.sleep(duration)\n    print(f"\u4efb\u52a1 {name} \u5b8c\u6210")\n    return f"\u7ed3\u679c-{name}"\n\nasync def main2():\n    start = time.time()\n    \n    # \u521b\u5efa\u4efb\u52a1\uff0c\u7acb\u5373\u5f00\u59cb\u6267\u884c\n    task1 = asyncio.create_task(task("X", 2))\n    task2 = asyncio.create_task(task("Y", 1))\n    task3 = asyncio.create_task(task("Z", 3))\n    \n    # \u7b49\u5f85\u6240\u6709\u4efb\u52a1\u5b8c\u6210\n    result1 = await task1\n    result2 = await task2\n    result3 = await task3\n    \n    print(f"\u7ed3\u679c: {result1}, {result2}, {result3}")\n    print(f"\u603b\u8017\u65f6: {time.time() - start:.2f}\u79d2")\n\nasyncio.run(main2())\n'})})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>r,x:()=>c});var i=s(96540);const a={},t=i.createContext(a);function r(n){const e=i.useContext(t);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:r(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);