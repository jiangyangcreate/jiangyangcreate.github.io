---
sidebar_position: 1
title: 变量
description: 变量的创建、命名规则、别名、相等性、一致性、驻留机制、对象的判断
---

## 变量

### 变量的创建

这是一个变量创建的示例。

```python showLineNumbers
# 变量名 = 数据
a = 1
```
<Highlight>数据`1`被创建，后被引用，并被标注为变量名`a`。</Highlight>

### 变量命名规则

```text
1. 变量名只能包含字母、数字和下划线。变量名可以字母或下划线打头，但不能以数字打头，例如，可将变量命名为 `message_1`，但不能将其命名为 `1_message`。
2. 变量名不能包含空格，但可使用下划线来分隔其中的单词。例如，变量名 `greeting_message` 可行，但变量名 `greeting message` 会引发错误。
3. 不要将 Python 关键字和函数名用作变量名，即不要使用 Python 保留用于特殊用途的单词，如 `print` `list` `dict`等。
4. 变量名应既简短又具有描述性。例如，`name` 比 `n` 好，`student_name` 比 `s_n` 好，`name_length` 比 `length_of_persons_name` 好。
5. 约定：全大写字母表示这个变量通常不会发生改变，表示常量。
6. 约定：变量名前加`_`表示这个变量为程序过程中间私有变量，不建议使用。
7. 驼峰命名法：变量名由多个单词组成，每个单词的首字母大写。如`StudentName`。
8. 蛇形命名法：变量名由多个单词组成，每个单词的小写，单词之间用下划线连接。如`student_name`。
```

### 别名 相等性 一致性

举个通俗的例子:变量是一个标签，用于标记数据。变量名是标签的名字，数据是标签指向的内容。语法示例：

```python showLineNumbers
# 变量名 = 变量名 2 = 变量名 3 = 数据 
# 这种写法表示 数据 有多个名字，好比某人又叫张三、又叫Bob

# 此时该数值的任意修改都会影响a，b，c的值，因为他们表示的都是同一个数据的内存指向
# 多出来的x和y是z的别名
x = y = z = [0,1]

e = [0,1]
f = e # 变量e和变量f绑定的是同一个值,多出来的f是e的别名

# 一次性给多个变量赋值
a = 1 
b = 2
# 可以写为：
a,b = 1,2
# a,b 交换值可写为：
a,b = b,a


# 变量可以重新指向新的数据,此时旧的数据1由于缺少引用，会被Python的垃圾回收机制自动回收。
a = 1
a = [1,2,3]

# 此时g虽然也是[1,2,3]，但是g和a是两个不同的变量，他们指向不同的内存地址。即a和g值相等,但不是同一个对象。
g = [1,2,3]

print(a == g) # True
print(a is g) # False

# 比较特别是None,None是Python中表示空值。且为单例常量，即整个程序中只有一个 None 对象
# Python3.12中5个单例常量：Ellipsis, False, None, NotImplemented, True
a = None
b = None
print(a is b)  # True - 它们指向同一个对象
print(id(a) == id(b))  # True - 内存地址相同
```
### 驻留机制

驻留是一种数据缓存机制，对不可变数据类型( 字符串、数字、布尔值等)使用同一个内存地址，防止重复创建热门对象，例如：0、1等，有效的节省了空间。使用不同的环境时，代码的优化方式不同。

```text showLineNumbers
在交互控制台中

`-5~256` 之间整数对象，会被驻留不会创建新的整数对象。
满足标识符命名规范的字符串都会被驻留，长度不限。
空字符串会驻留
使用乘法得到的字符串且满足标识符命名规范的字符串：长度小于等于20会驻留（peephole优化），Python 3.7改为4096（AST优化器）。
长度为1的特殊字符（ASCII 字符中的）会驻留
空元组或者只有一个元素且元素范围为`-5~256`的元组会驻留

在非交互环境中

所有数字对象都会驻留，即便是是`a = 1 -10`这样的表达式，也会驻留。
默认字符串都会驻留
使用乘法运算得到的字符串与在控制台相同
元组类型（元组内数据为不可变数据类型）会驻留，但是元组内数据为可变数据类型时，不会驻留。
函数、类、变量、参数等的名称以及关键字都会驻留
注意：字符串是在编译时进行驻留，也就是说，如果字符串的值不能在编译时进行计算，将不会驻留。比如`a = '1' + '2'`不会驻留，而`a = '12'`会驻留。
```

```python showLineNumbers
a = 'ABC'
b = 'ABC'
print(a is b) # True
```

数据一旦被创建，其内存地址不会改变。因为如果内存地址发生了改变，变量的指向就会异常。

```python showLineNumbers
a = [1,2,3]
print(id(a)) # 2060220698944

a.append(4)
print(a) # [1, 2, 3, 4]
print(id(a)) # 2060220698944

b = [1,2,3,4]
print(a == b) # True
print(id(a) == id(b)) # False
```

此时`a`的内存地址没有改变（一致性不变），但是`a`的值发生了改变（相等性改变）。

新创建的变量`b`的内存地址与`a`不同，但是`a`和`b`的值相等。即`a`和`b`相等但不一致。

除了判断相等性、同一性，我们有时需要检查某个对象属于哪个类型或两个对象是否是同个类型，下面使用内置函数和运算符来判断。

### 对象的判断

| 方法 | 用途 | 示例与说明 |
|------|------|------------|
| `==` | 判断两个对象的值是否相等 | 对应对象内的 `__eq__` 方法。即`a == b`等价于`a.__eq__(b)`。注意 `True == 1`、`False == 0` 都是 True |
| `is` | 判断两个对象是否是同一个对象 | `a is b` 等价于 `id(a) == id(b)`，比较的是对象的内存地址 |
| `type()` | 判断对象的类型 | `type(a) == type(b)` 两个都是同个类的实例则相等。如 `type(1) == int` |
| `isinstance()` | 判断对象是否是某个类型 | `isinstance(a, type)`，如果 type 是实例 a 的父类也会返回 True。如 `isinstance(1, object)` 是 True，因为 `object` 是所有类的父类 |

Python 官方编码规范 PEP 8 明确建议：使用 is 和 is not 来比较单例对象（如 None），而不是 ==。不会被 `__eq__`重写影响。